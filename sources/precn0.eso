C PRECN0    SOURCE    CHAT      05/01/13    02:25:15     5004
      SUBROUTINE PRECN0(TEMPS,TE,FT,LON,FT0,IRET)
C
C   INTERPOLATION LINEAIRE
C     IRET=POSITION DANS LE TABLEAU SI SUCCES , 0 SINON
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC CCOPTIO
      DIMENSION TE(*),FT(*)
      FT0=0.D0
      T2=TE(1)
      L2=1
      DT=TE(2)-T2
      IF(TEMPS.LT.T2) THEN
        IF(TEMPS.LT.T2-1.D-5*DT) GOTO 50
        FT0=FT(L2)
        IRET=L2
        RETURN
      ENDIF
      DO 40 L=2,LON
      T1=T2
      L1=L2
      T2=TE(L)
      L2=L
      IF(T1.GT.T2) GOTO 55
      IF(TEMPS.LT.T2) GOTO 60
   40 CONTINUE
C  TEMPS EN DEHORS DE LA TABLE
      DT=T2-T1
      IF(TEMPS.LT.T2+1.D-5*DT) THEN
        FT0=FT(L2)
        IRET=L2
        RETURN
      ENDIF
C
   50 IRET=-210
      RETURN
C  TEMPS NON CROISSANTS DANS LA TABLE
   55 IRET=-211
      RETURN
   60 DT=(TEMPS-T1)/(T2-T1)
      FT1=FT(L1)
      FT2=FT(L2)
      FT0=(FT2-FT1)*DT+FT1
      IRET=L1
      RETURN
      END


