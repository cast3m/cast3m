C REPER     SOURCE    JC220346  18/12/04    21:16:09     9991
      SUBROUTINE REPER(IRR)
      IMPLICIT INTEGER(I-N)
      SEGMENT MTOT
       CHARACTER*(8) MTY(0)
      ENDSEGMENT
-INC CCNOYAU
-INC CCOPTIO
-INC TMLNOMS
      CHARACTER*(*) IRR
      CHARACTER*(8) CTYP
      CHARACTER*(LONOM) CNOM
      CHARACTER*11 MYFMT
      EXTERNAL LONG
      SEGINI MTOT
C
C     UN TYPE A ETE FOURNI => ON VERIFIE QU'IL EXISTE AU MOINS UN OBJET
C                             DE CE TYPE EN MEMOIRE
      IF(IRR.NE.'        ') THEN
         MTY(**)=IRR
         DO 11 I=1,LMNNOM
           IF(INOOB2(I).EQ.IRR) GOTO 10
   11    CONTINUE
         MOTERR(1:8)=MTY(1)
         CALL ERREUR(-14)
         SEGSUP MTOT
         RETURN
      ENDIF
C
C     SINON, ON DRESSE LA LISTE DES TYPES DE TOUS LES OBJETS EN MEMOIRE
      DO 1 I=1,LMNNOM
        DO 2 J=1,MTY(/2)
          IF(INOOB2(I).EQ.MTY(J)) GO TO 1
    2   CONTINUE
        IF(INOOB2(I).EQ.'        ') GO TO 1
        MTY(**)=INOOB2(I)
    1 CONTINUE
      IF(MTY(/2).EQ.0) THEN
        CALL ERREUR (26)
        SEGSUP MTOT
        RETURN
      ENDIF
C
C     POUR CHAQUE TYPE GIBIANE A LISTER, ON CHERCHE LES OBJETS NOMMES
C     PUIS ON LES AFFICHE AU FORMAT ADAPTE (SELON LE NOM LE PLUS LONG)
   10 CONTINUE
      DO 3 II=1,MTY(/2)
        CTYP=MTY(II)
        CALL REPLIS(CTYP,MLNOMS)
        SEGACT MLNOMS
        IF(LINOMS(/2).EQ.0) GO TO 4
        MOTERR(1:8)=CTYP
        CALL ERREUR(-15)
        CALL AFINOM(MLNOMS,LMAX)
   4    CONTINUE
        SEGSUP MLNOMS
   3  CONTINUE
C
      SEGSUP MTOT
      RETURN
      END


