C OTTROT    SOURCE    CHAT      05/01/13    02:08:08     5004
      SUBROUTINE OTTROT(SIGMA0,DDEF0,SIGMA,DDEF,
     &                  VCA1,VCA2,VCA3,ICAS)
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C
      DIMENSION SIGMA0(6),DDEF0(6)
      DIMENSION SIGMA(6), DDEF(6)
      DIMENSION VCA1(3),VCA2(3),VCA3(3)
C
C
C========================================================================
C       CALCUL DE DDEF0 ET SIGMA0 DANS LE REPERE DE CALCUL
C                    RESULTAT NOTE : DDEF ET SIGMA
C========================================================================
C
      IF(ICAS.EQ.1) THEN
C
      SIGMA(1)=SIGMA0(1)*VCA1(1)*VCA1(1)+SIGMA0(4)*VCA1(2)*VCA1(1)
     &+SIGMA0(5)*VCA1(3)*VCA1(1)+SIGMA0(4)*VCA1(1)*VCA1(2)
     &+SIGMA0(2)*VCA1(2)*VCA1(2)+SIGMA0(6)*VCA1(3)*VCA1(2)
     &+SIGMA0(5)*VCA1(1)*VCA1(3)+SIGMA0(6)*VCA1(2)*VCA1(3)
     &+SIGMA0(3)*VCA1(3)*VCA1(3)
C
      SIGMA(2)=SIGMA0(1)*VCA2(1)*VCA2(1)+SIGMA0(4)*VCA2(2)*VCA2(1)
     &+SIGMA0(5)*VCA2(3)*VCA2(1)+SIGMA0(4)*VCA2(1)*VCA2(2)
     &+SIGMA0(2)*VCA2(2)*VCA2(2)+SIGMA0(6)*VCA2(3)*VCA2(2)
     &+SIGMA0(5)*VCA2(1)*VCA2(3)+SIGMA0(6)*VCA2(2)*VCA2(3)
     &+SIGMA0(3)*VCA2(3)*VCA2(3)
C
      SIGMA(3)=SIGMA0(1)*VCA3(1)*VCA3(1)+SIGMA0(4)*VCA3(2)*VCA3(1)
     &+SIGMA0(5)*VCA3(3)*VCA3(1)+SIGMA0(4)*VCA3(1)*VCA3(2)
     &+SIGMA0(2)*VCA3(2)*VCA3(2)+SIGMA0(6)*VCA3(3)*VCA3(2)
     &+SIGMA0(5)*VCA3(1)*VCA3(3)+SIGMA0(6)*VCA3(2)*VCA3(3)
     &+SIGMA0(3)*VCA3(3)*VCA3(3)
C
      SIGMA(4)=SIGMA0(1)*VCA1(1)*VCA2(1)+SIGMA0(4)*VCA1(2)*VCA2(1)
     &+SIGMA0(5)*VCA1(3)*VCA2(1)+SIGMA0(4)*VCA1(1)*VCA2(2)
     &+SIGMA0(2)*VCA1(2)*VCA2(2)+SIGMA0(6)*VCA1(3)*VCA2(2)
     &+SIGMA0(5)*VCA1(1)*VCA2(3)+SIGMA0(6)*VCA1(2)*VCA2(3)
     &+SIGMA0(3)*VCA1(3)*VCA2(3)
C
      SIGMA(5)=SIGMA0(1)*VCA1(1)*VCA3(1)+SIGMA0(4)*VCA1(2)*VCA3(1)
     &+SIGMA0(5)*VCA1(3)*VCA3(1)+SIGMA0(4)*VCA1(1)*VCA3(2)
     &+SIGMA0(2)*VCA1(2)*VCA3(2)+SIGMA0(6)*VCA1(3)*VCA3(2)
     &+SIGMA0(5)*VCA1(1)*VCA3(3)+SIGMA0(6)*VCA1(2)*VCA3(3)
     &+SIGMA0(3)*VCA1(3)*VCA3(3)
C
      SIGMA(6)=SIGMA0(1)*VCA2(1)*VCA3(1)+SIGMA0(4)*VCA2(2)*VCA3(1)
     &+SIGMA0(5)*VCA2(3)*VCA3(1)+SIGMA0(4)*VCA2(1)*VCA3(2)
     &+SIGMA0(2)*VCA2(2)*VCA3(2)+SIGMA0(6)*VCA2(3)*VCA3(2)
     &+SIGMA0(5)*VCA2(1)*VCA3(3)+SIGMA0(6)*VCA2(2)*VCA3(3)
     &+SIGMA0(3)*VCA2(3)*VCA3(3)
C
C
      DDEF(1)=DDEF0(1)*VCA1(1)*VCA1(1)+DDEF0(4)*VCA1(2)*VCA1(1)
     &+DDEF0(5)*VCA1(3)*VCA1(1)+DDEF0(4)*VCA1(1)*VCA1(2)
     &+DDEF0(2)*VCA1(2)*VCA1(2)+DDEF0(6)*VCA1(3)*VCA1(2)
     &+DDEF0(5)*VCA1(1)*VCA1(3)+DDEF0(6)*VCA1(2)*VCA1(3)
     &+DDEF0(3)*VCA1(3)*VCA1(3)
C
      DDEF(2)=DDEF0(1)*VCA2(1)*VCA2(1)+DDEF0(4)*VCA2(2)*VCA2(1)
     &+DDEF0(5)*VCA2(3)*VCA2(1)+DDEF0(4)*VCA2(1)*VCA2(2)
     &+DDEF0(2)*VCA2(2)*VCA2(2)+DDEF0(6)*VCA2(3)*VCA2(2)
     &+DDEF0(5)*VCA2(1)*VCA2(3)+DDEF0(6)*VCA2(2)*VCA2(3)
     &+DDEF0(3)*VCA2(3)*VCA2(3)
C
      DDEF(3)=DDEF0(1)*VCA3(1)*VCA3(1)+DDEF0(4)*VCA3(2)*VCA3(1)
     &+DDEF0(5)*VCA3(3)*VCA3(1)+DDEF0(4)*VCA3(1)*VCA3(2)
     &+DDEF0(2)*VCA3(2)*VCA3(2)+DDEF0(6)*VCA3(3)*VCA3(2)
     &+DDEF0(5)*VCA3(1)*VCA3(3)+DDEF0(6)*VCA3(2)*VCA3(3)
     &+DDEF0(3)*VCA3(3)*VCA3(3)
C
      DDEF(4)=DDEF0(1)*VCA1(1)*VCA2(1)+DDEF0(4)*VCA1(2)*VCA2(1)
     &+DDEF0(5)*VCA1(3)*VCA2(1)+DDEF0(4)*VCA1(1)*VCA2(2)
     &+DDEF0(2)*VCA1(2)*VCA2(2)+DDEF0(6)*VCA1(3)*VCA2(2)
     &+DDEF0(5)*VCA1(1)*VCA2(3)+DDEF0(6)*VCA1(2)*VCA2(3)
     &+DDEF0(3)*VCA1(3)*VCA2(3)
C
      DDEF(5)=DDEF0(1)*VCA1(1)*VCA3(1)+DDEF0(4)*VCA1(2)*VCA3(1)
     &+DDEF0(5)*VCA1(3)*VCA3(1)+DDEF0(4)*VCA1(1)*VCA3(2)
     &+DDEF0(2)*VCA1(2)*VCA3(2)+DDEF0(6)*VCA1(3)*VCA3(2)
     &+DDEF0(5)*VCA1(1)*VCA3(3)+DDEF0(6)*VCA1(2)*VCA3(3)
     &+DDEF0(3)*VCA1(3)*VCA3(3)
C
      DDEF(6)=DDEF0(1)*VCA2(1)*VCA3(1)+DDEF0(4)*VCA2(2)*VCA3(1)
     &+DDEF0(5)*VCA2(3)*VCA3(1)+DDEF0(4)*VCA2(1)*VCA3(2)
     &+DDEF0(2)*VCA2(2)*VCA3(2)+DDEF0(6)*VCA2(3)*VCA3(2)
     &+DDEF0(5)*VCA2(1)*VCA3(3)+DDEF0(6)*VCA2(2)*VCA3(3)
     &+DDEF0(3)*VCA2(3)*VCA3(3)
C
      ENDIF
C
C
C=======================================================================
C            CALCUL DE SIGMA0 ET DDEF0 DANS LE REPERE GLOBAL
C                    RESULTAT NOTE : SIGMA ET DDEF
C=======================================================================
C
      IF(ICAS.EQ.2) THEN
C
      SIGMA(1)=SIGMA0(1)*VCA1(1)*VCA1(1)+SIGMA0(4)*VCA2(1)*VCA1(1)
     &+SIGMA0(5)*VCA3(1)*VCA1(1)+SIGMA0(4)*VCA1(1)*VCA2(1)
     &+SIGMA0(2)*VCA2(1)*VCA2(1)+SIGMA0(6)*VCA3(1)*VCA2(1)
     &+SIGMA0(5)*VCA1(1)*VCA3(1)+SIGMA0(6)*VCA2(1)*VCA3(1)
     &+SIGMA0(3)*VCA3(1)*VCA3(1)
C
      SIGMA(2)=SIGMA0(1)*VCA1(2)*VCA1(2)+SIGMA0(4)*VCA2(2)*VCA1(2)
     &+SIGMA0(5)*VCA3(2)*VCA1(2)+SIGMA0(4)*VCA1(2)*VCA2(2)
     &+SIGMA0(2)*VCA2(2)*VCA2(2)+SIGMA0(6)*VCA3(2)*VCA2(2)
     &+SIGMA0(5)*VCA1(2)*VCA3(2)+SIGMA0(6)*VCA2(2)*VCA3(2)
     &+SIGMA0(3)*VCA3(2)*VCA3(2)
C
      SIGMA(3)=SIGMA0(1)*VCA1(3)*VCA1(3)+SIGMA0(4)*VCA2(3)*VCA1(3)
     &+SIGMA0(5)*VCA3(3)*VCA1(3)+SIGMA0(4)*VCA1(3)*VCA2(3)
     &+SIGMA0(2)*VCA2(3)*VCA2(3)+SIGMA0(6)*VCA3(3)*VCA2(3)
     &+SIGMA0(5)*VCA1(3)*VCA3(3)+SIGMA0(6)*VCA2(3)*VCA3(3)
     &+SIGMA0(3)*VCA3(3)*VCA3(3)
C
      SIGMA(4)=SIGMA0(1)*VCA1(1)*VCA1(2)+SIGMA0(4)*VCA2(1)*VCA1(2)
     &+SIGMA0(5)*VCA3(1)*VCA1(2)+SIGMA0(4)*VCA1(1)*VCA2(2)
     &+SIGMA0(2)*VCA2(1)*VCA2(2)+SIGMA0(6)*VCA3(1)*VCA2(2)
     &+SIGMA0(5)*VCA1(1)*VCA3(2)+SIGMA0(6)*VCA2(1)*VCA3(2)
     &+SIGMA0(3)*VCA3(1)*VCA3(2)
C
      SIGMA(5)=SIGMA0(1)*VCA1(1)*VCA1(3)+SIGMA0(4)*VCA2(1)*VCA1(3)
     &+SIGMA0(5)*VCA3(1)*VCA1(3)+SIGMA0(4)*VCA1(1)*VCA2(3)
     &+SIGMA0(2)*VCA2(1)*VCA2(3)+SIGMA0(6)*VCA3(1)*VCA2(3)
     &+SIGMA0(5)*VCA1(1)*VCA3(3)+SIGMA0(6)*VCA2(1)*VCA3(3)
     &+SIGMA0(3)*VCA3(1)*VCA3(3)
C
      SIGMA(6)=SIGMA0(1)*VCA1(2)*VCA1(3)+SIGMA0(4)*VCA2(2)*VCA1(3)
     &+SIGMA0(5)*VCA3(2)*VCA1(3)+SIGMA0(4)*VCA1(2)*VCA2(3)
     &+SIGMA0(2)*VCA2(2)*VCA2(3)+SIGMA0(6)*VCA3(2)*VCA2(3)
     &+SIGMA0(5)*VCA1(2)*VCA3(3)+SIGMA0(6)*VCA2(2)*VCA3(3)
     &+SIGMA0(3)*VCA3(2)*VCA3(3)
C
C
      DDEF(1)=DDEF0(1)*VCA1(1)*VCA1(1)+DDEF0(4)*VCA2(1)*VCA1(1)
     &+DDEF0(5)*VCA3(1)*VCA1(1)+DDEF0(4)*VCA1(1)*VCA2(1)
     &+DDEF0(2)*VCA2(1)*VCA2(1)+DDEF0(6)*VCA3(1)*VCA2(1)
     &+DDEF0(5)*VCA1(1)*VCA3(1)+DDEF0(6)*VCA2(1)*VCA3(1)
     &+DDEF0(3)*VCA3(1)*VCA3(1)
C
      DDEF(2)=DDEF0(1)*VCA1(2)*VCA1(2)+DDEF0(4)*VCA2(2)*VCA1(2)
     &+DDEF0(5)*VCA3(2)*VCA1(2)+DDEF0(4)*VCA1(2)*VCA2(2)
     &+DDEF0(2)*VCA2(2)*VCA2(2)+DDEF0(6)*VCA3(2)*VCA2(2)
     &+DDEF0(5)*VCA1(2)*VCA3(2)+DDEF0(6)*VCA2(2)*VCA3(2)
     &+DDEF0(3)*VCA3(2)*VCA3(2)
C
      DDEF(3)=DDEF0(1)*VCA1(3)*VCA1(3)+DDEF0(4)*VCA2(3)*VCA1(3)
     &+DDEF0(5)*VCA3(3)*VCA1(3)+DDEF0(4)*VCA1(3)*VCA2(3)
     &+DDEF0(2)*VCA2(3)*VCA2(3)+DDEF0(6)*VCA3(3)*VCA2(3)
     &+DDEF0(5)*VCA1(3)*VCA3(3)+DDEF0(6)*VCA2(3)*VCA3(3)
     &+DDEF0(3)*VCA3(3)*VCA3(3)
C
      DDEF(4)=DDEF0(1)*VCA1(1)*VCA1(2)+DDEF0(4)*VCA2(1)*VCA1(2)
     &+DDEF0(5)*VCA3(1)*VCA1(2)+DDEF0(4)*VCA1(1)*VCA2(2)
     &+DDEF0(2)*VCA2(1)*VCA2(2)+DDEF0(6)*VCA3(1)*VCA2(2)
     &+DDEF0(5)*VCA1(1)*VCA3(2)+DDEF0(6)*VCA2(1)*VCA3(2)
     &+DDEF0(3)*VCA3(1)*VCA3(2)
C
      DDEF(5)=DDEF0(1)*VCA1(1)*VCA1(3)+DDEF0(4)*VCA2(1)*VCA1(3)
     &+DDEF0(5)*VCA3(1)*VCA1(3)+DDEF0(4)*VCA1(1)*VCA2(3)
     &+DDEF0(2)*VCA2(1)*VCA2(3)+DDEF0(6)*VCA3(1)*VCA2(3)
     &+DDEF0(5)*VCA1(1)*VCA3(3)+DDEF0(6)*VCA2(1)*VCA3(3)
     &+DDEF0(3)*VCA3(1)*VCA3(3)
C
      DDEF(6)=DDEF0(1)*VCA1(2)*VCA1(3)+DDEF0(4)*VCA2(2)*VCA1(3)
     &+DDEF0(5)*VCA3(2)*VCA1(3)+DDEF0(4)*VCA1(2)*VCA2(3)
     &+DDEF0(2)*VCA2(2)*VCA2(3)+DDEF0(6)*VCA3(2)*VCA2(3)
     &+DDEF0(5)*VCA1(2)*VCA3(3)+DDEF0(6)*VCA2(2)*VCA3(3)
     &+DDEF0(3)*VCA3(2)*VCA3(3)
C
      ENDIF
C
      RETURN
      END

