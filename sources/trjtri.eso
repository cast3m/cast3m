C TRJTRI    SOURCE    CHAT      05/01/13    03:51:33     5004
      SUBROUTINE TRJTRI(IZNOEU,IZTRAV,IZAPAR,NPAPAR,J,IEL,INOELO,TLI)
C
C**********************************************************************
C
C   OBJET  : CE SOUS-PROGRAMME CALCULE L'APPARTENANCE DE POINTS A UN
C   -----    ELEMENT TRIANGULAIRE D'UN MAILLAGE M1.
C       issu de TRIOEF utilise dans le calcul des trajectoires
C
C   ARGUMENTS:
C   ---------
C
C   ENTREE  :  IZNOEU = POINTEUR DU SEGMENT CONTENANT LES COORDONNES
C                       DES NOEUDS ET LES NUMEROS DE NOEUDS DE L ELEMENT
C              IZTRAV = POINTEUR DU SEGMENT CONTENANT LES COORDONNEES
C                       DES POINTS DONT ON CHERCHE L'APPARTENANCE
C              IZAPAR = POINTEUR DU SEGMENT QUI CONTIENDRA LES
C                       APPARTENANCES
C              NPAPAR = NOMBRE DE POINTS APPARTENANT A UN ELEMENT
C              IEL    = NUMERO GLOBAL DE L'ELEMENT DANS LE MAILLAGE
C              J      = NUMERO DU POINT TRAITE
C
C              INOELO = NUMERO LOCAL SI LE POINT CHERCHE EST UN NOEUD
C                       DU TRIANGLE CONSIDERE
C              TLI    COORDONNEES BARYCENTRIQUES DU POINT CONSIDERE
C
C***********************************************************************
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION X(2),TLI(*)
C
      SEGMENT IZAPAR
           INTEGER IAPAR(4,NPT2)
      ENDSEGMENT
C
      SEGMENT IZTRAV
           REAL*8  COOR(NDIM,NPART)
      ENDSEGMENT
      SEGMENT  IZNOEU
            REAL*8 XELE(IDIM,NOEL)
            INTEGER NOEGLO(NOEL)
      ENDSEGMENT
C
      IDIM=XELE(/1)
      NOEL=XELE(/2)
      INOELO=0
      IF(NOEL.GT.3) GO TO 20
C
C---  CAS TRI3
C
      IF(IAPAR(1,J).NE.0) GO TO 9999
      X(1)=COOR(1,J)
      X(2)=COOR(2,J)
      CALL APAT3(X,XELE,IELEM,IARTRI,INOTRI,TLI)
      IF(IELEM.EQ.0) GO TO 9999
C
C---  LE POINT APPARTIENT A L'ELEMENT
C
      NPAPAR=NPAPAR+1
      IAPAR(1,J)=IEL
C
C---  APPARTENANCE A UNE ARETE DU TRI3
C
      IF(IARTRI.EQ.0) GO TO 9999
      IAPAR(3,J)=IARTRI
C
C---  APPARTENANCE A UN NOEUD DU TRI3
C
      IF(INOTRI.EQ.0) GO TO 9999
      INOELO=INOTRI
      IAPAR(4,J)=NOEGLO(INOTRI)
      GO TO 9999
C
C---  CAS TRI6-TRI7
C
   20 CONTINUE
      IF(IAPAR(1,J).NE.0) GO TO 9999
      X(1)=COOR(1,J)
      X(2)=COOR(2,J)
      CALL APAT67(NOEL,X,XELE,IELEM,IARTRI,INOTRI,TLI)
      IF(IELEM.EQ.0) GO TO 9999
C
C---  LE POINT APPARTIENT A L'ELEMENT
C
      NPAPAR=NPAPAR+1
      IAPAR(1,J)=IEL
C
C---  APPARTENANCE A UNE ARETE DU TRI6 OU TRI7
C
      IF(IARTRI.EQ.0) GO TO 9999
      IAPAR(3,J)=IARTRI
C
C---  APPARTENANCE A UN NOEUD DU TRI6 OU TRI7
C
      IF(INOTRI.EQ.0) GO TO 9999
      INOELO=INOTRI
      IAPAR(4,J)=NOEGLO(INOTRI)
C
C
 9999 RETURN
      END

