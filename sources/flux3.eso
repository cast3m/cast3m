C FLUX3     SOURCE    CHAT      05/01/13    00:05:09     5004

************************************************************************
*                             F L U X 3
*                             ---------
*
* FONCTION:
* ---------
*
*     DONNE LA FORMULATION ELEMENT-FINI DES FACES D'UN MASSIF
*
* PARAMETRES:   (E)=ENTREE   (S)=SORTIE
* -----------
*     NEF     (E)  NUMERO DE L'ELEMENT-FINI MASSIF DANS NOMTP
*     NBNN    (E)  NOMBRE DE NOEUDS DANS L'ELEMENT-FINI CONSIDERE
*     NEFACE  (S)  NUMERO DE L'ELEMENT-FINI LIE A LA FACE
************************************************************************

      SUBROUTINE FLUX3 (NEF,NBNN,NEFACE)

*  ELEMENTS MASSIFS BIDIMENSIONNELS LINEAIRES
      IMPLICIT INTEGER(I-N)
      IF (NEF.EQ.4.OR.NEF.EQ.8) THEN
         NEFACE=2
*  ELEMENTS MASSIFS BIDIMENSIONNELS QUADRATIQUES
      ELSE IF (NEF.EQ.6.OR.NEF.EQ.10) THEN
         NEFACE=3
*  ELEMENTS MASSIFS TRIDIMENSIONNELS LINEAIRES
      ELSE IF (NEF.EQ.14.OR.NEF.EQ.16.OR.NEF.EQ.23.OR.NEF.EQ.25) THEN
        IF (NBNN.EQ.3) THEN
          NEFACE=4
        ELSE
          NEFACE=8
        ENDIF
*  ELEMENTS MASSIFS TRIDIMENSIONNELS QUADRATIQUES
      ELSE IF (NEF.EQ.15.OR.NEF.EQ.17.OR.NEF.EQ.24.OR.NEF.EQ.26) THEN
        IF (NBNN.EQ.6) THEN
          NEFACE=6
        ELSE
          NEFACE=10
        ENDIF
*  ELEMENTS MASSIFS 1D
      ELSE IF (NEF.EQ.191.OR.NEF.EQ.192) THEN
        NEFACE=45
      ELSE
        NEFACE=0
      ENDIF

      RETURN
      END



