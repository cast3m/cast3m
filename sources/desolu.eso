C DESOLU    SOURCE    CHAT      05/01/12    22:43:36     5004
      SUBROUTINE DESOLU(IRET)
C
C  =====================================================================
C  =  DESTRUCTION D'UN OBJET SOLUTION  PARTIELLEMENT POUR VIBRA        =
C  =                                                                   =
C  =  CREATION    06/01/86                                             =
C  =  PROGRAMMEUR GUILBAUD                                             =
C  =====================================================================
C
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMSOLUT
-INC SMELEME
      CHARACTER*8 ITMODE,ITSTAT,ITDYNA,ITPSEU
      DATA ITMODE/'MODE    '/,ITSTAT/'SOLUSTAT'/
      DATA ITDYNA/'DYNAMIQU'/,ITPSEU/'PSEUMODE'/
      MSOLUT=IRET
      SEGACT MSOLUT
      ITYS=0
      IF(ITMODE.NE.ITYSOL) GOTO 101
      ITYS=1
      GO TO 200
101   IF(ITYSOL.NE.ITSTAT.AND.ITYSOL.NE.ITPSEU) GOTO 102
      ITYS=2
      GOTO 200
102   IF(ITYSOL.NE.ITDYNA) GOTO 103
      ITYS=3
      GO TO 200
 103  MOTERR(1:8)='SOLUTION'
      MOTERR(9:16)=ITYSOL
      CALL ERREUR(66)
C     L OPERATEUR DETRUIRE NE FONCTIONNE PAS POUR UN OBJET SOLUTION
C     COMPORTANT CE SOUS-TYPE
      SEGDES MSOLUT
      GOTO 1000
  200 NIPO=MSOLIS(/1)
      MSOLRE=MSOLIS(1)
      IF(MSOLRE.NE.0) SEGSUP MSOLRE
      MSOLEN=MSOLIS(2)
      IF(MSOLEN.NE.0) SEGSUP MSOLEN
      MELEME=MSOLIS(3)
      IF(MELEME.NE.0.AND.ITYS.EQ.1) SEGSUP MELEME
      MSOLEN=MSOLIS(4)
      IF(MSOLEN.NE.0) SEGSUP MSOLEN
        DO 230 NIP=5,NIPO
        MSOLEN=MSOLIS(NIP)
        IF(MSOLEN.NE.0) SEGSUP MSOLEN
  230   CONTINUE
 1000 CONTINUE
      SEGSUP MSOLUT
      RETURN
      END

