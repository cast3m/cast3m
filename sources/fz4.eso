C FZ4       SOURCE    CHAT      05/01/13    00:14:20     5004
      FUNCTION FZ4(T)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      COMMON/CMCHAM/ D1,D2,R,A,U,DD1,DD2,LSOMD,LD1,LD2
      COMMON/CMARGT/SINT,COST,RSINT,RCOST,RSIN2,XA,XU,XXA,XXU,SQA2,SQA1
     +,SQU2,SQU1
      LOGICAL LSOMD,LD1,LD2
      FON(DMI,D,ABSD,SQA,SQU)=SIGN(DMI,D)*LOG(((SQA-ABSD)*(SQU+ABSD))/
     +((SQU-ABSD)*(SQA+ABSD)))
      CALL ARGUME(T)
      IF(ABS(SINT).LT.0.00001D0) GOTO 11
      DMI=0.5D0
      ABSD1=ABS(D1)
      ABSD2=ABS(D2)
      IF(LSOMD) GOTO 3
4     IF(LD1)   GOTO 6
7     IF(LD2)   GOTO 8
      GOTO 9
3     FZ= FON(DMI,D2,ABSD2,SQA2,SQU2)*2.D0
      GOTO 10
6     FZ= FON(DMI,D2,ABSD2,SQA2,SQU2)
      GOTO 10
8     FZ=-FON(DMI,D1,ABSD1,SQA1,SQU1)
      GOTO 10
9     FZ= FON(DMI,D2,ABSD2,SQA2,SQU2)-FON(DMI,D1,ABSD1,SQA1,SQU1)
10    FZ4=RSINT*FZ
      RETURN
11    FZ4=0.D0
      RETURN
      END

