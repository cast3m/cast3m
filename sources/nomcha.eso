C NOMCHA    SOURCE    PV        18/12/06    21:15:24     10030
      SUBROUTINE NOMCHA(NAM,IVAL)
      IMPLICIT INTEGER(I-N)
-INC CCNOYAU
-INC SMBLOC
      CHARACTER*(*) NAM,IVAL
      CALL POSCHA(IVAL,II)
C RECHERCHE DU NOM DANS LA PILE DES NOMS
      IL=LEN(NAM)
      DO 765 I=IL,1,-1
      IF(NAM(I:I).NE.' ') GO TO 764
  765 CONTINUE
      I=1
  764 IL=I
      CALL POSCHA(NAM(1:IL),IO)
       DO 3 I=MDEOBJ,LMNNOM
         IF(INOOB1(I).NE.IO) GO TO 3
           INOOB2(I)='MOT'
           IOUEP2(I)=II
           RETURN
   3  CONTINUE
  11  CONTINUE
C IL FAUT CREER LE NOM
      LMNNOM=LMNNOM+1
      IF(LMNNOM.GT.INOOB1(/1)) THEN
        N= LMNNOM+50
        SEGADJ ITABOB,ITABOC,ITABOD
      ENDIF
      N=LMNNOM
      INOOB1(N)=IO
      INOOB2(N)='MOT'
      IOUEP2(N)=II
      RETURN
      END


