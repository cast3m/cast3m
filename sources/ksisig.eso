C KSISIG    SOURCE    PV        11/03/07    21:17:24     6885
      SUBROUTINE KSISIG(WRK0,JC,WRK2,NCOURB,KERRE)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC SMEVOLL
-INC SMLREEL
      SEGMENT WRK0
       REAL*8 XMAT(NCOMAT)
      ENDSEGMENT
      SEGMENT/WRK2/(TRAC(LTRAC)*D)
      DATA NCOMAX/130/
      KERRE=0
      MEVOLL=nint(XMAT(JC))
      IF(MEVOLL.EQ.0) THEN
      KERRE=37
      RETURN
      ENDIF
      SEGACT MEVOLL
      KEVOLL=IEVOLL(1)
      SEGACT KEVOLL
      MLREEL=IPROGX
      MLREE1=IPROGY
      SEGDES KEVOLL
      SEGACT MLREEL,MLREE1
      NBPOIX=PROG(/1)
      NBPOIY=MLREE1.PROG(/1)
      IF(NBPOIX.GT.NCOMAX+1) KERRE=31
      IF(NBPOIX.LT.2)        KERRE=32
      IF(KERRE.EQ.0) GO TO 693
 692  CONTINUE
C
C   ERREUR
C
      SEGDES MLREEL,MLREE1
      SEGDES MEVOLL
      GO TO 777
 693  CONTINUE
C
C        VERIFICATION ANODINE
C
      DO 100 I=3,NBPOIX
      I1=I-1
      DEPS=PROG(I)-PROG(I1)
      IF(DEPS.EQ.0.D0) THEN
      KERRE=33
      GO TO 692
      ENDIF
 100  CONTINUE
C
      NCOURB=0
      DO 695 I=1,NBPOIX
      PKSI=PROG(I)
      PK=MLREE1.PROG(I)
      NCOURB=NCOURB+1
      TRAC(2*NCOURB-1)=PKSI
      TRAC(2*NCOURB)=PK
  695 CONTINUE
C
      SEGDES MLREEL,MLREE1
      SEGDES MEVOLL
      RETURN
C
  777 CONTINUE
      RETURN
      END


