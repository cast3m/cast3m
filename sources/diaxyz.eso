C DIAXYZ    SOURCE    CHAT      05/01/12    22:50:02     5004
      SUBROUTINE DIAXYZ(ITYP,SIGT,SIGEL,VECPRO,IBO,A,B,C,B1,B2)
C
C         EFFECTUE LA TRANSFORMATION DE SIGAMA DIAGONALISE EN
C         SIGAM GLOBAL
C
C         ENTREE  SIGT
C         SORTIE SIGEL
C             ITYP TYPE DE L'ELEMENT
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION SIGT(*),SIGEL(*),VECPRO(*)
C
      GO TO (70,71,71,73,74,75,76,77,78,79,80,81,71),ITYP
C
C   MODIF DU 05-01-96
C   POUR ITYP=13 (COQUES EPAISSES) ON PASSAIT ICI (AU 83)
C   DESORMAIS ON VA AU 71 COMME LES CALCULS EN CONTRAINTE PLANE
C
C   83 CONTINUE
C               COQUES AVEC CISAILLEMENTS TRANSVERSES
C      SIGEL(1)=B*(SIGT(1)-SIGT(2))
C      SIGEL(2)=B*(SIGT(1)+SIGT(2))
C      SIGEL(3)=SIGT(3)
C      SIGEL(4)=SIGT(4)
C      SIGEL(5)=SIGT(5)
C      SIGEL(6)=SIGT(6)
C      GO TO 740
  81  CONTINUE
C                      TUYAUX
  80  CONTINUE
C                      POUTRES
      DO 810 I=1,6
810   SIGEL(I)=SIGT(I)
      GO TO 740
   79 CONTINUE
      GO TO 740
   78 CONTINUE
      GO TO 740
   77 SIGEL(1)=SIGT(1)
      GO TO 740
   76 DO 760 IA=1,4
  760 SIGEL(IA)=SIGT(IA)
      GO TO 740
   75 CONTINUE
      SIGEL(1)=B*(SIGT(1)-SIGT(2))
      SIGEL(2)=B*(SIGT(1)+SIGT(2))
      SIGEL(4)=SIGT(4)
      SIGEL(3)=SIGT(3)
      GO TO 740
   74 CONTINUE
      DO 7401 IB=1,3
      SIGEL(IB)=0.
      DO 7402 IC=1,3
      IP=3*(IC-1)+IB
 7402 SIGEL(IB)=SIGEL(IB)+VECPRO(IP)*SIGT(IC)
 7401 SIGEL(3+IB)=SIGT(3+IB)
      GO TO 740
   71 CONTINUE
      B1=B
      B2=B
      DO 710 I=1,IBO
      IP=(I-1)*3
      SIGEL(IP+1)=B1*SIGT(IP+1)-B2*SIGT(IP+2)
      SIGEL(IP+2)=B2*SIGT(IP+1)+B1*SIGT(IP+2)
  710 SIGEL(3+IP)=SIGT(3+IP)
      GO TO 740
   73 CONTINUE
      SIGEL(3)=SIGT(3)
      GO TO 740
   70 CONTINUE
      SIGT(1)=SIGT(1)*A
      SIGT(2)=SIGT(2)*B
      SIGT(3)=SIGT(3)*C
      SIGEL(1)=SIGT(1)+SIGT(2)+SIGT(3)
      SIGEL(2)=SIGT(1)-SIGT(2)+SIGT(3)
      SIGEL(3)=SIGT(1)-2.*SIGT(3)
      SIGEL(4)=SIGT(4)
      SIGEL(5)=SIGT(5)
      SIGEL(6)=SIGT(6)
  740 CONTINUE
      RETURN
      END


