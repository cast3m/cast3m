C NORME2    SOURCE    CHAT      05/01/13    02:00:22     5004
      SUBROUTINE NORME2 (IPX,XNORM2,IPRR,IPY,YNORM2,IPLMOX,
     C IPLMOY,IPRX)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
************************************************************************
*
*                             N O R M E 2
*                             -----------
*
* FONCTION:
* ---------
*
*     MODIFIER PAR UN COEFFICIENT DE PROPORTIONALITE UN 'CHPOINT' POUR
*     QUE SA "NORME AU CARRE" VAILLE +/- "XNORM2".
*
* MODE D'APPEL:
* -------------
*
*     CALL NORME2 (IPX,XNORM2,IPRR,IPY,YNORM2)
*
* PARAMETRES:   (E)=ENTREE   (S)=SORTIE
* -----------
*
*     IPX     ENTIER    (E)  POINTEUR DU 'CHPOINT' A MODIFIER.
*     XNORM2  REEL DP   (E)  VALEUR DESIREE POUR LA "NORME AU CARRE".
*     IPRR    ENTIER    (E)  POINTEUR DE LA 'RIGIDITE' SERVANT A
*                            "NORMER".
*     IPY     ENTIER    (S)  POINTEUR DU 'CHPOINT' MODIFIE.
*     YNORM2  REEL DP   (S)  VALEUR DE LA "NORME AU CARRE" DU 'CHPOINT'
*                            DE POINTEUR "IPY".
*
* REMARQUES:
* ----------
*
*     LA "NORME AU CARRE" EST DEFINIE PAR "XT.RR.X"
*
*     SI L'ON ECRIT "NORME AU CARRE" ENTRE GUILLEMETS, C'EST PARCE
*     QU'IL NE S'AGIT PAS D'UNE VERITABLE NORME SI "RR" N'EST PAS
*     DEFINIE POSITIVE.
*
*     LA VARIABLE "YNORM2" EXISTE PRECISEMENT POUR INDIQUER SI L'ON A
*     BIEN OBTENU "XNORM2" POUR NORME AU CARRE ET NON PAS "-XNORM2".
*     ELLE MET EGALEMENT EN EVIDENCE LES ERREURS D'ARRONDI.
*
* SOUS-PROGRAMMES APPELES:
* ------------------------
*
*     MUCHPO, XTMX.
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     PASCAL MANIGOT     17 AVRIL 1985
*
* LANGAGE:
* --------
*
*     FORTRAN77
*
************************************************************************
*
-INC CCOPTIO
*
*
      IPRX=0
      IPRRX=0
      IF((IPLMOX*IPLMOY).EQ.0) GOTO 10
      CALL MUCPRI(IPX,IPRR,IPRRX)
      CALL XTY1(IPX,IPRRX,IPLMOX,IPLMOY,XTRRX)
      GOTO 20
10    CALL XTMX (IPX,IPRR,  XTRRX)
      IF (IERR .NE. 0) RETURN
20    CONTINUE
*
      COEFF = SQRT( ABS(XNORM2 / XTRRX) )
      MULTPL = 1
      CALL MUCHPO (IPX,COEFF,  IPY,MULTPL)
      IF (IERR .NE. 0) RETURN
      IF(IPRRX.EQ.0) GOTO 30
      CALL MUCHPO (IPRRX,COEFF,IPRX,MULTPL)
      CALL DTCHPO(IPRRX)
*
30    CONTINUE
      YNORM2 = ABS(XNORM2/XTRRX) * XTRRX
      IF (IERR .NE. 0) RETURN
      IF (IIMPI .EQ. 627) THEN
         WRITE (IOIMP,*) 'ON DOIT AVOIR ',YNORM2,' = +/- ',XNORM2
      END IF
*
      END

