C ARGU1     SOURCE    PV        18/12/06    21:15:07     10030
      SUBROUTINE ARGU1(ITYP,IRET,ICODE,IRETOU,MPROCI)
C
C  SERT A LIRE UNE VALEUR DE TYPE "ITYP" DANS L'ETAGE INFERIEUR DE LA
C  PROCEDURE PUIS A REMETTRE TOUT EN PLACE
C
C  EN ENTREE MPROCE = SEGMENT REPRESENTANT L'ETAT DE LECTURE DU NIVEAU
C  INFERIEUR  EN SORTIE NOUVELLE VALEUR POUR SE SEGMENT. IL FAUT FAIRE
C  LA MISE A JOUR DU SEGMENT MBLOC A L'EXTERIEUR
C
      IMPLICIT INTEGER (Y)
      IMPLICIT INTEGER (I-N)
-INC CCOPTIO
-INC CCNOYAU
-INC SMBLOC
-INC CCREDLE
      CHARACTER*(*) ITYP
      CHARACTER*72 CYOT
      CHARACTER*500 CYEXT
      sredle=iredle
C  SAUVETAGE COMPLET DE L'ETAT DE CCNOYAU ET DE CCREDLE
C  EN VUE D'Y REVENIR
      MPROCE=MPROCI
      YPOOB=JPOOB
      YTABNO=ITABNO
      YLCTAB=LECTAB
      YTTINT=ITTINT
      YSTOP=ISTOP
      YBPILE=IBPILE
      YHPILE=IHPILE
      YMOTLU=IMOTLU
      YPTEM=IPTEM
      YBNOM=NBNOM
      YNILU=INILU
      YOMLU=NOMLU
      YEGAL=IEGAL
      YIPOS=IPOS
      YDPAR=IDPAR
      YFPAR=IFPAR
      YNTEXT=INTEXT
      YPVINT=IPVINT
      YINTPO=IINTPO
      YNTEMP=INTEMP
      YRAZ=IRAZ
      CYEXT=TEXT
      CYOT=MOT
      YCOUR=ICOUR
      YPREC=IPREC
      YRAN=NRAN
      YLU=ILU
      YUTIL=MBFONC
      YFINAN=IFINAN
      YINT=ITINTE(/1)
      I2=YINT
      YTAB= ITANOM(/2)
      I1=YTAB
      SEGDES ITTINT,ITABNO,JPOOB
C  REMISE EN ETAT DE LA LECTURE DE CRAN EN DESSOUS
      SEGACT MPROCE
C
C  REPRISE DANS MPROCE DE L'ETAT DE LA LECTURE
C
      JPOOB=MPOOB
      ITABNO=KTABNO
      LECTAB=LLCTAB
      ISTOP=LSTOP
      IBPILE=LBPILE
      IHPILE=LHPILE
      IMOTLU=LMOTLU
      IPTEM=LPTEM
      NBNOM=LBNOM
      INILU=LNILU
      NOMLU=LOMLU
      IEGAL=LEGAL
      IPOS=LIPOS
      IDPAR=LDPAR
      IFPAR=LFPAR
      MBFONC=LUTIL
      INTEXT=LNTEXT
      ITTINT=LTTINT
      IPVINT=LPVINT
      IINTPO=LINTPO
      INTEMP=LNTEMP
      IRAZ=LRAZ
      TEXT=LEXT
      MOT(1:72)=LOT(1:72)
      ICOUR=LCOUR
      IPREC=LPREC
      NRAN=LRAN
      ILU=LLU
      IFINAN=LFINAN
      SEGACT ITABNO*MOD,ITTINT*MOD,JPOOB*MOD
      IF(ITANOM(/2).GE.I1) GO TO 10
      M=I1
      SEGADJ ITABNO
   10 CONTINUE
      IF(ITINTE(/1).GE.I2) GO TO 20
      K=I2-ITINTE(/1)
      DO 21 I=1,K
      ITINTE(**)=0
   21 CONTINUE
   20 CONTINUE
      SEGSUP MPROCE
C
C  ON EST PRET A FAIRE UNE LECTURE ON PASSE PAR LIRABJ
C
      CALL LIRABJ (ITYP,IRET,ICODE,IRETOU)
C
C  ON SAUVE LE NOUVEL ETAT DE LA LECTURE DANS UN SEGMENT MPROCE
C  EQUIVALLENT A PROCSA
C
      SEGINI MPROCE
      MPROCI=MPROCE
      MPOOB=JPOOB
      KTABNO=ITABNO
      LLCTAB=LECTAB
      LTTINT=ITTINT
      LSTOP=ISTOP
      LBPILE=IBPILE
      LHPILE=IHPILE
      LMOTLU=IMOTLU
      LPTEM=IPTEM
      LBNOM=NBNOM
      LNILU=INILU
      LOMLU=NOMLU
      LEGAL=IEGAL
      LIPOS=IPOS
      LDPAR=IDPAR
      LFPAR=IFPAR
      LNTEXT=INTEXT
      LPVINT=IPVINT
      LINTPO=IINTPO
      LNTEMP=INTEMP
      LRAZ=IRAZ
      LEXT=TEXT
      LOT=MOT
      LCOUR=ICOUR
      LPREC=IPREC
      LRAN=NRAN
      LLU=ILU
      LUTIL=MBFONC
      LFINAN=IFINAN
      LINT=ITINTE(/1)
      LTAB=ITANOM(/2)
      I2=ITINTE(/1)
      I1 = ITANOM(/2)
      SEGDES ITTINT,ITABNO,JPOOB
C
C REPRISE DE L'ETAT DE LECTURE EN ENTREE DU SUBROUTINE
C
      JPOOB=YPOOB
      ITABNO=YTABNO
      LECTAB=YLCTAB
      ISTOP=YSTOP
      IBPILE=YBPILE
      IHPILE=YHPILE
      IMOTLU=YMOTLU
      IPTEM=YPTEM
      NBNOM=YBNOM
      INILU=YNILU
      NOMLU=YOMLU
      IEGAL=YEGAL
      IPOS=YIPOS
      IDPAR=YDPAR
      IFPAR=YFPAR
      MBFONC=YUTIL
      INTEXT=YNTEXT
      ITTINT=YTTINT
      IPVINT=YPVINT
      IINTPO=YINTPO
      INTEMP=YNTEMP
      IRAZ=YRAZ
      TEXT=CYEXT
      MOT(1:72)=CYOT(1:72)
      ICOUR=YCOUR
      IPREC=YPREC
      NRAN=YRAN
      ILU=YLU
      IFINAN=YFINAN
      SEGACT ITABNO*MOD,ITTINT*MOD,JPOOB*MOD
      IF(ITANOM(/2).GE.I1) GO TO 12
      M=I1
      SEGADJ ITABNO
   12 CONTINUE
      IF(ITINTE(/1).GE.I2) GO TO 22
      K=I2-ITINTE(/1)
      DO 23 I=1,K
      ITINTE(**)=0
   23 CONTINUE
   22 CONTINUE
      SEGDES MPROCE
      RETURN
      END












