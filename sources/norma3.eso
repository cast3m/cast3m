C NORMA3    SOURCE    CB215821  18/04/04    21:15:07     9798
      SUBROUTINE NORMA3(ICHPOI,IPLMOT,MOTCLE,IFLUI,COEFP,COEFPI,PGRAND)
************************************************************************
*
*                             N O R M A 3
*                             -----------
*
* FONCTION:
* ---------
*
*     NORMER UN 'CHPOINT EN RAMENANT SA PLUS GRANDE VALEUR A 1
*
* MODE D'APPEL:
* -------------
*
*     CALL NORMA3 (ICHPOI,IPLMOT,MOTCLE,IFLUI,COEFP,COEFPI,IPLAC1,PGRAND
*
* ARGUMENTS:   (E)=ENTREE   (S)=SORTIE
* ----------
*
*     ICHPOI  ENTIER    (E)  POINTEUR SUR L'OBJET 'CHPOINT' A NORMER.
*     IPLMOT  ENTIER    (E)  VOIR LE S.P. "MAXIM1".
*     MOTCLE  CHARACTER (E)  VOIR LE S.P. "MAXIM1".
*     IFLUI   ENTIER    (E)  IL Y A DES COEF POUR P ET PI (0 SINON)
*     COEFP   REEL      (E)  COEFFICIENT A APPLIQUER A LA COMPOSANTE P
*     COEFPI  REEL      (E)  COEFFICIENT A APPLIQUER A LA COMPOSANTE PI
*
*     PGRAND  REEL      (S)  COEFFICIENT DE NORMALISATION
*     ICHPOI  ENTIER    (S)  POINTEUR SUR L'OBJET 'CHPOINT' NORME.
*
* SOUS-PROGRAMMES APPELES:
* ------------------------
*
*     MAXIM4,MAXIM1, ERREUR.
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     MARTINE FARVACQUE     10 JUIN 86
*
* LANGAGE:
* --------
*
*     ESOPE + FORTRAN77
*
************************************************************************
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMCHPOI
*
      REAL*8      PGRAND,COEFP,COEFPI
      CHARACTER*4 MOTCLE
*
*    --- NORMALISATION DU FLUIDE
      IF(IFLUI.NE.0) CALL MAXIM4 (ICHPOI,COEFP,COEFPI)
*
*     -- RECHERCHE DU MAXIMUM --
      IPLAC1=0
      CALL MAXIM1 (ICHPOI,IPLMOT,MOTCLE,IPLAC1,PGRAND)
      IF (IERR .NE. 0) RETURN
      IF (PGRAND .EQ. 0.D0) THEN
         CALL ERREUR (150)
         RETURN
      ENDIF

C     Division du CHPOINT par le FLOTTANT PGRAND
      IOPERA=5
      IARGU =2
      I1    =0
      CALL OPCHP1(ICHPOI,IOPERA,IARGU,I1,PGRAND,ICHP1,IRET)
      IF (IRET.EQ.0) CALL ERREUR(5)
      ICHPOI=ICHP1
      RETURN
      END


