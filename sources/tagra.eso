C TAGRA     SOURCE    BP208322  15/06/22    21:23:13     8543
      SUBROUTINE TAGRA(IPO1,IPO2,IRET)
C---------------------------------------------------------------------
C
C  ENTREES
C     IPO1 =POINTEUR SUR UN CHAMELEM DE GRADIENT OU GRAFLEXI
C
C  SORTIES
C     IPO2 =POINTEUR SUR UN CHAMELEM DE GRADIENT OU GRAFLEXI
C     IRET =1  OU  0   SUIVANT SUCCES OU PAS
C---------------------------------------------------------------------
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC CCOPTIO
-INC CCHAMP
-INC SMCHAML
C
      IRET=1
      MCHEL1=IPO1
      SEGINI,MCHELM=MCHEL1
      IPO2=MCHELM
      NSOUS=IMACHE(/1)
      IF(TITCHE.EQ.'GRADIENT') THEN
      GO TO 10
      ELSE IF(TITCHE.EQ.'GRADIENT DE FLEXION') THEN
      GO TO 10
      ENDIF
C
C    ERREUR   IL FAUT UN MCHAML DE SOUS TYPE GRADIENT
C                                         OU GRAFLEXI
C
      MOTERR(1:8)='GRADIENT'
      MOTERR(9:16)='GRAFLEXI'
      CALL ERREUR(109)

      IRET=0
      CALL GINT2
      GOTO 666
 10   CONTINUE
C
      DO 200 IA=1,NSOUS
      MCHAM1=ICHAML(IA)
      SEGINI,MCHAML=MCHAM1
      ICHAML(IA)=MCHAML
      IF(IELVAL(/1).NE.9) THEN
C
C    ERREUR DANS LES TAILLES DES CHAMPS PAR ELEMENTS
C
      MOTERR(1:8)='TAGRA'
      IRET=0
      CALL ERREUR(146)
      GOTO 777
      ENDIF
C    PERMUTATION DES COMPOSANTES
      N2=IELVAL(2)
      N4=IELVAL(4)
      N3=IELVAL(3)
      N7=IELVAL(7)
      N6=IELVAL(6)
      N8=IELVAL(8)
      IELVAL(2)=N4
      IELVAL(4)=N2
      IELVAL(3)=N7
      IELVAL(7)=N3
      IELVAL(6)=N8
      IELVAL(8)=N6
      SEGDES MCHAM1,MCHAML
  200 CONTINUE
      SEGDES MCHEL1,MCHAML
      RETURN
  777 CONTINUE
      SEGDES MCHAML
      SEGSUP MCHAM1
  666 CONTINUE
      SEGDES MCHELM
      SEGSUP MCHEL1
      RETURN
      END









