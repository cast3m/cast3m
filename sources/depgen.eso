C DEPGEN    SOURCE    CHAT      05/01/12    22:42:26     5004
C
      SUBROUTINE DEPGEN(IPB,IPX,PROPRE,IBBX2,IPLMOX,IPLMOY)
C
C********************************************************************
C
C      SBR APPELE PAR ITINV
C
C      CALCUL DES DEPLACEMENTS GENERALISES
C      """""""""""""""""""""""""""""""""""
C         ECRIT PAR D. BROCHARD   15/06/86
C
C
C      IPB POINTEUR MASSE
C      IPX POINTEUR MODE
C      PROPRE VECTEUR DES CARACTERISTIQUES MODALES VOIR ITINV
C      IBBX2 POINTEUR SUR CHAMPONT  M*X
C      IPLIMO POINTEUR SUR LISTMOTS CONTENANT LES COUPLES UX FX ETC
C             POUR APPEL DE XTY1
C
C      CAS PLAN QX,QY  (QZ=0)
C      CAS AXISYMETRIQUE  QX=QY=0  QZ NON NUL)  QZ=QZ
C      FOURIER:
C         N=0  QZ NON NUL QX=QY=0 QZ+QZ
C         N=1 (HARM.SYM.) QY=QZ=0 QX NON NUL  QX=(QR-QT)
C         N=-1 (HARM.ANTIS.) QX=QZ=0 QY NON NUL QY=(QR+QT)
C
C
C
C      15/05/86
C      ________
C
C      LES CAS N DIFFERENT DE 0 N ONT PU ETRE TESTES CAR LES NUMEROS
C      D HARMONIQUE NE SONT PAS STOCKES DANS LES CHAMPS-POINT
C
C      SOUS PROGRAMME APPELANT : ITINV
C
C      SOUS PROGRAMME APPELE:
C         DEPGE1 : CALCUL  DTMU EN TESTANT SI ON EST EN SERIE DE
C                  FOURIER OU NON
C
C********************************************************************
C
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      REAL*8 PROPRE(*)
-INC SMCHPOI
-INC SMELEME
-INC CCOPTIO
C
      CHARACTER*4 MOT(3)
*
*     ON PREND LE NUMERO D'OPTION DANS LE MCHPOI ,VARIABLE IFOPOI
*
      MCHPOI=IPX
      SEGACT MCHPOI
      IFOU1=IFOPOI
      SEGDES MCHPOI
      JFOUR=IFOU1+4
*
*     IMPRESSIONS
*
      IF(IIMPI.EQ.322) WRITE(IOIMP,1000) JFOUR
1000  FORMAT(/10X,'SBR DEPGEN  JFOUR',I5)
*
*     ANCIENNE VERSION     JFOUR=IFOUR+4
*
      GOTO(200,200,200,210,220,230),JFOUR
200   CONTINUE
C
C     CAS PLAN  QX QY    (QZ= 0)
C
      PROPRE(5)=0.D0
      MOT(1)='UX'
      MOT(2)='UY'
      LMOT=2
520   DO 500 IMOT=1,LMOT
      CALL DEPGE1(IPB,IPX,PROPRE(IMOT+2),MOT(IMOT),IBBX2,IPLMOX,
     C IPLMOY)
500   CONTINUE
      GOTO 999
210   CONTINUE
C
C     CAS AXISYMETRIQUE  QX=QY=0    QZ
C
      PROPRE(3)=0.D0
      PROPRE(4)=0.D0
      MOT(1)='UZ'
      CALL DEPGE1(IPB,IPX,PROPRE(5),MOT(1),IBBX2,IPLMOX,IPLMOY)
      PROPRE(5)=PROPRE(5)
      GOTO 999
220   CONTINUE
C
C     SERIE DE FOURIER
C        N DIFF. 1 ET 0 QX=QY=QZ=0
C        N =1 QY=QZ=0  QX=QR-QT HARM. SYM.
C             QX=QZ=0  QY=QR+QT HARM.ANTYS.
C        N=0  QX=QY=0  QZ NON NUL
C
      MOT(1)='UX'
      MOT(2)='UY'
      MOT(3)='UZ'
      LMOT=3
      DO 510 IMOT=1,LMOT
      CALL DEPGE1(IPB,IPX,PROPRE(2+IMOT),MOT(IMOT),IBBX2,IPLMOX,
     C IPLMOY)
510   CONTINUE
      PROPRE(3)=PROPRE(3)
      PROPRE(4)=PROPRE(4)
      PROPRE(5)=PROPRE(5)
      GOTO 999
230   CONTINUE
C
C     CAS TRIDIM
C
      MOT(1)='UX'
      MOT(2)='UY'
      MOT(3)='UZ'
      LMOT=3
      GOTO 520
999   CONTINUE
      RETURN
      END


