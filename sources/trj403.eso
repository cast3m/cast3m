C TRJ403    SOURCE    CHAT      05/01/13    03:48:11     5004
      SUBROUTINE TRJ403 (XNOEU,X,G)
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C     CALCUL DES COORDONNEES DE REFERENCE DANS UN TET4
C     XNOEU COORDONNEES DES SOMMETS
C     X                 REELLES
C     G                 DE REFERENCE
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C   si X1 X2 X3 X4 sont les noeuds du tetraedre et L1 L2 L3 L4 les
C  coordonnées barycentriques d' un point M . L2 L3 L4 sont egaux aux
C  coordonnées de référence de M. On va donc resoudre le systeme:
C        ->      -->      -->      -->      -->
C      | OM = L1 OX1 + L2 OX2 + L3 OX3 + L4 OX4
C      |  1 = L1 + L2 + L3 + L4
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      DIMENSION XNOEU(3,4),X(3),G(3)
      A1= XNOEU(1,2)-XNOEU(1,1)
      A2= XNOEU(1,3)-XNOEU(1,1)
      A3= XNOEU(1,4)-XNOEU(1,1)
      A4= XNOEU(2,2)-XNOEU(2,1)
      A5= XNOEU(2,3)-XNOEU(2,1)
      A6= XNOEU(2,4)-XNOEU(2,1)
      A7= XNOEU(3,2)-XNOEU(3,1)
      A8= XNOEU(3,3)-XNOEU(3,1)
      A9= XNOEU(3,4)-XNOEU(3,1)
      B1= X(1)-XNOEU(1,1)
      B2= X(2)-XNOEU(2,1)
      B3= X(3)-XNOEU(3,1)
      DETA=A1*A5*A9+A2*A6*A7+A4*A8*A3-A7*A5*A3-A8*A6*A1-A9*A4*A2
      G(1)=B1*A5*A9+A2*A6*B3+B2*A8*A3-B3*A5*A3-A8*A6*B1-A9*B2*A2
      G(2)=A1*B2*A9+B1*A6*A7+A4*B3*A3-A7*B2*A3-B3*A6*A1-A9*A4*B1
      G(3)=A1*A5*B3+A2*B2*A7+A4*A8*B1-A7*A5*B1-A8*B2*A1-B3*A4*A2
      G(1)=G(1)/DETA
      G(2)=G(2)/DETA
      G(3)=G(3)/DETA
      RETURN
      END


