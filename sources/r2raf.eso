C R2RAF     SOURCE    CHAT      06/03/29    21:31:11     5360
      SUBROUTINE R2RAF(ITRNOE,NBNMAX,ITRTRI,NBCMAX,NOETRI,NOEMAX,
     >                   COORD,NBN,NBE,NBPMAX,NBEMAX,
     >                   ITVL,NITMAX,RTVL,NRTMAX,iarr)
C     **********************************************************************
C     OBJET : RAFFINE UN MAILLAGE TRIANGULAIRE 2D PAR DEFAUT
C
C     EN ENTREE   :
C       --------- LE MAILLAGE ---------------------
C       ITRNOE,NBNMAX,ITRTRI,NBCMAX,NOETRI,NOEMAX,NBN,NBE : LE MAILLAGE
C       COORD,IDIMC: LES COORDONNEES DES NOEUDS
C       NBPMAX     : NOMBRE MAXIMUM DE POINTS
C       NBEMAX     : NOMBRE MAXIMUM D'ELEMENTS
C
C       ---- TABLEAUX DE TRAVAIL --------------------
C       ITVL : SERT POUR TAJPOT
C       NITMAX  : TAILLE DE (6*NBADET+10) (CF. TAJPOT)
C       RTVL : TABLEAU DE REELS POUR LES CALCULS
C       NRTMAX  : TAILLE DE RTVL (8*NBNPMAX+244)
C
C     EN SORTIE     : LE MAILLAGE MODIFIE
C       NBE,NBN     : LE NOMBRE DE TRIANGLES ET DE NOEUDS APRES GENERATION
C       iarr        : CODE D'ERREUR 0 SI OK
C                    -1 SI DONNEES INCORRECTES
C                    -2 SI TABLEAUX INSUFFISANTS
C
C     REMARQUES IMPORTANTES :
C           - LES NOEUDS CALCULES SONT AJOUTES A LA TRIANGULATION
C             PAR LA METHODE DE DELAUNAY (APPEL TAJPOT)
C           - LA GENERATION DES NOEUDS REGULARISE LES ELEMENTS :
C             A LA FIN :  L/L -> SQRT(3)
C     **********************************************************************
      IMPLICIT INTEGER(I-N)
      INTEGER    NBE,NBEMAX,ITRNOE(*),NBNMAX,ITRTRI(*),NBCMAX
      INTEGER    NOETRI(*),NOEMAX,NBN,NBPMAX
      REAL*8       COORD(*)
      INTEGER    ITVL(*)
      REAL*8       RTVL(*)
      INTEGER    NITMAX,NRTMAX,iarr
C
      INTEGER  NBENEW,IDIMC
C   elimination external TC
C      INTEGER  D2IDEF
C      EXTERNAL D2IDEF
      REAL*8 ZERO
C
      ZERO = 0.0D0
      IDIMC = 2
C      CALL R2ITE(D2IDEF,0,ZERO,
      CALL R2ITE(0,ZERO,
     >          ITRNOE,NBNMAX,ITRTRI,NBCMAX,NOETRI,NOEMAX,
     >          COORD,IDIMC,NBN,NBE,NBPMAX,NBEMAX,
     >          ITVL,NITMAX,RTVL,NRTMAX,NBENEW,iarr)
C
  999 END



