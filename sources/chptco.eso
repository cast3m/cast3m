C CHPTCO    SOURCE    CB215821  17/10/19    21:15:01     9593
      SUBROUTINE CHPTCO(IVAL,IPOIN)
      IMPLICIT INTEGER(I-N)
      CHARACTER*12 CTEXT
-INC CCOPTIO
-INC SMCHPOI
-INC SMELEME
      logical ltelq

      MCHPOI=IPOIN
      SEGACT MCHPOI
      NSOUPO=IPCHP(/1)
C
C CAS DU CHPOINT VIDE
C
      IF(NSOUPO.EQ.0) THEN
        SEGDES,MCHPOI
        NAT=1
        SEGINI,MCHPO1
        MCHPO1.IFOPOI=IFOUR
        MCHPO1.JATTRI(1)=1
        SEGDES,MCHPO1
        CALL ECROBJ('CHPOINT',MCHPO1)

        IF (IVAL.EQ.0) THEN
          IF (IDIM.EQ.2) THEN
            SEGINI,MCHPO2=MCHPO1
            SEGDES,MCHPO2
            CALL ECROBJ('CHPOINT',MCHPO2)

          ELSEIF (IDIM.EQ.3) THEN
            SEGINI,MCHPO2=MCHPO1
            SEGDES,MCHPO2
            CALL ECROBJ('CHPOINT',MCHPO2)
            SEGINI,MCHPO3=MCHPO1
            SEGDES,MCHPO3
            CALL ECROBJ('CHPOINT',MCHPO3)

          ELSE
            CALL ERREUR(832)
            RETURN
          ENDIF
        ENDIF

        RETURN
      ENDIF
C
C CAS DU CHPOINT NON VIDE
C
      DO 1 I=1,NSOUPO
        MSOUPO=IPCHP(I)
        SEGACT MSOUPO
        IF(I.EQ.1) THEN
          IPGEO=IGEOC
        ELSE
          IPGE1=IPGEO
          IPGE2=IGEOC
          ltelq=.false.
          CALL FUSE(IPGE1,IPGE2,IPGEO,ltelq)
          MELEME=IPGE1
          IF (MELEME .NE. IPGEO) SEGDES,MELEME
          MELEME=IPGE2
          IF (MELEME .NE. IPGEO) SEGDES,MELEME
        ENDIF
        SEGDES,MSOUPO
   1  CONTINUE
      SEGDES,MCHPOI
      CALL CHPCOO(IVAL,IPGEO)
C
      RETURN
      END


