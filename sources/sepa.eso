C SEPA      SOURCE    CHAT      09/10/09    21:24:14     6519
      SUBROUTINE SEPA(MRIGID,IRET)
*
*  EXTRAI DE MRIGID LA PARTIE SANS MULTIPLICATEUR SI IRET=1
*  EXTRAI DE MRIGID LA PARTIE AVEC MULTIPLICATEUR SI IRET=2
*
      IMPLICIT INTEGER(I-N)
-INC SMRIGID
      SEGACT MRIGID
      NRIGEL=0
      NRIGE=IRIGEL(/1)
c
      IF(NRIGE.LE.5) THEN
        CALL ERREUR (5)
      ENDIF
c
      DO 1 I=1,IRIGEL(/2)
        DESCR=IRIGEL(3,I)
        SEGACT DESCR
        DO 6 K=1,LISINC(/2)
          IF(LISINC(K).EQ.'LX  ') GO TO 7
   6    CONTINUE
        GO TO 15
   7    CONTINUE
        NRIGEL=NRIGEL+1
  15    SEGDES DESCR
   1  CONTINUE
c
      IF(IRET.EQ.1) NRIGEL=IRIGEL(/2)-NRIGEL
c
      SEGINI RI1
      RI1.MTYMAT=MTYMAT
c
      IF(NRIGEL.EQ.0) THEN
         SEGDES RI1,MRIGID
         MRIGID=RI1
         RETURN
      ENDIF
c
      IEL=0
      DO 3 I=1,IRIGEL(/2)
        DESCR=IRIGEL(3,I)
        SEGACT DESCR
        IMUL=1
c
        DO 11 K=1,LISINC(/2)
          IF(LISINC(K).NE.'LX  ') GO TO 11
          IMUL=2
          GO TO 12
   11   CONTINUE
c
   12   CONTINUE
        IF(IMUL.NE.IRET) GO TO 4
        IEL=IEL+1
c
        DO 2 J=1,NRIGE
            RI1.IRIGEL(J,IEL)=IRIGEL(J,I)
   2    CONTINUE
c
        RI1.COERIG(IEL)=COERIG(I)
   4    CONTINUE
        SEGDES DESCR
   3  CONTINUE
c
      SEGDES MRIGID,RI1
      MRIGID=RI1
      RETURN
      END






