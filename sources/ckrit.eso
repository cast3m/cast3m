C CKRIT     SOURCE    CHAT      05/01/12    22:04:03     5004
      SUBROUTINE CKRIT(IMAPLA,STOT,ITYP,XMAT,ALFAH,COVNMS,XINV,Y)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION STOT(*),XMAT(*),COVNMS(*),XINV(*)
      IMP1=IMAPLA+1
      XINV(1)=0.D00
      GO TO(2001,2001,2000,2000,2001,2005,2000,2006),IMP1
2001  Y=VONMIS(STOT,ITYP,ALFAH,COVNMS)
      XINV(2)=Y
      RETURN
2005  XINV(1)=TRACE(STOT)
      XINV(2)=VONMIS(STOT,ITYP,ALFAH,COVNMS)
      Y=XMAT(1)*XINV(1)+XMAT(2)*XINV(2)
      RETURN
 2006 BETO=COVNMS(1)
      DBET=EXP(BETO)
      BBET=XMAT(1)*XMAT(2)*DBET/(1.-XMAT(2)+XMAT(2)*DBET)
      XINV(1)=TRACE(STOT)
      XINV(2)=VONMIS(STOT,ITYP,ALFAH,COVNMS)
      Y=XMAT(3)*BBET*EXP(XINV(1)/(XMAT(1)*3))+XINV(2)
 2000 CONTINUE
      RETURN
      END

