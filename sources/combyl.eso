C COMBYL    SOURCE    BP208322  15/06/26    21:15:07     8562
c       SUBROUTINE COMBYL(ITACH,ITAFL,IRETT)
      SUBROUTINE COMBYL(ITACH,ITAFL,N,IRETT)
*______________________________________________________________________
*
*    CE SUBROUTINE EFFECTUE LA COMBINAISON LINEAIRE DES CHAMELEM
*    CONTENUS DANS ITACH, AVEC LES FLOTTANTS CONTENUS DANS ITAFL
*    LE RESULTAT EST UN CHAMELEM,MIS DANS IRETT
*    ATTENTION : TAFL EN DOUBLE PRECISION
*
*    PASSAGE AUX NOUVEAU CHAMELEM PAR JM CAMPENON LE 01/91
*
*----------------------------------------------------------------------
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
*
      SEGMENT ITACH(0)
      SEGMENT/ITAFL/(TAFL(0)*D)
*
      IRETT=0
c       SEGACT ITACH,ITAFL
*
*   BOUCLE SUR LES CHAMELEMS
*
c       NCHAM=ITACH(/1)
      NCHAM=N
      DO 201 ICHAM=1,NCHAM
         IPCHAM=ITACH(ICHAM)
         VAL=TAFL(ICHAM)
*
         CALL MUCHEL(IPCHAM,VAL,IRET,1)
         IF(IRET.EQ.0) GO TO 298
         IF(ICHAM.EQ.1) THEN
            IRETT=IRET
         ELSE
            CALL ADCHEL(IRETT,IRET,IRETOU,1)
            CALL DTCHAM(IRET)
            IF(IRETOU.EQ.0) GO TO 298
            CALL DTCHAM(IRETT)
            IRETT=IRETOU
         ENDIF
201   CONTINUE
      GO TO 299
*
 298  IF(IRETT.NE.0) CALL DTCHAM(IRETT)
      IRETT=0
*
 299  CONTINUE
c       SEGDES ITAFL
c       SEGDES ITACH
      RETURN
      END


