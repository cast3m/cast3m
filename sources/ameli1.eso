C AMELI1    SOURCE    CHAT      05/01/12    21:21:11     5004
      SUBROUTINE AMELI1 (MELEME,SAUV,NGRAND,NDEB,NUMNP,NUMELG)
************************************************************************
*
*                             A M E L I 1
*                             -----------
*
* FONCTION:
* ---------
*
*     AMELIORATION DE LA QUALITE DES ELEMENTS DANS L'ESPACE GEOMETRIQUE.
*
* MODULES UTILISES:
* -----------------
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMCOORD
-INC SMELEME
*
* PARAMETRES:   (E)=ENTREE   (S)=SORTIE   (+ = CONTENU DANS UN COMMUN)
* -----------
*
*     MELEME  E/S  POINTEUR SUR LA SURFACE MAILLEE EN ELEMENTS
*                  LINEAIRES, DE FACON NON CONVENTIONNELLE:
*                  - MELANGE DES "QUA4" ET "TRI3" DANS LE MEME TABLEAU,
*                  - TABLEAU SURDIMENSIONNE,
*                  - NUMEROTATION DES NOEUDS LOCALE A L'OPERATEUR.
*     SAUV    (E)  SEGMENT CONTENANT LE TABLEAU "NSA" DE CORRESPONDANCE
*                  ENTRE NUMEROS LOCAUX ET GLOBAUX SUR LE CONTOUR.
*             (S)  TABLEAU "NSA" ETENDU AUX NOEUDS INTERIEURS CREES.
*     NGRAND  (E)  PLUS GRAND NUMERO DE NOEUD CREE.
*                  (NUMEROTATION GLOBALE)
*     NDEB    (E)  NUMERO LOCAL DU 1ER NOEUD INTERIEUR DE LA SURFACE.
*     NUMNP   (E)  NOMBRE DE NOEUDS DU MAILLAGE.
*     NUMELG  E/S  NOMBRE D'ELEMENTS DU MAILLAGE.
*    +IDIM    (E)  VOIR LE COMMUN "CCOPTIO".
*    +MCOORD  (E)
*
      SEGMENT/SAUV/(NSA(LSA))
*
* VARIABLES:
* ----------
*
      SEGMENT,MVOIS
         INTEGER NBVOIS(NUMNP),KON(MAXVOI,NUMNP)
      ENDSEGMENT
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     PASCAL MANIGOT     9 OCTOBRE 1990
*
* LANGAGE:
* --------
*
*     ESOPE + FORTRAN77
*
************************************************************************
*
      SEGACT,MCOORD
      SEGACT,MELEME
      NBNN = NUM(/1)
*
*     IL FAUT ENREGISTRER LES VERITABLES NUMEROS DES NOEUDS INTERIEURS,
*     PAR COMPLETION DU TABLEAU "NSA":
      SEGACT,SAUV
      LSA = NUMNP
      SEGADJ,SAUV
      IDEC = NGRAND - NDEB + 1
      DO 50 IANC=NDEB,NUMNP
         NSA(IANC) = IANC + IDEC
  50     CONTINUE
*     END DO
*
      MAXVOI = 12
*     (ON EST OBLIGE DE PRENDRE BEAUCOUP TOUT DE SUITE CAR ON N'EST PAS
*     A L'ABRI D'UNE AUGMENTATION DU NOMBRE DE VOISINS DANS L'OPERATION
*     D'AMELIORATION DE MAILLAGE)
      SEGINI,MVOIS
      CALL AMELI2 (NUM,NSA,NBNN,NUMELG,NUMNP,NBVOIS,MAXVOI,KON)
*
      SEGSUP,MVOIS
*     IL N'EST PROBABLEMENT PAS PRUDENT DE DESACTIVER "MELEME" ET "SAUV"
*
      END

