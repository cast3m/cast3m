C GRACO1    SOURCE    PV        16/11/17    21:59:33     9180
      SUBROUTINE GRACO1 ( KRIGI)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C
C  COPIE DE TRIANG POUR FAIRE UN CHOLEVSKI INCOMPLET
C
-INC SMRIGID
-INC CCOPTIO
-INC SMMATRI
      REAL*8 XKT
      IF(IIMPI.EQ.1)THEN
       CALL GIBTEM(XKT)
       INTERR(1)=XKT
       CALL ERREUR(-259)
      ENDIF
      IF(IIMPI.EQ.1)WRITE(IOIMP,10)
  10  FORMAT(' L''IMPRESSION PRECDENTE EST  AVANT ASSEM1 ')
      CALL ASSEM1(KRIGI,MMATRX,INUINX,ITOPOX,IMINIX,IPOX,INCTRX,IITOPX)
      IF(IERR.NE.0) RETURN
      IF(IIMPI.EQ.1)THEN
       CALL GIBTEM(XKT)
       INTERR(1)=XKT
       CALL ERREUR(-259)
      ENDIF
      IF(IIMPI.EQ.1)WRITE(IOIMP,11)
   11  FORMAT(' L''IMPRESSION PRECEDENTE EST  AVANT ASSEM2')
      CALL ASSEM2(KRIGI,ITOPOX,INUINX,IMINIX,MMATRX,IPOX,INCTRX,IITOPX)
      IF(IERR.NE.0) RETURN
      IF(IIMPI.EQ.1)THEN
       CALL GIBTEM(XKT)
       INTERR(1)=XKT
       CALL ERREUR(-259)
      ENDIF
      CALL GRACO2(MMATRX)
      IF(IERR.NE.0) RETURN
      IF(IIMPI.EQ.1)THEN
       CALL GIBTEM(XKT)
       INTERR(1)=XKT
       CALL ERREUR(-259)
      ENDIF
      IF(IERR.NE.0) GO TO 5000
      IF(IIMPI.EQ.1) WRITE(IOIMP,13)
   13 FORMAT(' L''IMPRESSION PRECEDENTE EST APRES GRACO2')
      MRIGID=KRIGI
      SEGACT MRIGID*MOD
      ICHOLE=MMATRX
      SEGDES MRIGID
 5000 CONTINUE
      RETURN
      END













