C POLA      SOURCE    CB215821  16/12/05    21:40:20     9237
      SUBROUTINE POLA
*---------------------------------------------------------------------
*
*            DECOMPOSITION POLAIRE D'UN CHAMP DE GRADIENT
*                          F = R U
*
*     CHR CHU  = POLA  MOD CHEL (CAR) ( MOT );
*
*           MOD   MODELE DE CALCUL, TYPE MMODEL
*           CHEL  OBJET DE TYPE MCHAML DE SOUS TYPE GRADIENT
*           CHR   OBJET DE TYPE MCHAML DE SOUS TYPE
*           CHU   OBJET DE TYPE MCHAML DE SOUS TYPE
*
*--------------------------------------------------------------------
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
      CHARACTER*4 MOCLE(2)
      DATA MOCLE/'GEOM','DEPL'/
*
      CALL LIROBJ('MMODEL',IPMODL,1,IRTM)
      IF(IERR.NE.0) RETURN
*
      CALL LIROBJ('MCHAML',IPIN,1,IRT1)
      IF(IERR.NE.0) RETURN
      CALL REDUAF(IPIN,IPMODL,IPCHE1,0,IR,KER)
      IF(IR   .NE. 1) CALL ERREUR(KER)
      IF(IERR .NE. 0) RETURN
*
*     LECTURE D'UN MOT SI NECESSAIRE
*
      IMIL=0
      CALL LIRMOT(MOCLE,2,IMOT,0)
      IF(IMOT.EQ.2) IMIL=1
*
      CALL POLA1(IPMODL,IPCHE1,IPCHE2,IPCHE3,IMIL)
      IF(IERR.NE.0) RETURN
*
      CALL ECROBJ('MCHAML',IPCHE3)
      CALL ECROBJ('MCHAML',IPCHE2)
      RETURN
      END


