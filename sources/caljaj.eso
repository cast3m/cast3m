C CALJAJ    SOURCE    CHAT      05/01/12    21:46:37     5004
      SUBROUTINE CALJAJ(GR,XYZ,ND,IES,NP,NPG,AJ)
C************************************************************************
C
C     CALJAJ  APPELLE CALJ00
C
C
C     CALCUL DU JACOBIEN  AJ=1/J
C     CALCUL DE L'ELEMENT D'AIRE       SQ=DET(J)
C     DANS LES CAS 1D 2D ET 3D
C
C     ND   DIMENSION ESPACE
C     NP   NOMBRE DE NOEUDS DE L'ELEMENT
C     NPG  NOMBRE DE POINTS D'INTEGRATION
C
C     XYZ  COORDONNEES
C     GR   GRADIENT
C************************************************************************
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 GR(ND,NP,1),XYZ(IES,NP),XY(20),AJ(3,3,9)
C
C     WRITE(6,*)'SUB CALJAJ ND,IES',ND,IES
      IF(ND.EQ.IES)GOTO 20
      CALL CALJQ(XYZ,XY,IES,ND,NP)
C     WRITE(6,*)'SUB CALJAJ XYZ',XYZ
C     WRITE(6,*)'SUB CALJAJ XY',XY
      CALL CALJ00(GR,XY,ND,NP,NPG,AJ)
C
      RETURN
 20   CONTINUE
      CALL CALJ00(GR,XYZ,ND,NP,NPG,AJ)
      RETURN
 1002 FORMAT(10(1X,1PE11.4))
 1001 FORMAT(20(1X,I5))
      END




