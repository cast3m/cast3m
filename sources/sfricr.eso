C SFRICR    SOURCE    CHAT      06/03/29    21:33:23     5360
      SUBROUTINE SFRICR(IFR,NBIFR,IDE,ITRNOE,NBNMAX,ITRTRI,NBCMAX,
     >                   NOETRI,NBE,iarr)
C     ****************************************************************
C     OBJET : FRONTIERE (INTER MATERIAUX) CREEE DANS UN MAILLAGE
C        AJOUT D'UN SOMMET, D'UNE ARETE OU D'UNE FACETTE A LA FRONTIERE
C        INTER-MATERIAUX.
C     EN ENTREE:
C      IFR    :  TABLEAU DES NOEUDS DE L'ELEMENT FRONTIERE
C      NBIFR  :  NOMBRE DE NOEUDS DE L'ELEMENT FRONTIERE
C      IDE    :  (1..3) DIMENSION DES ELEMENTS
C      ITRNOE:  LES NOEUDS DES ELEMENTS
C      NBNMAX :  (2..8) NOMBRE DE NOEUDS MAXIMUM DES ELEMENTS
C      ITRTRI:  LES VOISINS DES ELEMENTS
C      NBCMAX :  (2..6) NOMBRE DE COTES MAXIMUM DES ELEMENTS
C      NOETRI :  TABLEAU DES ELEMENTS INCIDENT AUX NOEUDS
C      NBE    :  NOMBRE D'ELEMENTS DU MAILLAGE
C     EN SORTIE:
C      ITRTRI:  MIS A JOUR
C      iarr   :  CODE D'ERREUR 0 => OK, -1 => L'ELEMENT FRONTIERE
C                N'EXISTE PAS DANS LE MAILLAGE
C     CONDITION D'APPLICATION :
C     ****************************************************************
      IMPLICIT INTEGER(I-N)
      INTEGER   IFR(*),NBIFR,iarr
      INTEGER   IDE,ITRNOE(*),NBNMAX,ITRTRI(*),NBCMAX,NOETRI(*),NBE
C
      INTEGER   IT1, IT2, I1, I2
C
      iarr = 0
      CALL SFRIDE(IFR,NBIFR,IDE,ITRNOE,NBNMAX,ITRTRI,NBCMAX,
     >             NOETRI,NBE,IT1,IT2,I1,I2 )
      IF(( IT1 .EQ. 0 ) .AND. ( IT2 .EQ. 0 ))THEN
C       L'ARETE N'EXISTE PAS
        iarr = -1
        GOTO 999
      ENDIF
      IF(( IT1 .GT. 0 ) .AND. ( IT2 .GT. 0 ))THEN
        IF(ITRTRI((IT1-1)*NBCMAX+I1).GT.0)
     >  ITRTRI((IT1-1)*NBCMAX+I1) = -ITRTRI((IT1-1)*NBCMAX+I1)
        IF(ITRTRI((IT2-1)*NBCMAX+I2).GT.0)
     >  ITRTRI((IT2-1)*NBCMAX+I2) = -ITRTRI((IT2-1)*NBCMAX+I2)
      ENDIF
  999 END



