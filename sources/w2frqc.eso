C W2FRQC    SOURCE    CB215821  16/04/21    21:18:41     8920
      SUBROUTINE W2FRQC (XRVP, XIVP, W2SHIF, XRW2,XIW2, XRFREQ, XIFREQ)
************************************************************************
*
*                             W 2 F R Q C
*                             -----------
*                       (PRONONCER "OMEGA2 FREQ C")
*
* FONCTION:
* ---------
*
*     FOURNIR LA FREQUENCE PROPRE COMPEXEET LA PULSATION AU CARRE, CONNAISSANT
*     LA PULSATION DE DECALAGE (AU CARRE ET REELLE) ET LA PULSATION PROPRE (AU
*     CARRE COMPLEXE) DECALEE. ON PASSE PAR LE CALCUL DU MODULE ET DE L'ARGUMENT
*     (CONTEXTE: CALCUL DE MODES PROPRES COMPLEXES)
*
* MODE D'APPEL:
* -------------
*
*     CALL W2FRQC (RXVP, IXVP, W2SHIF, XRW2,  XIW2, XRFREQ, XIFREQ)
*
* PARAMETRES:   (E)=ENTREE   (S)=SORTIE
* -----------
*
*     XRVP    REEL DP   (E)  PARTIE REELLE DE PULSATION CALCULEE AU CARRE (DECALEE).
*     XIVP    REEL DP   (E)  PARTIE IMGINAIRE DE PULSATION CALCULEE
*     W2SHIF  REEL DP   (E)  PULSATION REELLE DE DECALAGE AU CARRE.
*     XRW2    REEL DP   (S)  = XRVP + W2SHIF.
*     XIW2    REEL DP   (S)  = XIVP
*     XRFREQ  REEL DP   (S)  FREQUENCE REELLE ASSOCIEE A LA PULSATION PROPRE
*     XIFREQ  REEL DP   (S)  FREQUANCE IMAGINAIRE ASSOCIEE A LA PULSATION PROPRE
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     C. LE BIDEAU     JUILLET 2001
*
* LANGAGE:
* --------
*
*     FORTRAN77 + ESOPE
*
************************************************************************
*
      IMPLICIT INTEGER(I-N)
      IMPLICIT real*8 (a-h,o-z)
-INC CCREEL
-INC CCOPTIO
*
      REAL*8 XRVP, XIVP, W2SHIF, XRW2, XIW2 ,XRFREQ, XIFREQ, DEUXPI, TETA,
     &  XNW2, XRW, XIW, ALPHA
*
      PARAMETER (DEUXPI = 2.D0*XPI)
*
*     PULSATION AU CARRE
*
      XRW2 = XRVP + W2SHIF
      XIW2 = XIVP
*
*     CALCUL DE LA FREQUENCE
*
*     ARGUMENT DE W2
*
      TETA = ATAN2(XIW2,XRW2)
*
*     MODULE DE W2
*
      XNW2 = SQRT( XRW2**2 + XIW2**2)
*     RACINE DE W2 (W2=XRVP + i*XIVP)
*
      XNW = SQRT (XNW2)
      XRW = XNW * COS(TETA/2)
      XIW = XNW * SIN(TETA/2)
*     FREQUENCE
*
*     LA FREQUENCE CORRESPODANTE EST A
*     PARTIE IMAGINAIRE NEGATIVE
*     BP208322 (mars 2009) : ne semble pas justifié....
      XRFREQ = XRW/DEUXPI
*      XIFREQ = -1.D0*XIW/DEUXPI
      XIFREQ = XIW/DEUXPI
*
      END





