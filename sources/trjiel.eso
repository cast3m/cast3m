C TRJIEL    SOURCE    CHAT      05/01/13    03:49:52     5004
      SUBROUTINE TRJIEL(IEL1,IEL2,ICONT,NF,IFACEL,IZCENT,IELTFA)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C CHERCHE LE NUMERO DE L ELEMENT IEL2 AYANT LA FACE NF COMMUNE AVEC IEL1
C         A PARTIR DES ELEMENTS DE LA TABLE GENEREE PAR KDOM
C
C ENTRES
C  IEL1   : NUMERO DE L ELEMENT
C  ICONT  : NUMERO LOCAL DE LA FACE DANS L ELEMENT IEL1
C  IFACEL : POINTEUR DU MAILLAGE "FACEL" (KDOM)
C  IZCENT : POINTEUR DU MAILLAGE "CENTRE" (KDOM)
C  IELTFA : POINTEUR DU MAILLAGE "ELTFA" (KDOM)
C          ON SUPPOSE CES SEGMENTS ACTIFS
C SORTIES
C  IEL2   : NUMERO DE L ELEMENT AYANT LA FACE NF COMMUNE AVEC IEL1
C  NF     : SERA LE NUMERO DE LA FACE ICONT DANS LE MAILLAGE GENERAL
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
-INC SMELEME
      POINTEUR IELTFA.MELEME ,IFACEL.MELEME,IZCENT.MELEME
C
      NEL0=0
      IEL2=0
      CALL MELNEL(IEL1,IELTFA,IPT1,NEL0,1)
      NF=IPT1.NUM(ICONT,IEL1-NEL0)
C     write(6,*)' ieltrj ', nf,iel1,icont,nel0
      NFC=IFACEL.NUM(/2)
      NEL=IZCENT.NUM(/2)
      DO 50 K=1,NFC
       IF(IFACEL.NUM(2,K).EQ.NF)THEN
            IF(IFACEL.NUM(1,K).EQ.IZCENT.NUM(1,IEL1))THEN
                J2=3
            ELSEIF(IFACEL.NUM(3,K).EQ.IZCENT.NUM(1,IEL1))THEN
                J2=1
            ELSE
                GO TO 35
            ENDIF
            DO 30 L=1,NEL
               IF(IFACEL.NUM(J2,K).EQ.IZCENT.NUM(1,L))THEN
                   IF(L.EQ.IEL1)GO TO 25
                   IEL2=L
               ENDIF
   25          CONTINUE
   30       CONTINUE
   35       CONTINUE
       ENDIF
C
   50 CONTINUE
      RETURN
      END

