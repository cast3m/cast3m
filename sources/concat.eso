C CONCAT    SOURCE    BP208322  15/05/11    21:15:04     8528
      SUBROUTINE CONCAT
C
C   ==================================================================
C   = CONCATENATION DE 2 OBJETS EVOLUTION MEVOL1 ET MEVOL2           =
C   = LE RESULTAT EST RANGE DANS MEVOLL                              =
C   =                                                                =
C   = APPEL DU SOUS-PROGRAMME FUSPRO                                 =
C   ==================================================================
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT real*8 (a-h,o-z)
-INC CCOPTIO
-INC SMEVOLL
-INC SMLREEL
C
      CHARACTER*8 ITEVOL,ITCOUR
      DATA ITEVOL,ITCOUR/'EVOLUTIO','COURBES '/
C
      CALL LIROBJ('EVOLUTIO',IR1,1,IRETOU)
      IF(IERR.NE.0)RETURN
      CALL LIROBJ('EVOLUTIO',IR2,1,IRETOU)
      IF(IERR.NE.0)RETURN
C
      MEVOL1=IR1
      MEVOL2=IR2
      SEGACT MEVOL1,MEVOL2
      N1=MEVOL1.IEVOLL(/1)
      N2=MEVOL2.IEVOLL(/1)
C  LES MEVOL DOIVENT AVOIR LE MEME NOMBRE DE COURBES
      IF(N1.NE.N2) THEN
          MOTERR(1:8)=ITEVOL(1:8)
          MOTERR(9:16)=ITCOUR(1:8)
          CALL ERREUR(403)
          RETURN
      ENDIF
C
      N=N1
      SEGINI MEVOLL
      IRET=MEVOLL
      ITYEVO=MEVOL1.ITYEVO
      IEVTEX=TITREE
C
C
        DO 1 IC=1,N1
C  INITIALISATION DU MEVOL RESULTAT
        SEGINI KEVOLL
        IEVOLL(IC)=KEVOLL
        TYPX='LISTREEL'
        TYPY='LISTREEL'
c         KEVTEX=TITREE(1:72)
C
        KEVOL1=MEVOL1.IEVOLL(IC)
        KEVOL2=MEVOL2.IEVOLL(IC)
        SEGACT KEVOL1,KEVOL2
        KEVTEX=KEVOL1.KEVTEX
        NOMEVX=KEVOL1.NOMEVX
        NOMEVY=KEVOL1.NOMEVY
        NUMEVX=KEVOL1.NUMEVX
        NUMEVY=KEVOL1.NUMEVY
        MLREE1=KEVOL1.IPROGX
        MLREE2=KEVOL2.IPROGX
        SEGACT MLREE1,MLREE2
C
        IL1=MLREE1
        IL2=MLREE2
        V1=MLREE1.PROG(1)
        V2=MLREE2.PROG(1)
C  ACTIVATION DE MLREE1 ET MLREE2 DANS FUSPRO
        SEGDES MLREE1,MLREE2
        IF(V2.GE.V1) THEN
            CALL FUSPRO(IL1,IL2,IRETOU)
        ELSE
            CALL FUSPRO(IL2,IL1,IRETOU)
        ENDIF
        IPROGX=IRETOU
C
C
        MLREE1=KEVOL1.IPROGY
        MLREE2=KEVOL2.IPROGY
        IL1=MLREE1
        IL2=MLREE2
        IF(V2.GE.V1) THEN
            CALL FUSPRO(IL1,IL2,IRETOU)
        ELSE
            CALL FUSPRO(IL2,IL1,IRETOU)
        ENDIF
        IPROGY=IRETOU
        SEGDES KEVOL1,KEVOL2
C
C
        SEGDES KEVOLL
   1    CONTINUE
C
C
      SEGDES MEVOLL
      SEGDES MEVOL1,MEVOL2
      CALL ECROBJ('EVOLUTIO',IRET)
      RETURN
      END



