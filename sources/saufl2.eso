C SAUFL2    SOURCE    AM        09/12/08    21:15:25     6582
      SUBROUTINE SAUFL2(VARF,NVARI,CMAT,NMAT,SIGF,
     $           SIGEF,NSTRS,IFOUR,EPSFLU,AN,BN,CN,SIGFI)
C
C_______________________________________________________________________
C
C SOUS PROGRAMME QUI CALCUL LA DEFORMATION
C DE FLUAGE PROPRE A LA FIN DU PAS DE TEMPS
C_______________________________________________________________________
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION VARF(NVARI),CMAT(NMAT),SIGF(NSTRS),SIGEF(NSTRS)
      DIMENSION EPSFLU(6),SIGFI(NSTRS)
      DIMENSION AN(NSTRS),BN(NSTRS,NSTRS),CN(NSTRS,NSTRS)
C
C RECUPERATION DES VARIABLES INTERNES INITIALES
C
C   FLUAGE PROPRE
C
      EPSFLU(1) = VARF(51)
      EPSFLU(2) = VARF(52)
      EPSFLU(3) = VARF(53)
      EPSFLU(4) = VARF(54)
      EPSFLU(5) = VARF(55)
      EPSFLU(6) = VARF(56)
C
C  TEST SI LE TEMPS EST NUL
C
      TDT = CMAT(NMAT)
      IF (TDT.EQ.0.D0) THEN
        GOTO 30
      ENDIF
C
C INITIALISATION DES MATRICES
C
      CALL ZERO(AN,NSTRS,1)
      CALL ZERO(BN,NSTRS,NSTRS)
      CALL ZERO(CN,NSTRS,NSTRS)
      CALL ZERO(SIGFI,NSTRS,1)
C
      DO 10 I=1,NSTRS
          SIGFI(I) = SIGF(I)
  10  CONTINUE
C
C_______________________________________________________________________
C
C  FLUAGE PROPRE AMORTISSEUR
C
      NDI=NSTRS
      CALL FLUDE1(VARF,NVARI,CMAT,NMAT,IFOUR,NSTRS,
     $                 AN,BN,CN,NDI)
C
      DO 20 I=1,NSTRS
        EPSFLU(I) = EPSFLU(I) + AN(I)
        DO 20 J=1,NSTRS
          EPSFLU(I) = EPSFLU(I) + BN(I,J)*SIGEF(J) + CN(I,J)*SIGFI(J)
  20  CONTINUE
C
  30  CONTINUE
C
C  SAUVEGARDE DES DEFORMATIONS
C
C    FLUAGE DESSICCATION
C
      VARF(45) = EPSFLU(1)
      VARF(46) = EPSFLU(2)
      VARF(47) = EPSFLU(3)
      VARF(48) = EPSFLU(4)
      VARF(49) = EPSFLU(5)
      VARF(50) = EPSFLU(6)
C
      RETURN
      END

