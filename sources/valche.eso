C VALCHE    SOURCE    AM        16/04/18    21:15:14     8911

      SUBROUTINE VALCHE (IPTVAL,NCOMP,IPMINT,IPPORE,IPNOMI,MELE)

*_______________________________________________________________________
*
*   PASSAGE DES VALEURS D'UN MCHAML AUX NOEUDS SUR UN AUTRE SUPPORT
*
*   IPTVAL   POINTEUR SUR UN SEGMENT MPTVAL CONTENANT LES MELVALS A
*            RECALCULER
*
*   NCOMP    NOMBRE DE COMPOSANTES QUE L'ON SOUHAITE RECALCULER
*
*   IPMINT  POINTEUR SUR LE SEGMENT D'INTEGRATION DU SUPPORT OU L'ON
*           SOUHAITE PROJETER LES MELVAL
*
* IPPORE est =0 s'il faut prendre toutes les fonctions de formes
*         sinon précise lesquelles premieres il faut prendre
*
*   REMARQUE 1 :  LES MELVAL RECALCULES SONT REMIS DANS LE SEGMENT
*                 MPTVAL (ON DESACTIVE ICI LES MELVALS ORIGINELS).
*                 IL NE FAUT PAS OUBLIER DE SUPRIMER LES MELVALS
*                 RECALCULES APRES UTILISATION.
*
*   REMARQUE 2 :  LE POINTEUR IPMINT DOIT ETRE ACTIF EN ENTREE DE
*                 VALCHE ET SON ETAT N'EST PAS MODIFIE EN SORTIE.
*
*   CAMPENON JM LE 02/91
*
*_______________________________________________________________________

      IMPLICIT INTEGER(I-N)

-INC CCOPTIO

      SEGMENT MPTVAL
        INTEGER IPOS(NS)    ,NSOF(NS)
        INTEGER      IVAL(NCOSOU)
        CHARACTER*16 TYVAL(NCOSOU)
      ENDSEGMENT
*
      SEGMENT NOMID
        CHARACTER*8 LESOBL(NBROBL),LESFAC(NBRFAC)
      ENDSEGMENT
*
      CHARACTER*8 LENAME
*
      NOMID=IPNOMI
      SEGACT NOMID
      NBROBL=LESOBL(/2)
*
      ICO=0
      MPTVAL=IPTVAL
      DO 1 ICOMP=1,NCOMP
         ICO=ICO+1
         IPMELV=IVAL(ICOMP)
         IF (IPMELV.NE.0) THEN
            IF(ICO.LE.NBROBL) THEN
                  LENAME=LESOBL(ICO)
            ELSE
                  LENAME=LESFAC(ICO-NBROBL)
            ENDIF
            CALL CHAME3(IPMELV,IPMINT,IPRES,IPPORE,LENAME,MELE)
            IF(IERR.NE.0)RETURN
            IVAL(ICOMP)=IPRES
         ENDIF
 1    CONTINUE

      RETURN
      END




