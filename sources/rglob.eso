C RGLOB     SOURCE    BP208322  17/03/01    21:18:03     9325
      SUBROUTINE RGLOB(VALVEC,IDIM,TXR,XLOC,XGLOB,IFOUR)
C
C    CALCUL DES COS.DIR. DES AXES D'ORTHO./AXES GLOBAUXC  ENTREES
C
C  ENTREES  :
C
C    VALCEC = TABLEAU CONTENANT LES COS.DIR. DES AXES D'ORTHO./AXES LOCA
C     IDIM   = DEFINIT SI ON EST EN 2D OU 3D
C     TXR  = COS-DIRECTEURS DES AXES LOCAUX /REPERE GLOBAL
C    XLOC  = TABLEAU DE TRAVAIL
C
C  SORITES
C
C   XGLOB = TEBLEAU CONTENANT DES COS.DIR. DES AXES D'ORTHO./AXES GLOBAU
C
C=======================================================================
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C
      DIMENSION  XLOC(3,3),XGLOB(3,3)
      DIMENSION TXR(IDIM,*),VALVEC(*)
C
      CALL ZERO(XGLOB,3,3)
C
cbp      IF(IDIM.EQ.2) THEN
      IF(IDIM.EQ.2.AND.IFOUR.NE.1) THEN
         write(*,*) 'RGLOB: cas 2D Fourier'
         IDIM2=2
         XLOC(1,1)=VALVEC(1)
         XLOC(2,1)=VALVEC(2)
         XLOC(1,2)=-XLOC(2,1)
         XLOC(2,2)=XLOC(1,1)
         XN=XLOC(1,1)*XLOC(1,1)+XLOC(2,1)*XLOC(2,1)
         IF(XN.EQ.0.D0)THEN
           CALL ERREUR(277)
           RETURN
         ENDIF
cbp       ELSEIF(IDIM.EQ.3)THEN
       ELSE
         IDIM2=3
         XLOC(1,1)=VALVEC(1)
         XLOC(2,1)=VALVEC(2)
         XLOC(3,1)=VALVEC(3)
         XLOC(1,2)=VALVEC(4)
         XLOC(2,2)=VALVEC(5)
         XLOC(3,2)=VALVEC(6)
         CALL CROSS2(XLOC(1,1),XLOC(1,2),XLOC(1,3),IRR)
         IF(IRR.EQ.0)THEN
           CALL ERREUR(277)
           RETURN
         ENDIF
       ENDIF
C
C  DEFINITION DES AXES ORTHO./AXES GLOBAUX
C
       DO 10 K=1,IDIM2
         DO 10 J=1,IDIM
           DO 10 I=1,IDIM
          XGLOB(J,K)=TXR(J,I)*XLOC(I,K)+XGLOB(J,K)
 10    CONTINUE
       IF (IFOUR.EQ.1) THEN
          XGLOB(3,1)=XLOC(3,1)
          XGLOB(3,2)=XLOC(3,2)
          XGLOB(3,3)=XLOC(3,3)
       ENDIF

       RETURN
       END


