C LIATTA    SOURCE    CHAT      05/01/13    01:16:50     5004
      SUBROUTINE LIATTA (IORES,ITLACC,IMAX1,IRET,IFORM)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C=======================================================================
C   BUT        : LECTURE DES MATTAC
C   APPELE PAR : LIPIL
C   APPELLE    : LFCDIM LFCDIE LFCDI2
C   ECRIT PAR FARVACQUE    -REPRIS PAR LENA
C
      DIMENSION ILECBI(1)
-INC SMATTAC
C
      SEGMENT/ ITLACC/(ITLAC(0))
      SEGMENT /ILECB1/(ILECB2(NP))
C
C=======================================================================
C
      DIMENSION ILENA(10),IAUX(1)
C--------------------------------------------------------------------
C     ***************************** MATTAC *****************************
      IRET=0
      IRETOU=0
      DO 150 IEL=1,IMAX1
      CALL LFCDIE (IORES,1    ,ILENA,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      N=ILENA(1)
      NN=N
      SEGINI MATTAC
      ITLAC(**)=MATTAC
      DO 151 I=1,NN
      CALL LFCDIE (IORES,2    ,ILENA,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      M=ILENA(1)
      N=ILENA(2)
      SEGINI MSOUMA
      LISATT(I)=MSOUMA
      CALL LFCDIM (IORES,1    ,ILECBI,IRETOU,IFORM)
      WRITE(ITYATT,FMT='(A4)')ILECBI(1)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDIE (IORES,M    ,IPMATK,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDIE (IORES,N    ,IATREL,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDIE (IORES,1    ,IGEOCH,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDIE (IORES,1    ,IAUX,IRETOU,IFORM)
      MPHYCH=IAUX(1)
      IF (IRETOU.NE.0) GO TO 1000
C
      IF (IGEOCH.EQ.0) GO TO 152
      CALL LFCDIE (IORES,5    ,ILENA,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      NI=ILENA(1)
      NJ=ILENA(2)
      N1=ILENA(3)
      NP=ILENA(4)
      NT=ILENA(5)
      SEGINI MGEOCH
      IGEOCH=MGEOCH
      CALL LFCDIE (IORES,NI   ,INORCH,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDI2  (IORES,NJ   ,RJEUCH,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDIE (IORES,N1   ,IMAPRO,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      SEGINI ILECB1
      CALL LFCDIM (IORES,NP   ,ILECB2,IRETOU,IFORM)
      WRITE(MPOPRO,FMT='(18A4)')(ILECB2(IY),IY=1,NP)
      SEGDES ILECB1
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDI2  (IORES,NT   ,TAIPRO,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      SEGDES MGEOCH
  152 CONTINUE
C
      IF (MPHYCH.EQ.0) GO TO 153
      CALL LFCDIE (IORES,3    ,ILENA,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      NRAI=ILENA(1)
      NA=ILENA(2)
      NF=ILENA(3)
      SEGINI MPHYCH
      IPHYCH=MPHYCH
      CALL LFCDI2  (IORES,NRAI ,RAIPRO,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDI2  (IORES,NA   ,AMOPRO,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      CALL LFCDI2  (IORES,NF   ,FROPRO,IRETOU,IFORM)
      IF (IRETOU.NE.0) GO TO 1000
      SEGDES MPHYCH
  153 CONTINUE
C
      SEGDES MSOUMA
  151 CONTINUE
      SEGDES MATTAC
  150 CONTINUE
 1000 CONTINUE
      IRET=IRETOU
      RETURN
C -------------------------------------------------------
      END

