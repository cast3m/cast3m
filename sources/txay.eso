C TXAY      SOURCE    CHAT      05/01/13    03:57:30     5004
      SUBROUTINE TXAY (MLREE1,MXMAT,MLREE2,MP,MQ,XX)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC SMLREEL
-INC TMXMAT
      SEGACT MLREE2
      JG=MLREE2.PROG(/1)
      SEGINI MLREEL
      CALL MATVE1(MXMAT.XMAT,MLREE2.PROG,MP,MQ,PROG,2)
      XX=0.D0
      DO 1 I =1,JG
      XX= MLREE1.PROG(I)*PROG(I) + XX
   1  CONTINUE
      SEGSUP MLREEL
      RETURN
      END

