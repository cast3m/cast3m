C DEMCH1    SOURCE    GOUNAND   16/08/01    21:15:12     9043
C   UTILITAIRE DE DEMCHA (GESTION NOEUD MILIEU)
C
      SUBROUTINE DEMCH1(I1,I3,I2,KONCOU,KONFIN,KONMIL,KONSUI,KONPOS)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC CCOPTIO
-INC SMCOORD
      SEGMENT KONPOS(NBPTS)
      SEGMENT KONFIN(IKOUR)
      SEGMENT KONMIL(IKOUR)
      SEGMENT KONSUI(IKOUR)
      J1=MIN(I1,I3)
      J3=MAX(I1,I3)
      ITFA=KONPOS(J1)
      IF (ITFA.EQ.0) GOTO 90
 85   CONTINUE
      ITF=KONSUI(ITFA)
      IF (KONFIN(ITFA).EQ.J3) GOTO 80
      IF (ITF.EQ.0) GOTO 90
      ITFA=ITF
      GOTO 85
 90   KONCOU=KONCOU+1
      IF (KONCOU.GE.KONFIN(/1)) THEN
         IKOUR=KONCOU+500
         SEGADJ KONFIN,KONMIL,KONSUI
      ENDIF
      IF (ITFA.EQ.0) THEN
         KONPOS(J1)=KONCOU
      ELSE
         KONSUI(ITFA)=KONCOU
      ENDIF
      KONFIN(KONCOU)=J3
*     CREATION DE NOEUD
      NBPTS=XCOOR(/1)/(IDIM+1)+1
      SEGADJ MCOORD
      DO 100 ICOOR=1,IDIM+1
         XCOOR((NBPTS-1)*(IDIM+1)+ICOOR)=
     $        (XCOOR((J1-1)*(IDIM+1)+ICOOR)
     $        +XCOOR((J3-1)*(IDIM+1)+ICOOR))/2.D0
 100  CONTINUE
      KONMIL(KONCOU)=NBPTS
      ITFA=KONCOU
 80   CONTINUE
      I2=KONMIL(ITFA)
      END


