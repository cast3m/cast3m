C TRJSTO    SOURCE    CHAT      05/01/13    03:51:14     5004
      SUBROUTINE TRJSTO(NDIM,IEL1,NPOS,ITER,IPARPO,TDEP,XDEP2)
****************************************************************************
***  Permet de sauvegarder pdt l'avancee de la particule les
*** coord reelles de la particule ainsi que le tps ecoule associé.
***
*** APPELES 1 = aucun
*** APPELES 2 = aucun
***
*** E = 'NDIM' dimension de l'espace
***     'IEL1' n° global element contenant particule
***
*** E/S = 'NPOS' taille maximale des tableaux du segment 'IPARPO'
***       'ITER' indice des tableaux de 'IPARPO' pour la sauvegarde
***       'IPARPO' segment ou sont sauvegardés pts trajectoire particule
***       'TDEP' tps reel départ particule sauvegardé
***       'XDEP2' position réelle de départ particule sauvegardé
***
***************************************************************************

      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      SEGMENT  IPARPO
         INTEGER NAPAR(NPOS),NUMP(NPOS)
         REAL*8 CREF(NDIM,NPOS),TPAR(NPOS)
      ENDSEGMENT
      DIMENSION XDEP2(3)
***   allongement du segment 'IPARPO' si nécessaire
      IF ((NPOS-ITER).LE.1) THEN
         NPOS=NPOS+50
         SEGADJ IPARPO
      ENDIF
***   on passe à l'iteration suivante
      ITER=ITER+1
***   affectation du n° element et coords réelles depart
      NAPAR(ITER)=IEL1
      DO 10 I=1,NDIM
         CREF(I,ITER)=XDEP2(I)
 10   CONTINUE
***   affectation du tps réel depart
      TPAR(ITER)=TDEP

      RETURN
      END





