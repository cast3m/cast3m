C NOMMEF    SOURCE    JC220346  18/12/04    21:15:49     9991
      SUBROUTINE NOMMEF(ISGTR,IMAX,IPIL,IFORM,IDEB,isilen)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C------------------------------------------------------------------
C
C  BUT : ECRIRE SUR IOSAUV DESC ENREGS CARACTERISTIQUES DE LA PILE
C
C  ENTREE : ISGTR   TABLE ASSOCIEE A LA PILE EXAMINEE
C           IMAX    VALEUR MAX  DE LA PILE
C           IPIL    NUMERO DE LA PILE EXAMINEE
C           IFORM   INDICE 0 OU 1 POUR SORTIE AVEC OU SANS FORMAT
C
C   CHERCHE DANS LA LISTE ISGTR (NOM-NOM-IVAL=RANG DANS LA PILE) LES
C   OBJETS TELS QUE IVAL.LE.IMAX
C   ECRIT CES OBJETS SUR IOSAU AVEC OU SANS FORMAT :
C  1- NUMERO DE LA PILE,NBRE OBJETS NOMMES, NBRE OBJETS DANS LA PILE
C  2- LISTE DES NOMS DES OBJETS NOMMES S IL Y EN A
C  3- LISTE DES POINTEURS DES OBJETS NOMMES  S IL Y EN A
C------------------------------------------------------------------
C
-INC CCOPTIO
-INC CCNOYAU
      SEGMENT ISGTR
         CHARACTER*(LONOM) ISGTRC(KS)
         INTEGER ISGTRI(KS)
      ENDSEGMENT
      SEGMENT ISTMP
         CHARACTER*(LONOM) ISTMPC(NTMP)
      ENDSEGMENT
      DIMENSION ILENA(3)
C
C
      IQUOI=2
      CALL ECDES (IOSAU,IQUOI,IFORM)
      NI=0
      IF(ISGTR.NE.0) THEN
         NI=ISGTRI(/1)
      ENDIF
      ILENA(1)= IPIL
      ILENA(2)= NI
      ILENA(3)= IMAX-IDEB+1
      ILLL    = 3
      CALL ECDIFP (IOSAU,ILLL,ILENA,IFORM)
      IF(ISGTR.NE.0) THEN
         IF (NI.NE.0) THEN
            NTMP=ISGTRI(/1)
            SEGINI ISTMP
            DO 999 ITMP=1,NTMP
              ISTMPC(ITMP)=ISGTRC(ITMP)
 999        CONTINUE
            CALL ECNOMS(IOSAU,NI,ISTMP,IFORM)
            SEGSUP ISTMP
            CALL ECDIFE(IOSAU,NI,ISGTRI,IFORM)
C       ... Rappel sur le terminal ...
            IF( ISILEN.NE.1)WRITE(IOIMP,800) NI
*            WRITE(IOIMP,801)(ISGTRC(I),ISGTRI(I),I=1,NI)
         ENDIF
      ENDIF
      RETURN

C-OLD  800 FORMAT('  IL Y A ',I5,'  OBJET(S) NOMME(S) :')
  800 FORMAT('  IL Y A ',I8,'  OBJET(S) NOMME(S) :')
c   801 FORMAT(5(2X,A24,I5))
      END







