C PMIXT     SOURCE    PV        07/11/23    21:18:35     5978
C   CALCULE LE PRODUIT MIXTE DE IDIM VECTEURS
C
      SUBROUTINE PMIXT
      IMPLICIT INTEGER(I-N)
      IMPLICIT real*8 (a-h,o-z)
-INC CCOPTIO
-INC SMCOORD
      REAL*8 PM
      CALL LIROBJ('POINT ',IP1,1,IRETOU)
      CALL LIROBJ('POINT ',IP2,1,IRETOU)
      IF (IERR.NE.0) RETURN
      SEGACT MCOORD
      IREF1=(IDIM+1)*(IP1-1)
      IREF2=(IDIM+1)*(IP2-1)
      X1=XCOOR(IREF1+1)
      X2=XCOOR(IREF2+1)
      Y1=XCOOR(IREF1+2)
      Y2=XCOOR(IREF2+2)
      IF (IDIM.EQ.3) GOTO 10
      PM=X1*Y2-Y1*X2
      GOTO 20
  10  CALL LIROBJ('POINT ',IP3,1,IRETOU)
      IF (IERR.NE.0) RETURN
      IREF3=(IDIM+1)*(IP3-1)
      Z1=XCOOR(IREF1+3)
      Z2=XCOOR(IREF2+3)
      X3=XCOOR(IREF3+1)
      Y3=XCOOR(IREF3+2)
      Z3=XCOOR(IREF3+3)
      PM=X1*(Y2*Z3-Y3*Z2)+Y1*(Z2*X3-Z3*X2)+Z1*(X2*Y3-X3*Y2)
  20  CONTINUE
      CALL ECRREE(PM)
      RETURN
      END


