C BMLBST    SOURCE    CHAT      05/01/12    21:41:28     5004
C BMLBST    SOURCE    BROC      85/07/01    23:05:03
      SUBROUTINE BMLBST(BLX,BLY,BLZ,BLT,DJAC,VML22,IFOU,LRE,NDDL,REL)
C=======================================================================
C
C    INTEGRE LE PRODUIT BLT ML BL
C       POUR LES ELEMENTS LIQUIDES
C
C          ROUTINE FORTRAN PUR
C=======================================================================
C  INPUT
C     BLX =MATRICE CONTENANT LES DERIVEES DES FONCTIONS DE FORME /X
C     BLY =MATRICE CONTENANT LES DERIVEES DES FONCTIONS DE FORME /Y
C     BLZ =MATRICE CONTENANT LES DERIVEES DES FONCTIONS DE FORME /Z
C     BLT =MATRICE CONTENANT LES DERIVEES DES FONCTIONS DE FORME /TETA
C     DJAC=JACOBIEN
C     VML22=-(COEFPI**2)/RHO
C     IFOU=IFOUR DE CCOPTIO
C     LRE =NOMBRE DE COLONNES DES MATRICES BL
C     NDDL=NOMBRE DE DEGRES DE LIBERTE
C  OUTPUT
C     REL(LRE,LRE) =MATRICE MASSE
C=======================================================================
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION BLX(NDDL,1),BLY(NDDL,1),BLZ(NDDL,1),BLT(NDDL,1)
      DIMENSION REL(LRE,1)
      IFR=IFOU+4
      GOTO (666,10,10,10,30,40) ,IFR
C
C     ELEMENTS LIQUIDES 2DIM   CONT PLANES OU DEFO PLANES OU AXIS
C
  10  CONTINUE
      DO 100 IX=1,LRE
      DO 100 IY=1,IX
      REL(IX,IY)=REL(IX,IY)+DJAC*VML22*(BLX(2,IY)*BLX(2,IX)+
     1                        BLY(2,IY)*BLY(2,IX))
      REL(IY,IX)=REL(IX,IY)
100   CONTINUE
      GOTO  666
C
C     ELEMENTS LIQUIDES BIDIM FOURIER
C
  30  CONTINUE
      DO 300 IX=1,LRE
      DO 300 IY=1,IX
      REL(IX,IY)=REL(IX,IY)+DJAC*VML22*(BLX(2,IY)*BLX(2,IX)+
     1                        BLY(2,IY)*BLY(2,IX)+
     2                        BLT(2,IY)*BLT(2,IX))
      REL(IY,IX)=REL(IX,IY)
300   CONTINUE
      GOTO  666
C
C     ELEMENTS LIQUIDES TRIDIM
C
  40  CONTINUE
      DO 400 IX=1,LRE
      DO 400 IY=1,IX
      REL(IX,IY)=REL(IX,IY)+DJAC*VML22*(BLX(2,IY)*BLX(2,IX)+
     1                        BLY(2,IY)*BLY(2,IX)+
     2                        BLZ(2,IY)*BLZ(2,IX))
      REL(IY,IX)=REL(IX,IY)
400   CONTINUE
      GOTO  666
C
 666  CONTINUE
      RETURN
      END

