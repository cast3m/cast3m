C INTER4    SOURCE    BP208322  16/12/15    21:15:02     9267
C
      SUBROUTINE INTER4(TEMPS,KTE,KFT,IRET)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C   INTERPOLATION LINEAIRE ; recherche par parcours des abscisses
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C  TEMPS  : valeur où interpoler la fonction
C  KTE    : abscisses de la fonction à interpoler
C  KFT    : ordonnées de la fonction à interpoler
C  LON    : longueur de ces deux précédentes listes
C  IRET   : code retour = pointeur vers listreel si succès, 0 sinon
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC SMLREEL
-INC CCOPTIO
-INC CCREEL
*
      IRET=0
      JG=0
      SEGINI,MLREEL

      MLREE1=KTE
      MLREE2=KFT
      LON1=MLREE1.PROG(/1)

      I=0
c     -------------- BOUCLE SUR LES SEGMENTS
 1    CONTINUE
      I=I+1
      IF(I.GE.LON1) GOTO 70

      T1=MLREE1.PROG(I)
      T2=MLREE1.PROG(I+1)

c     OK si    (T1.LE.TEMPS.AND.TEMPS.LT.T2)
c           OR (T1.GE.TEMPS.AND.TEMPS.GT.T2)
c     REM : ON NE FAIT PAS D'ERREUR SI T1=T2=TEMPS
      IF(T1.LE.TEMPS.AND.TEMPS.LT.T2) THEN
      ELSEIF(T1.GE.TEMPS.AND.TEMPS.GT.T2) THEN
      ELSE
        GOTO 1
      ENDIF

c     INTERPOLATION
      DT=T2-T1
      XP2=(TEMPS-T1)/DT
      XP1=(T2-TEMPS)/DT
      FT1=MLREE2.PROG(I)
      FT2=MLREE2.PROG(I+1)
      FT0=(XP1*FT1)+(XP2*FT2)
      PROG(**)=FT0

      GOTO 1
c     -------------- FIN DE BOUCLE SUR LES SEGMENTS

 70   CONTINUE
      SEGDES,MLREEL
      IRET=MLREEL

      RETURN
      END






