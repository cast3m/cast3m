C FLURUN    SOURCE    CHAT      05/01/13    00:04:56     5004
      SUBROUTINE FLURUN(SIGI,EPSINI,TETIN,TRINS,HPAS2,ICLFLU,NCOURB,
     . IBOU,ITYP,BTAA,BETA,BTAEPS,BTAPAS,ICOD,DSIGK,DEPSK,SIGF,EPSINF,
     . WEP,EPSINT,PREC,ecou)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION SIGI(6),DSIGK(6),SIGF(6)
C
        SEGMENT ECOU
***     COMMON/ECOU/TEST,ALFAH,
       REAL*8 TEST, ALFAH,
     1 HPAS,TEMPS,COVNMS(6),VECPRO(9),VALPRO(6),
     2 CVNMSD(12),STOT(6),SIGEL(6),DSIGP(6),SIGT(6),SIG5(6),SIGINT(6),
     1 DALPHA(6),DSIGO(6),E(12),XINV(3),
     2 SIPLAD(6),DSIGP0(6),TET,TETI
      ENDSEGMENT
      COMMON/ECOU/TEST,ALFAH,
     1 HPAS,TEMPS,COVNMS(6),VECPRO(9),VALPRO(6),
     2 CVNMSD(12),STOT(6),SIGEL(6),DSIGP(6),SIGT(6),SIG5(6),SIGINT(6),
     1 DALPHA(6),DSIGO(6),E(12),XINV(3),
     2 SIPLAD(6),DSIGP0(6),TET,TETI
C
      ICOD=0
      PREBTA=2.D00
      PREZER=1.D-7
      SINI=VNMISD(SIGI,ITYP,ALFAH,CVNMSD)
      CALL CRPLAW(VI,EPSINI,SINI,TETIN,TRINS,HPAS2,ICLFLU,NCOURB)
      DEPSK=VI*HPAS2
      IF(DEPSK.LT.PREC) GO TO 10
      BETA=BETA*0.5
      ICOD=1
      RETURN
10    EPSINF=EPSINT+DEPSK*WEP
      BTASIG=DEPSK*BTAEPS
      IF(BTASIG.GT.PREBTA) BTASIG=PREBTA
      IF(BTAA.LE.PREZER) BTASIG=BTAPAS
      ELTA=0.
      IF(SINI.NE.0.) ELTA=VI/SINI
      ELTF=ELTA*HPAS2
      DO 20 IB=1,IBOU
      DSIGK(IB)=DSIGP0(IB)*BTAPAS+(DSIGP(IB)-DSIGP0(IB))*BTASIG
     . -E(IB)*SIGI(IB)*ELTF
      SIGF(IB)=SIGINT(IB)+DSIGK(IB)*WEP
20    CONTINUE
      RETURN
      END



