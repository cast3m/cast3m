C PILEP1    SOURCE    PV        09/03/12    21:30:09     6325
      SUBROUTINE PILEP1 (IPCHA2,IPCHA,XX,CRIT)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
-INC SMCHAML
-INC CCOPTIO
*
      MCHAML=IPCHA
      MCHAM2=IPCHA2
*
*     ON CHERCHE LES NOM DE COMPOSANTES EN COMMUN DANS LES
*     2 CHAMELEMS
*
      DO 1 ICOMP=1,IELVAL(/1)
         CALL PLACE (MCHAM2.NOMCHE,MCHAM2.NOMCHE(/2),IPLAC,
     &               NOMCHE(ICOMP))
         IF (IPLAC.NE.0) THEN
            IPMEL1=IELVAL(ICOMP)
            IPMEL2=MCHAM2.IELVAL(IPLAC)
            ICOD=0
            IF (TYPCHE(ICOMP).EQ.'POINTEURLISTREEL') ICOD=1
            IF (TYPCHE(ICOMP).EQ.'POINTEURPOINT   ') ICOD=2
            IF ( ICOD.NE.0) THEN
                  CALL ERREUR(19)
                  RETURN
            ENDIF
            CALL PILEP2(IPMEL1,IPMEL2,XX,IRETOU,CRIT)
            IF (IRETOU.NE.0) THEN
               IF (IRETOU.EQ.197) MOTERR(1:4)=NOMCHE(ICOMP)
               CALL ERREUR (IRETOU)
               RETURN
            ENDIF
         ELSE
            CALL ERREUR(19)
            RETURN
         ENDIF
 1    CONTINUE
*
 9990 CONTINUE
      RETURN
      END



