C SIMULT    SOURCE    CHAT      05/01/13    03:19:41     5004
      SUBROUTINE SIMULT(IPMASS,IPSOLU,IPRIG1,IPRIG2,LIMAGE,FREQ,NN)
************************************************************************
*
*                             S I M U L T
*                             -----------
*
*     SOUS-PROGRAMME ASSOCIE A L'OPTION "SIMULTANE" DE L'OPERATEUR
*     "VIBRATION".
*
* FONCTION:
* ---------
*
*     DETERMINER UNE SERIE DE MODES PROPRES DONT LES FREQUENCES SONT
*     VOISINES D'UNE VALEUR DONNEE.
*
* PHRASE D'APPEL (EN GIBIANE):
* ----------------------------
*
*     MODES = VIBRATION SIMULTANE FREQ NN MAT_K MAT_M ;
*
* OPERANDES ET RESULTATS:
* -----------------------
*
*     FREQ      'FLOTTANT'  VALEUR QUE LES FREQUENCES PROPRES DEVRONT
*                           AVOISINER.
*     NN        'ENTIER  '  NOMBRE DE MODES DEMANDES.
*     MAT_K     'RIGIDITE'  MATRICE DE RIGIDITE (SOUS-TYPE 'RIGIDITE').
*     MAT_M     'RIGIDITE'  MATRICE MASSE (SOUS-TYPE 'MASSE').
*     MODES     'SOLUTION'  ENSEMBLE DES MODES PROPRES CALCULES.
*
* LEXIQUE: (ORDRE ALPHABETIQUE)
* --------
*
*     IPMASS  ENTIER    POINTEUR DE L'OBJET "MAT_M".
*     IPRIGI  ENTIER    POINTEUR DE L'OBJET "MAT_K".
*     IPSOLU  ENTIER    POINTEUR DE L'OBJET "MODES".
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     PASCAL MANIGOT     04 AVRIL 1985
*
* LANGAGE:
* --------
*
*     FORTRAN77
*
************************************************************************
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
*
      REAL*8 FREQ
      LOGICAL  LIMAGE

       IF(NN.LT.1) NN=1

       IF(FREQ.LT.0.D0.AND.(.NOT.LIMAGE)) FREQ= 0.D0

*
*     VERIFICATION DES SOUS-TYPES DES 'RIGIDITE':
      CALL WHICH1 (IPRIG1,IPRIG2,  IPRIGI,IPMASS)
      IF (IERR .NE. 0) RETURN
*
*     -- DETERMINATION DES MODES PROPRES --
*
      CALL SIMUL1 (FREQ,NN,IPRIGI,IPMASS,  IPSOLU, LIMAGE)
      IF (IERR .NE. 0) RETURN
*
*
      END


