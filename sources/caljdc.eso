C CALJDC    SOURCE    CHAT      05/01/12    21:46:49     5004
      SUBROUTINE CALJDC(FN,GR,PG,XYZ,HR,PGSQ,RPG,ND,IES,NP,NPG,
     *IAXI,AIRE)
C************************************************************************
C
C     CALJDC APPEL CALJ22
C
C            LA DIFFERENCE AVEC CALJAC EST LE RANGEMENT DE HR
C                        HR(IES,NP)
C
C
C     CALCUL DE L'INVERSE DU JACOBIEN  AJ=1/J
C     CALCUL DE L'ELEMENT D'AIRE       SQ=DET(J)
C     DANS LES CAS 1D 2D ET 3D
C
C     ND   DIMENSION ESPACE DE DEFINITION DE L'ELEMENT (ALIAS NES)
C     IES  DIMENSION ESPACE DE TRAVAIL >= ND
C     NP   NOMBRE DE NOEUDS DE L'ELEMENT
C     NPG  NOMBRE DE POINTS D'INTEGRATION
C
C     XYZ  COORDONNEES
C     GR   GRADIENT
C
C************************************************************************
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
C
      REAL*8 FN(NP,NPG),GR(ND,NP,NPG),HR(IES,NP,NPG),HHR(162)
      REAL*8 PG(NPG),XYZ(IES,NP),PGSQ(NPG),RPG(NPG)
      REAL*8 AJ(3,3,64)
C
C
C     WRITE(6,*)' *** SUB CALJBC *** ND,IES',ND,IES
      IF(ND.EQ.IES)GOTO 20

      CALL CALJCC(FN,GR,PG,XYZ,HR,PGSQ,RPG,IES,ND,NP,NPG,IAXI,AIRE,AJ,
     &HHR)
      RETURN
 20   CONTINUE

      CALL CALJ22(FN,GR,PG,XYZ,HR,PGSQ,RPG,ND,NP,NPG,IAXI,AIRE,AJ)

      RETURN
 1002 FORMAT(10(1X,1PE11.4))
 1001 FORMAT(20(1X,I5))
      END



