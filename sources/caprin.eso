C CAPRIN    SOURCE    CHAT      05/01/12    21:49:06     5004
C CAPRIN     SOURCE    INSL       24/10/96
      SUBROUTINE CAPRIN(S1,V1,NSTRS,ALPHA,RB,DTR1,DTR2,TETA)
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION S1(NSTRS),V1(4)
C
      CALL PRINC(S1,V1,NSTRS)
      FPT=ALPHA*RB
      IF(V1(1).GE.0.D0) THEN
         DTR1=V1(1)
         DTR2=FPT
         IF(DTR1.LT.0.D0)  DTR1=0.D0
         IF(DTR1.GE.FPT)   DTR1=FPT
         IF(DTR1.LT.1.D-8) DTR1=0.D0
         TETA=V1(4)
      ENDIF
*
      RETURN
      END



