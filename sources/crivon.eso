C CRIVON    SOURCE    CHAT      05/01/12    22:31:09     5004
      SUBROUTINE CRIVON(S1,SEQ,NSTRS,BETJEF)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION S1(4)
*
      SEGMENT BETJEF
       REAL*8 AA,BETA,RB,ALPHA,EX,PXY,GFC,GFT,CAR,ETA,TDEF,
     &          TCON,DPSTF1,DPSTF2,TETA,PDT
       INTEGER ICT,ICC,IMOD,IVIS,ITER,
     &                ISIM,IBB,IGAU,IZON
      ENDSEGMENT
*
*     COMMON /DBETJEF/AA,BETA,RB,ALPHA,EX,PXY,GFC,GFT,CAR,ETA,TDEF,
*    &          TCON,DPSTF1,DPSTF2,TETA,PDT,ICT,ICC,IMOD,IVIS,ITER,
*    &                ISIM,IBB,IGAU,IZON
      IF (NSTRS.EQ.3) THEN
      SX=S1(1)
      SY=S1(2)
      SXY=S1(3)
      DJ2=(1.D0/6.D0)*((SX-SY)*(SX-SY)+SX*SX+SY*SY+6*SXY*SXY)
      ELSE
      SX=S1(1)
      SY=S1(2)
      SZ=S1(3)
      SXY=S1(4)
      TX=(SX-SY)*(SX-SY)
      TY=(SX-SZ)*(SX-SZ)
      TZ=(SY-SZ)*(SY-SZ)
      DJ2=(1.D0/6.D0)*(TX+TY+TZ+6*SXY*SXY)
      ENDIF
      DJ2=3.D0*DJ2
      DJ2=SQRT(DJ2)
      SEQ=DJ2
C
      RETURN
      END



