C CRCHPE    SOURCE    PV        09/03/12    21:18:35     6325
      SUBROUTINE CRCHPE(MELEME,NC,MCHELM)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)

-INC CCOPTIO
-INC SMCHAML
-INC SMELEME

      SEGACT MELEME
      NBSOUS=LISOUS(/1)
      IF(NBSOUS.EQ.0)NBSOUS=1
      N1=NBSOUS
      N3=6
      L1=0
      N2=NC
      N2PTEL=0
      N2EL=0
      SEGINI MCHELM
      IFOCHE=IFOMOD
      DO 1 L=1,MAX(1,LISOUS(/1))
      IPT1=MELEME
      IF(LISOUS(/1).NE.0)IPT1=LISOUS(L)
      SEGACT IPT1
      N1EL=IPT1.NUM(/2)
      N1PTEL=IPT1.NUM(/1)
      SEGINI MCHAML
      IMACHE(L)=IPT1
      ICHAML(L)=MCHAML
      DO 2 N=1,NC
      SEGINI MELVAL
      IELVAL(N)=MELVAL
      NOMCHE(N)='SCAL    '
      TYPCHE(N)='REAL*8  '
      SEGDES MELVAL
 2    CONTINUE
      SEGDES MCHAML
      SEGDES IPT1
 1    CONTINUE
      SEGDES MELEME
      SEGDES MCHELM
      RETURN
      END




