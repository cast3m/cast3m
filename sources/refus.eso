C REFUS     SOURCE    PV        18/10/17    11:46:25     9965
C        SUBROUTINE REFUS
C
C   CE SERVEUR FAIT PARTIE DU NOYAU DE GESTION DES OBJETS.(GIBI 1.00)
C   IL A POUR BUT DE REFUSER UNE DONNEE DE TYPE MOT
C   IL REMET IPILE(IMOTLU) A 1
C
      SUBROUTINE REFUS
      IMPLICIT INTEGER(I-N)
-INC CCNOYAU
-INC CCOPTIO
-INC CCASSIS
      IF(IIMPI.EQ.1876) WRITE(IOIMP,1754) IMOTLU,IBPILE,IHPILE ,JPOOB
 1754 FORMAT('  REFUS : IMOTLU IBPILE IHPILE JPOOB ',4I6)
      ith=0
      if (nbesc.ne.0) ith=oothrd
      if (ith.ne.0) then
        call liresc('annule  ',iret,-1,iretou)
        return
      endif
      IF(IMOTLU.EQ.0)  CALL ERREUR (38)
      IF (IMOTLU.EQ.0) RETURN
      JPOOB1(IMOTLU)=.TRUE.
      IF(IBPILE.GT.IMOTLU) IBPILE=IMOTLU
      IF(IHPILE.LT.IMOTLU) IHPILE=IMOTLU
      IMOTLU=0
      RETURN
      END






