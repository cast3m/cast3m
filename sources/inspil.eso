C INSPIL    SOURCE    CHAT      06/03/16    21:19:23     5336
C   INSERE LE CONTENU D'UN OBJET DE TYPE TEXTE DANS LA PILE DEJA DECODES
C   APRES AVOIR AU BESOIN FAIT LA TRADUCTION DU TEXTE
      SUBROUTINE INSPIL(MTAXTE,IPL)
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMTEXTE
-INC CCNOYAU
      MTEXTE=MTAXTE
      IF(IIMPI.EQ.1756)WRITE(IOIMP,53) MTAXTE
  53  FORMAT( ' ENTREE DANS INSPIL POUR TEXTE : MTEXTE ',I5)
      CALL TRADTE(MTAXTE,MTRA)
      MTRADU=MTRA
      SEGACT MTEXTE,MTRADU
C--
C--  ON PLACE LA PHRASE INTERPRETER DANS LA PILE A LA PLACE DE
C--  L'OBJET TEXTE
C--
      ILON=MTRAD(/1)
      IF(IIMPI.EQ.1756)WRITE(IOIMP,54) MTEXTE,MTRADU,ILON
   54 FORMAT('  INSPIL  APRES TRADTE MTEXTE MTRADU  ILON ',3I6)

      IF( ILON.EQ.0) THEN
         JPOOB1(IPL)=.FALSE.
         SEGDES MTEXTE,MTRADU
         RETURN
      ENDIF
      IDEC=ILON-1
      IF(IDEC.NE.0) THEN
         ILO=JTYOBJ(/2)-IHPILE
         ICRE=IDEC-ILO
         IF(ICRE.GT.0) THEN
            N=JTYOBJ(/2)+ICRE
            SEGADJ JPOOB
         ENDIF
         ITI=IHPILE +IDEC
         IDECA=IHPILE-IPL
         IF(IDECA.EQ.0) GO TO 157
         DO 158 IDCA=1,IDECA
         JPOOB1(ITI+1-IDCA)=JPOOB1(IHPILE+1-IDCA)
         JPOOB2(ITI+1-IDCA)=JPOOB2(IHPILE+1-IDCA)
         JPOOB4(ITI+1-IDCA)=JPOOB4(IHPILE+1-IDCA)
         JTYOBJ(ITI+1-IDCA)=JTYOBJ(IHPILE+1-IDCA)
  158    CONTINUE
  157    CONTINUE
         IHPILE=ITI
      ENDIF
      IKLA=IPL
      DO 243 IPEU=1,ILON
      IPLAC=MTRAD(IPEU)
            JPOOB1(IKLA)=.TRUE.
            JPOOB2(IKLA)=IPLAC
            JPOOB4(IKLA)=IOUEP2(IPLAC)
            JTYOBJ(IKLA)=INOOB2(IPLAC)
            IKLA=IKLA+1
  243 CONTINUE
      SEGDES  MTEXTE,MTRADU
      RETURN
      END

