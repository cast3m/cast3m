C DATE      SOURCE    PV        19/01/10    21:15:00     10073
      SUBROUTINE DATE
      INTEGER ITTIME(8)
      INTEGER FONCTI
      INTEGER IMOLET
      INTEGER NJOUR,NHEURE,NMIN
      INTEGER NB_TIC,NTICMAX,NTICSEC
      REAL*8 NSEC
      INTEGER MSEC
      CHARACTER*6 MOTLET(1)
      CHARACTER*10 MOTCLF(8)
      CHARACTER*4 MOTMOI(12)
      CHARACTER*32 CHADA
-INC CCOPTIO
      DATA MOTLET/'LETTRE'/
      DATA MOTCLF/'CONVERSION','EPOCH',
     &'ANNEE','MOIS', 'JOUR', 'HEURE', 'MINUTE', 'SECONDE'/
      DATA MOTMOI/'jan.','fev.','mars','avr.','mai '
     & ,'juin','jui.','aout','sep.','oct.','nov.','dec.'/
      CALL LIRMOT(MOTLET,1,IMOLET,0)
      CALL LIRMOT(MOTCLF,8,FONCTI,0)
      IF(FONCTI.EQ.1) THEN
         CALL LIRREE(NSEC,1,IRETOU)
         NJOUR = INT (NSEC / 86400.)
         NSEC = NSEC - 86400. * FLOAT (NJOUR)
         NHEURE = INT (NSEC / 3600.)
         NSEC = NSEC - 3600. *  FLOAT (NHEURE)
         NMIN = INT (NSEC / 60.)
         NSEC = NSEC - 60. *  FLOAT (NMIN)
         WRITE(CHADA,10)  NJOUR, NHEURE,NMIN, NSEC
         CALL ECRCHA(CHADA)
      ELSEIF(FONCTI.EQ.2) THEN
         CALL OOOZZ1(ITTIME)
        NJOUR=ITTIME(1)
* on se place dans l'hypothese (conservatrice) d'une annee bissextile
        if(ITTIME(2).EQ.2) NJOUR=NJOUR+31
        if(ITTIME(2).EQ.3) NJOUR=NJOUR+60
        if(ITTIME(2).EQ.4) NJOUR=NJOUR+91
        if(ITTIME(2).EQ.5) NJOUR=NJOUR+121
        if(ITTIME(2).EQ.6) NJOUR=NJOUR+152
        if(ITTIME(2).EQ.7) NJOUR=NJOUR+182
        if(ITTIME(2).EQ.8) NJOUR=NJOUR+213
        if(ITTIME(2).EQ.9) NJOUR=NJOUR+144
        if(ITTIME(2).EQ.10) NJOUR=NJOUR+274
        if(ITTIME(2).EQ.11) NJOUR=NJOUR+305
        if(ITTIME(2).EQ.12) NJOUR=NJOUR+335
        NANNEE=ITTIME(3)-1
        NJOUR=NJOUR+NANNEE*366
        MSEC = NJOUR*86400+ITTIME(4)*3600+ITTIME(5)*60+ ITTIME(6)
        nSEC=FLOAT(MSEC)
         CALL ECRREE(NSEC)
      ELSEIF(FONCTI.EQ.3) THEN
         CALL OOOZZ1(ITTIME)
         ITTIME(3)  = ITTIME(3) + 1900
         CALL ECRENT(ITTIME(3))
      ELSEIF(FONCTI.EQ.4) THEN
         CALL OOOZZ1(ITTIME)
         IF(IMOLET.EQ.0) THEN
            CALL LIRMOT(MOTLET,1,IMOLET,0)
         ENDIF
         IF(IMOLET.EQ.0) THEN
            CALL ECRENT(ITTIME(2))
         ELSE
            CHADA = MOTMOI(ITTIME(2))
            CALL ECRCHA(CHADA(1:4))
         ENDIF
      ELSEIF(FONCTI.EQ.5) THEN
         CALL OOOZZ1(ITTIME)
         CALL ECRENT(ITTIME(1))
      ELSEIF(FONCTI.EQ.6) THEN
         CALL OOOZZ1(ITTIME)
         CALL ECRENT(ITTIME(4))
      ELSEIF(FONCTI.EQ.7) THEN
         CALL OOOZZ1(ITTIME)
         CALL ECRENT(ITTIME(5))
      ELSEIF(FONCTI.EQ.8) THEN
         CALL OOOZZ1(ITTIME)
         CALL ECRENT(ITTIME(6))
      ELSE
         CALL OOOZZ1(ITTIME)
         ITTIME(3)  = ITTIME(3) + 1900
         IF(IMOLET.EQ.0) THEN
         WRITE(CHADA,20) ITTIME(1), ITTIME(2), ITTIME(3), ITTIME(4),
     &            ITTIME(5),ITTIME(6)
         ELSE
            WRITE(CHADA,30) ITTIME(1), MOTMOI(ITTIME(2)), ITTIME(3),
     &             ITTIME(4),ITTIME(5)
         ENDIF
         CALL ECRCHA(CHADA)
      ENDIF
      RETURN
10    FORMAT(I9,'J ',I2.2,'H ',I2.2,'min ',F6.3,'sec')
20    FORMAT(I2.2,'/',I2.2,'/',I4.4,' - ', I2.2,':',I2.2,':',I2.2)
30    FORMAT(I2.2,' ',A4,' ',I4.4,' - ', I2.2,'H',I2.2,'min')
      END



