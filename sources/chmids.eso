C CHMIDS    SOURCE    CHAT      05/01/12    21:59:10     5004
      SUBROUTINE CHMIDS(MLAA,MLOGK,MLFF,MLIDX,MLIDY,MLIDZ,MLIDP,MLNN,
     * MLDECY,MLNAME,MLIONZ,IDSCHI,MLNESP)
C CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C               OPERATEUR CHI2
C    ON CHARGE LE SEGMENT IDSCHI
C    TOUS LES SEGMENTS SONT ACTIFS AVANT L APPEL
C
C CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
-INC CCOPTIO
-INC SMLENTI
-INC SMLREEL
-INC SMLMOTS
      SEGMENT IDSCHI
           REAL*8 GK(NYDIM),AA(NYDIM,NXDIM),FF(NZDIM,NPDIM)
           INTEGER IDX(NXDIM),IDY(NYDIM),IDZ(NZDIM),IDP(NPDIM),NN(6)
           INTEGER IDECY(NYDIM),IONZ(NXDIM)
           CHARACTER*32 NAME(NXDIM),NAMESP(NYDIM)
      ENDSEGMENT
C
      MLREEL=MLAA
      JG=PROG(/1)
      CALL RSETD(AA,PROG,JG)
      MLREEL=MLFF
      JG=PROG(/1)
      CALL RSETD(FF,PROG,JG)
      MLENTI=MLIDX
      NXDIM=LECT(/1)
      CALL RSETI(IDX,LECT,NXDIM)
      MLENTI=MLIDY
      NYDIM=LECT(/1)
      CALL RSETI(IDY,LECT,NYDIM)
      MLENTI=MLIDZ
      NZDIM=LECT(/1)
      CALL RSETI(IDZ,LECT,NZDIM)
      MLENTI=MLIDP
      NPDIM=LECT(/1)
      CALL RSETI(IDP,LECT,NPDIM)
      MLREEL=MLOGK
      CALL RSETD(GK,PROG,NYDIM)
      MLENTI=MLNN
      CALL RSETI(NN,LECT,6)
      MLENTI=MLDECY
      CALL RSETI(IDECY,LECT,NYDIM)
      MLENTI=MLIONZ
      CALL RSETI(IONZ,LECT,NXDIM)
      MLMOTS=MLNAME
      DO 50 I=1,NXDIM
          NAME(I)=MOTS(I)
   50 CONTINUE
      MLMOTS=MLNESP
      DO 60 I=1,NYDIM
          NAMESP(I)=MOTS(I)
   60 CONTINUE
CCCCC
c      WRITE(6,*)'FIN CHMIDS.ESO'
c      WRITE(6,*)'IDX',(IDX(J),J=1,NXDIM)
c      write(6,*)'IDY',(IDY(i),i=1,nydim)
c      write(6,*)'IDZ',(idz(k),k=1,nzdim)
c      write(6,*)'IDP',(idp(n),n=1,npdim)
c      DO 60 I=1,NYDIM
c        WRITE(6,*)'IDY',IDY(I),'AA',(AA(I,J),J=1,NXDIM)
c   60 CONTINUE
c      DO 70 K=1,NZDIM
c        WRITE(6,*)'IDZ',IDZ(K),'FF',(FF(K,I),I=1,NPDIM)
c   70 CONTINUE
CCCCC
      RETURN
      END




