C TIMAL2    SOURCE    PV        18/06/18    21:15:39     9860
C TIMAL2    SOURCE    AM        93/01/12    21:35:51     781
      SUBROUTINE TIMAL2(RP,XL,RHO,SD,XINZ)
C-----------------------------------------------------------------------
C
C    ROUTINE DE CALCUL DE LA MATRICE DE MASSE ELEMENTAIRE D UNE
C    POUTRE DROITE EN AXES LOCAUX
C    D APRES TEDEL
C    DANS CETTE VERSION,ON PREND EN COMPTE LES INERTIES DE ROTATION
C    MAIS PAS LA DEFORMABILITE A L EFFORT TRANCHANT
C
C  ENTREE
C    XL      LONGUEUR
C    SD      SECTION DROITE
C    XINZ    INERTIE IZ
C    RHO     MASSE VOLUMIQUE
C  SORTIE
C    RP      MATRICE DE MASSE ELEMENTAIRE 6X6
C
C    D'APRES TIMALO DC 98
C
C-----------------------------------------------------------------------
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION RP(6,6)
C
C  INITIALISATIONS
C
      DO 120 J=1,6
      DO 120 I=1,6
  120 RP(I,J)=0.D00
C
      RHOSL=RHO*SD*XL
      RSP1= RHO*SD*  XL*0.333333333333333333
      RSP2= RHO*SD*  XL*0.166666666666666666
      FLZ1= RHO*XINZ*XL*0.333333333333333333
      FLZ2= RHO*XINZ*XL*0.166666666666666666
C
C  REMPLISSAGE DE LA MATRICE
C  FX1
      RP(1,1)=RSP1
      RP(1,4)=RSP2
C  FY1
      RP(2,2)=RSP1
      RP(2,5)=RSP2
C  MZ1
      RP(3,3)=FLZ1
      RP(3,6)=FLZ2
C  FX2
      RP(4,4)=RSP1
C  FY2
      RP(5,5)=RSP1
C  MZ2
      RP(6,6)=FLZ1
C
      DO 9 I=1,6
      DO 9 J=I,6
  9   RP(J,I)= RP(I,J)
      RETURN
      END



