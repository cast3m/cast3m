C ERRARE    SOURCE    FANDEUR   12/04/11    21:15:18     7350
      SUBROUTINE ERRARE(IPMODL,IPCHE1,IPCHE2,XERR,IPCHRR)
*_______________________________________________________________________
*
*      CALCUL D'ERREUR SUR LES CONTRAINTES
*
*      METHODE ZIENKIEWICZ - VERSION BARZIC ET RICHARD
*
*_______________________________________________________________________
*
*    ENTREES :
*    ---------
*        IPMODL   POINTEUR SUR UN MMODEL
*        IPCHE1   POINTEUR SUR UN MCHAML DE CONTRAINTES
*        IPCHE2   POINTEUR SUR UN MCHAML DE MATERIAU
*
*
*    SORTIES :
*    ---------
*        XERR     ERREUR GENERALE SCALAIRE
*        IPCHRR   MCHAML D'ERREUR PAR ELEMENT
*                 = 0 SI ERREUR
*
*    PASSAGE AUX NOUVEAUX CHAMELEM PAR JM CAMPENON LE 02/91
*
*------------------------------------------------------------------
*
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (X)
*
-INC CCOPTIO
*
      IPCHRR=0
      CALL SIGMOY(IPMODL,IPCHE1,IPOSGM)
      IF (IPOSGM.EQ.0) GOTO 310
*
      CALL ADCHEL(IPCHE1,IPOSGM,IPODSI,-1)
      IF (IPODSI.EQ.0) GOTO 300
*
*   CHAMP DE VARIABLES INTERNES : IPCH3 = 0 ici (a lire dans ERRE ?)
*
      IPCHE3 = 0
*
      CALL ELAS1(IPMODL,IPCHE1,IPCHE2,IPCHE3,IPOEPS,IRET)
      IF (IRET.NE.1) GOTO 290
*
      CALL ELAS1(IPMODL,IPODSI,IPCHE2,IPCHE3,IPODEP,IRET)
      IF (IRET.NE.1) GOTO 280
*
      CALL ENERCA(IPMODL,IPCHE1,IPOEPS,IPOENE)
      IF (IPOENE.EQ.0) GOTO 270
*
      CALL ENERCA(IPMODL,IPODSI,IPODEP,IPODEN)
      IF (IPODEN.EQ.0) GOTO 260
*
      CALL INTGCA(IPMODL,IPOENE,0,1,IRET,XRET,IPORET)
      IF (IRET.EQ.0) GOTO 250
*
      CALL INTGCA(IPMODL,IPODEN,0,1,IRET,XDRE,IPODRE)
      IF (IRET.EQ.0) GOTO 240
*
      XERR=(XDRE/(XRET+XDRE))**(.5)
      CALL ADCHEL(IPORET,IPODRE,IPOSOM,1)
      CALL PUCHEL(IPOSOM,-1,IPOFAC,IRET)
      IF(IRET.EQ.0) GOTO 220
*
      IPLMOT = -1
      IPLREE = -1
      CALL MUCHSC(IPMODL,IPOFAC,IPODRE,IPOCAR,
     &                   IPLMOT,IPLMOT,IPLMOT,IPLREE,1)
      IF (IPOCAR.EQ.0) GOTO 210
*
      CALL PUCHEL(IPOCAR,1,IPCHRR,IRET)
      IF (IRET.NE.0) GOTO 200
*
      IPCHRR=0
 200  CALL DTCHAM(IPOCAR)
 210  CALL DTCHAM(IPOFAC)
 220  CALL DTCHAM(IPOSOM)
 230  CALL DTCHAM(IPODRE)
 240  CALL DTCHAM(IPORET)
 250  CALL DTCHAM(IPODEN)
 260  CALL DTCHAM(IPOENE)
 270  CALL DTCHAM(IPODEP)
 280  CALL DTCHAM(IPOEPS)
 290  CALL DTCHAM(IPODSI)
 300  CALL DTCHAM(IPOSGM)
 310  RETURN
      END


