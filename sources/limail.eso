C LIMAIL    SOURCE    BP208322  16/11/18    21:18:47     9177
      SUBROUTINE LIMAIL (MELEME,NBANC,IRETOU,IFORM)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C=======================================================================
C
C    BUT          :  LECTURE D UN MELEME SUR LA BANDE IORES
C                    INCREMENT DES NUMEROS SI NBANC NON NUL
C    ECRIT PAR FARVACQUE -REPRIS PAR LENA
C    APPELLE      :  LFCDIE
C    APPELLE PAR  :  LIPIL
C=======================================================================
-INC CCOPTIO
-INC CCGEOME
-INC SMELEME
C=======================================================================
C
      DIMENSION ILENA(10)
C
C*******************LECTURE D 1 OBJET MAILLAGE
C
      IRET=0
      MELEME=0
      ITOTO    = 5
      CALL LFCDIE (IORES,ITOTO,ILENA,IRET,IFORM)
      IF(IRET.NE.0) GOTO 1000
      NOMLU =ILENA(1)
      NBSOUS=ILENA(2)
      NBREF =ILENA(3)
      NBNN  =ILENA(4)
      NBELEM=ILENA(5)
C     TEST S IL S AGIT D UN MELEME NUL
      ITEST= ILENA(1)+ILENA(2)+ILENA(3)+ILENA(4)+ILENA(5)
      IF (ITEST.EQ.-100)GO TO  1000
      SEGINI MELEME
      CALL LFCDIE (IORES,NBSOUS,LISOUS,IRET,IFORM)
      IF(IRET.NE.0) GOTO 1001
      CALL LFCDIE (IORES,NBREF,LISREF,IRET,IFORM)
      IF(IRET.NE.0) GOTO 1001
C---- EST CE UN TYPE D'ELEM CONNU
      IF(NOMLU.LE.NOMBR)GOTO 11
  10  CONTINUE
C     MCOT(1)=NOMLU
C     WRITE (MOT(1:4),FMT='(A4)') MCOT
      IRET=1
      GO TO 1000
C-- FAIRE ICI QQCHOSESI ELEM INCONNU
C -----
  11  ITYPEL=NOMLU
      IF (NBELEM.EQ.0) GOTO 7
      L=NBELEM*NBNN
      CALL LFCDIE(IORES,NBELEM,ICOLOR,IRET,IFORM)
      IF(IRET.NE.0) GOTO 1001
  13  CALL LFCDIE(IORES,L,NUM,IRET,IFORM)
      IF(IRET.NE.0) GOTO 1001
C --- INCREMENTATION DES NUMEROS
      IF(IONIVE.LE.9) THEN
        DO 17 IK=1,NBNN
        DO 17 JK=1,NBELEM
        NUM(IK,JK)=NUM(IK,JK)+NBANC
  17     CONTINUE
      ENDIF
   7  CONTINUE
      SEGDES MELEME
      GO TO 1000
C --- CAS D ERREUR
 1001 CONTINUE
      SEGSUP MELEME
C ---
 1000 IRETOU=IRET
      RETURN
      END












