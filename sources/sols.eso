C SOLS      SOURCE    CHAT      05/01/13    03:21:44     5004
      SUBROUTINE SOLS
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C
C=======================================================================
C  OPERATEUR SOLS : FABRIQUE LES SOLUTIONS STATIQUES POUR LES LIAISON L
C                   DE LA STRUCTURE S
C
C    SYNTAXE :   SS = SOLS L S ;
C      SS  :  OBJET SOLUTION (SOUS TYPE SOLU-STAT)
C      S   :  OBJET STRUCTURE ELEMENTAIRE
C      L   :  OBJET ATTACHE
C
C   ECRIT PAR FARVACQUE
C   APPELLE LIROBJ SOLS1 ERREUR(132,139) ECROBJ
C=======================================================================
C
-INC CCOPTIO
-INC SMSTRUC
-INC SMATTAC
-INC SMSOLUT
C
C
      CALL LIROBJ('ATTACHE ',IMAT,1,IRETOU)
      IF(IERR.NE.0) GO TO 5000
      CALL LIROBJ('STRUCTUR',ISTR,1,IRETOU)
      IF(IERR.NE.0) GO TO 5000
C
      MSTRUC=ISTR
      SEGACT MSTRUC
      IF(LISTRU(/1).EQ.1) GOTO 1
      SEGDES MSTRUC
      MOTERR(1:8)='STRUCTUR'
      CALL ERREUR(132)
      GO TO 5000
 1    CONTINUE
      MSOSTU=LISTRU(1)
      SEGDES MSTRUC
      SEGACT MSOSTU
      KRIGI=ISRAID
      SEGDES MSOSTU
C
C  **** ON COMPTE LES MJONCT QUI AGISSENT SUR MSOSTU ET QUI INTERVIENNEN
C  **** AU PREMIER MEMBRE. ON LES MET DANS MSOLE1
C
      MATTAC=IMAT
      SEGACT MATTAC
      N=0
      SEGINI MSOLE1
      DO 170 IA=1,LISATT(/1)
      MSOUMA=LISATT(IA)
      SEGACT MSOUMA
      IF(ITYATT.EQ.'MECA') GO TO 169
      IF(ITYATT.EQ.'FLUI') GO TO 169
      IF(ITYATT.EQ.'DEPI') GO TO 169
      GOTO 171
  169 CONTINUE
      NL=IATREL(/1)
      DO 172 IB=1,NL
      MJONCT=IATREL(IB)
      SEGACT MJONCT
      NCCC=ISTRJO(/1)
      DO 173 IC=1,NCCC
      IF(ISTRJO(IC).NE.MSOSTU) GO TO 173
      N=N+1
      SEGADJ MSOLE1
      MSOLE1.ISOLEN(N)=MJONCT
      GO TO 174
 173  CONTINUE
 174  CONTINUE
      SEGDES MJONCT
 172  CONTINUE
 171  CONTINUE
      SEGDES MSOUMA
 170  CONTINUE
      SEGDES MATTAC
      IF(N.NE.0) GO TO 2
      INTERR(1)=MSOSTU
      CALL ERREUR(139)
C     ON NE TROUVE PAS DE LIAISON CORRESPONDANT A LA STRUCTURE
      SEGSUP MSOLE1
      GO TO 5000
 2    CONTINUE
C
      KSOSTU=MSOSTU
      KSOLE1=MSOLE1
      CALL SOLS1(KSOSTU,KSOLE1,KSOLUT)
      IF(IERR.NE.0) GOTO 5000
      CALL ECROBJ('SOLUTION',KSOLUT)
 5000 CONTINUE
      RETURN
      END

