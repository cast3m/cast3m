C LFILE     SOURCE    JC220346  18/12/04    21:15:32     9991
      SUBROUTINE LFILE(NOM,TYPE,CSGT,ISGT)
C************************************************************************
C
C     CE SOUS PROGRAMME FAIT LA LISTEC DES OBJETS D'UN TYPE DONNE
C     ET LA MET DANS LE SEGMENT IZTGN
C     LE SEGMENT IZTGP CONTIENT LUI LES POINTEURS DE CES OBJETS
C
C************************************************************************
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
-INC CCOPTIO
-INC CCNOYAU
-INC TMLNOMS
      SEGMENT CSGT
         CHARACTER*(LONOM) CSGTR(0)
      ENDSEGMENT
      SEGMENT/ISGT/(ISGTR(0))
      CHARACTER*8 TYPE
      CHARACTER*(LONOM) NOM

C CONSTRUCTION DE LA TABLE DES OBJETS
      SEGINI CSGT,ISGT
      CALL REPERT(TYPE,ITITI)
      IF(ITITI.NE.0) THEN
         CALL REPLIS(TYPE,MLNOMS)
         ICO=1
         DO 11 I=1,ITITI
            CALL LIROBJ(TYPE,IP1,1,IRETOU)
            IF(IERR.NE.0) RETURN
            IF (IP1.EQ.0) GOTO 11
            ISGTR(**)=IP1
            CSGTR(**)=LINOMS(I)
            ICO=ICO+3
  11     CONTINUE
         SEGSUP MLNOMS
  12  ENDIF


      RETURN
      END



