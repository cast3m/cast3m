C TUFINO    SOURCE    CHAT      05/01/13    03:55:59     5004
      SUBROUTINE TUFINO(XM,XP,THETA,IRET,XM0,XP0)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C    Include contenant quelques constantes dont XPI :
-INC CCREEL
C=======================================================================
C     SOUS-PROGRAMME PERMETTANT DE SAVOIR DANS QUELLE REGION
C     DU PLAN M-P ON SE TROUVE
C
C     ENTREES : XM     :VALEUR DU MOMENT
C               XP     :VALEUR DE L EFFORT NORMAL
C               THETA  :ANGLE DE LA FISSURE
C
C     SORTIE : IRET    :ENTIER DEFINISSANT LA REGION DU PLAN
C=======================================================================
      CRI=2.D0*XP0*(1.D0-THETA/XPI)*XM
      CRI=CRI+XM0*SIN(THETA)*XP
      IF(CRI.GE.XZERO) THEN
         GO TO 1
      ELSE
         GO TO 2
      ENDIF
 1    CONTINUE
      CRIT1=SIN(THETA)/2.D0
      CRIT1=CRIT1-COS((THETA-XPI*XP/XP0)/2.D0)
      CRIT1=CRIT1-XM/XM0
      IF(CRIT1.LT.XZERO) IRET=1
      IF(CRIT1.GE.XZERO.AND.XP.GT.0.D0) IRET=2
      IF(CRIT1.GE.XZERO.AND.XP.LE.0.D0) IRET=4
      RETURN
 2    CONTINUE
      CRIT1=SIN(THETA)/2.D0
      CRIT1=CRIT1-COS((THETA+XPI*XP/XP0)/2.D0)
      CRIT1=CRIT1+XM/XM0
      IF(CRIT1.LT.XZERO) IRET=3
      IF(CRIT1.GE.XZERO.AND.XP.GT.0.D0) IRET=2
      IF(CRIT1.GE.XZERO.AND.XP.LE.0.D0) IRET=4
      RETURN
      END





