C FUSSPG    SOURCE    CHAT      05/01/13    00:13:15     5004
      SUBROUTINE FUSSPG(MELEM0,IRET)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)

-INC SMELEME
      POINTEUR MELEM1.MELEME,IRES.MELEME
      IRES=IRET
      MELEM1=MELEM0
      SEGACT MELEM1
      IF(IRES.EQ.0)THEN
      NBNN=1
      NBELEM=MELEM1.NUM(/2)
      N1=MELEM1.NUM(/2)
      NBSOUS=0
      NBREF=0
      SEGINI IRES
      IRES.ITYPEL=1
      CALL RSETI(IRES.NUM,MELEM1.NUM,N1)
      SEGDES IRES,MELEM1
      IRET=IRES
      RETURN
      ELSE
      SEGACT MELEM1,IRES
      NBNN=1
      N1=MELEM1.NUM(/2)
      N2=IRES.NUM(/2)
      NBELEM=N1+N2
      NBSOUS=0
      NBREF=0
      SEGADJ IRES
      CALL RSETI(IRES.NUM(1,N2+1),MELEM1.NUM,N1)
      SEGDES IRES,MELEM1
      IRET=IRES
      RETURN
      ENDIF
      END

