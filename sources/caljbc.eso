C CALJBC    SOURCE    CHAT      05/01/12    21:46:40     5004
      SUBROUTINE CALJBC(FN,GR,PG,XYZ,HR,PGSQ,RPG,NES,IES,NP,NPG,
     *IAXI,AIRE)
C************************************************************************
C
C     CALJBC APPEL CALJ22
C
C            LA DIFFERENCE AVEC CALJAC EST LE RANGEMENT DE HR
C                        HR(IES,NP)
C
C
C     CALCUL DE L'INVERSE DU JACOBIEN  AJ=1/J
C     CALCUL DE L'ELEMENT D'AIRE       SQ=DET(J)
C     DANS LES CAS 1D 2D ET 3D
C
C     NES  DIMENSION ESPACE DE DEFINITION DE L'ELEMENT
C     IES  DIMENSION ESPACE
C     NP   NOMBRE DE NOEUDS DE L'ELEMENT
C     NPG  NOMBRE DE POINTS D'INTEGRATION
C
C     XYZ  COORDONNEES
C     GR   GRADIENT
C
C************************************************************************
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
-INC CCREEL
C
      REAL*8 FN(NP,NPG),GR(NES,NP,NPG),HR(IES,NP,NPG)
      REAL*8 PG(NPG),XYZ(IES,NP),PGSQ(NPG),RPG(NPG)
      REAL*8 AJ(3,3,64)
C
      CALL CALJBR
     &(FN,GR,PG,XYZ,HR,PGSQ,RPG,NES,IES,NP,NPG,IAXI,AIRE,AJ,SGN)
      IF(IAXI.NE.0)THEN
      DEUPI=2.D0*XPI
      DO 1 L=1,NPG
      PGSQ(L)=PGSQ(L)*DEUPI*RPG(L)
 1    CONTINUE
      ENDIF

      RETURN
 1002 FORMAT(10(1X,1PE11.4))
 1001 FORMAT(20(1X,I5))
      END





