C SENSI2    SOURCE    PV        09/03/12    21:34:15     6325
*
*     EXTRAIT DE ADCHAML.ESO
*     LELEU DIDIER HAZE FREDERIC
*     03/03/93
*
*
*
      SUBROUTINE SENSI2(IPCHA2,IPCHA,MOYS)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 MOYS
*
*
*  ENTREES :
*        IPCHA2    : POINTEUR SUR UN SEGMENT MCHAML SUPPOSE ACTIF
*        IPCHA   : POINTEUR SUR 2IEME SEGGMENT MCHAML SUPPOSE ACTIF
*
*
*
*  SORTIE :
*        MOYS     : VALEUR DE LA SENSIBILITE (MOYENNE)
*
*
*
*
-INC SMCHAML
-INC CCOPTIO
*
      MCHAML=IPCHA
      MCHAM2=IPCHA2
*
*     ON CHERCHE LES NOM DE COMPOSANTES EN COMMUN DANS LES
*     2 CHAMELEMS
*
      DO 1 ICOMP=1,IELVAL(/1)
         CALL PLACE (MCHAM2.NOMCHE,MCHAM2.NOMCHE(/2),IPLAC,
     &               NOMCHE(ICOMP))
         IF (IPLAC.NE.0) THEN
            IPMEL1=IELVAL(ICOMP)
            IPMEL2=MCHAM2.IELVAL(IPLAC)
*  ICOD=0
            CALL SENSI3(IPMEL1,IPMEL2,IPMELV,IRETOU,MOYS)
            IF (IRETOU.NE.0) THEN
               IF (IRETOU.EQ.197) MOTERR(1:4)=NOMCHE(ICOMP)
               CALL ERREUR (IRETOU)
               IPCHA=0
               RETURN
            ENDIF
            IELVAL(ICOMP)=IPMELV
         ELSE
            MELVA1=IELVAL(ICOMP)
            SEGINI,MELVAL=MELVA1
            IELVAL(ICOMP)=MELVAL
            SEGDES MELVAL
         ENDIF
 1    CONTINUE
*
*     ON RAJOUTE LES COMPOSANTES DU 2IEME CHAMELEM QUI NE SONT PAS
*     ENCORE PRIS EN COMPTE (LE NUMERO DE LA SOUS ZONE EST DONNE
*     JTAFF(ISOUS1)
*
      N22=IELVAL(/1)
      DO 2 ICOMP=1,MCHAM2.IELVAL(/1)
         CALL PLACE (NOMCHE,N22,IPLAC,
     &               MCHAM2.NOMCHE(ICOMP))
         IF (IPLAC.EQ.0) THEN
            N2=IELVAL(/1)
            N2=N2+1
            SEGADJ MCHAML
            NOMCHE(N2)=MCHAM2.NOMCHE(ICOMP)
            TYPCHE(N2)=MCHAM2.TYPCHE(ICOMP)
            MELVA2=MCHAM2.IELVAL(ICOMP)
            SEGINI,MELVAL=MELVA2
            IELVAL(N2)=MELVAL
            SEGDES MELVAL
         ENDIF
 2    CONTINUE
*
 9990 CONTINUE
      RETURN
      END



