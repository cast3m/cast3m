C MOBFLU    SOURCE    CB215821  16/04/21    21:17:46     8920
C MOBFLU     SOURCE    INSL       24/10/96
      SUBROUTINE MOBFLU(SIGR,STFL,D1,NSTRS,IFLU,RMOY,PHIF,TEMP0,
     & DTEMP,TEMP1,POAR)
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION SIGR(NSTRS),STFL(NSTRS),D1(NSTRS,NSTRS)
C----------------------------------------------------------------------
*
      IF(IFLU.EQ.0) GOTO 10
      IF(IFLU.EQ.10.OR.IFLU.EQ.11.OR.IFLU.EQ.20.OR.IFLU.EQ.21) GOTO 20
      IF(IFLU.EQ.30.OR.IFLU.EQ.31) GOTO 30
*
      WRITE(*,*) '!! ATTENTION CE MODELE DE FLUAGE N EST PAS DISPONIBLE'
      WRITE(*,*) '      (DANS MOBFLU)  IFLU= ',IFLU
      STOP
c+mdj
C      GOTO 100
c+mdj
*
   10 CONTINUE
*
*    CE MATERIAUX NE FLUE PAS
*
        GOTO 100
*
   20 CONTINUE
*
*    MODELE DE FLUAGE BETON : LOI BPEL91
*
*       IFLU = 10 : FLUAGE (BPEL91_K(t)..) +  BETON ELASTIQUE
*       IFLU = 11 : FLUAGE (BPEL91_K(t)..) +  BETON ELASTOPLASTIQUE
*       IFLU = 20 : FLUAGE (BPEL91_K(t)=2) +  BETON ELASTIQUE
*       IFLU = 21 : FLUAGE (BPEL91_K(t)=2) +  BETON ELASTOPLASTIQUE
*
        TEMPF= TEMP0 + DTEMP
        TEMPR= TEMPF - TEMP1
        IF(IFLU.EQ.10.OR.IFLU.EQ.11) THEN
          DKS  = 1.D0/(1.D0+(20.D0*POAR))
          DKE  = 0.4D0
          DKC  = (120.D0-PHIF)/30.D0+.6667D0*(100.D0-PHIF)/(20.D0+RMOY)
          DKT1 = 100.D0/(100.D0+TEMP1)
          FACT = DKS*(DKE+DKC*DKT1)
        ELSE
          FACT = PHIF
        ENDIF
*
        COEF0 = SQRT(TEMPR)
        COEF1 = 5.D0*SQRT(RMOY)
*
*       CALCUL EN DEFORMATION DE FLUAGE TOTALE
*
        COEFT = FACT*COEF0/(COEF0+COEF1)
*
        CALL BST(D1,SIGR,NSTRS,NSTRS,STFL)
        DO 2 I=1,NSTRS
           STFL(I)=COEFT*STFL(I)
   2    CONTINUE
        TEMP0 = TEMPF
        GOTO 100
*
   30 CONTINUE
*
*    MODELE DE FLUAGE BETON :LOI1 ----> EPSfl = A1 * T**A2 * Sig/E
*
*        IFLU = 31 : FLUAGE (LOI1) +  BETON ELASTOPLASTIQUE
*        IFLU = 30 : FLUAGE (LOI1) +  BETON ELASTIQUE
*
        TEMPF = TEMP0 + DTEMP
        COEFT = RMOY*(TEMPF**PHIF)
        CALL BST(D1,SIGR,NSTRS,NSTRS,STFL)
        DO 3 I=1,NSTRS
           STFL(I)=COEFT*STFL(I)
   3    CONTINUE
        TEMP0 = TEMPF
        GOTO 100
C
  100 CONTINUE
C---------------------------------------------------------------------
1991  FORMAT(18(1X,E12.5))
      RETURN
      END




