C TRJCN6    SOURCE    CHAT      05/01/13    03:49:17     5004
      SUBROUTINE TRJCN6(IPTVIT,MELEME,NCC)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                                     A
C         CONTROLE QUE LES DONNEES SERVANT A CALCULER LES VITESSES
C          SONT COHERENTES ( cas transitoire )
C                 CALCUL DES TRAJECTOIRES
C      ENTREES
C          MELEME POINTEUR DU MAILLAGE
C          IPTVIT POINTEUR DE LA TABLE DES VITESSES OU FLUX
C          NCC NOMBRE DE COMPOSANTES ATTENDUES POUR LE CHPOIN
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      CHARACTER*4 NOMTOT
-INC SMELEME
-INC SMTABLE
-INC SMCHPOI
-INC CCOPTIO
       CHARACTER*8 MTYPI,CHARI,MTYPR,CHARR
C
      MTABLE=IPTVIT
      SEGACT MTABLE
      NVIPT= MLOTAB
      SEGACT MELEME

           IVALI=0
           XVALI=0.D0
           IRETI=0
           IVALR=0
           XVALR=0.D0
           MTYPI='ENTIER'
           CHARI='        '
           CHARR='        '
           MTYPR='CHPOINT'
           CALL ACCTAB(MTABLE,MTYPI,IVALI,XVALI,CHARI,.TRUE.,
     *      IRETI,MTYPR,IVALR,XVALR,CHARR,.TRUE.,IRETR)
           MCHPO1=IRETR
           SEGACT MCHPO1
      NBCOMP=-1
      NOMTOT='    '
      INDIC=0
      CALL QUEPOI(MCHPO1,MELEME,INDIC,NBCOMP,NOMTOT)
      IF(INDIC.LT.0)THEN
          CALL ERREUR(21)
          RETURN
      ENDIF
      SEGACT MCHPO1
      MSOUPO=MCHPO1.IPCHP(1)
      SEGACT MSOUPO
      MPOVAL=IPOVAL
      SEGACT MPOVAL
      NC=VPOCHA(/2)
      IF(NC.NE.NCC)THEN
            MOTERR(1:8)='TRJCN3  '
            CALL ERREUR(178)
            RETURN
      ENDIF
      IGEOC1= IGEOC
      SEGDES MPOVAL,MSOUPO,MCHPO1
      DO 10 IVPT=2,NVIPT
           IVALI=IVPT-1
           XVALI=0.D0
           IRETI=0
           IVALR=0
           XVALR=0.D0
           MTYPI='ENTIER'
           CHARI='        '
           CHARR='        '
           MTYPR='CHPOINT'
           CALL ACCTAB(MTABLE,MTYPI,IVALI,XVALI,CHARI,.TRUE.,
     *      IRETI,MTYPR,IVALR,XVALR,CHARR,.TRUE.,IRETR)
           MCHPO2=IRETR
           SEGACT MCHPO2
C
      NBCOMP=-1
      NOMTOT='    '
      INDIC=1
      CALL QUEPOI(MCHPO2,IGEOC1,INDIC,NBCOMP,NOMTOT)
      IF(INDIC.LT.0)THEN
          CALL ERREUR(21)
          RETURN
      ENDIF
      SEGACT MCHPO2
      MSOUPO=MCHPO2.IPCHP(1)
      SEGACT MSOUPO
      IF (IGEOC.NE.IGEOC1)THEN
          CALL ERREUR(348)
          RETURN
      ENDIF
      SEGDES MSOUPO,MCHPO2
   10 CONTINUE
C     SEGDES MELEME
      RETURN
      END


