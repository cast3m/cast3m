C FOFREN    SOURCE    CHAT      05/01/13    00:05:59     5004
      SUBROUTINE FOFREN
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
C
C  OPERATEUR FONC
C  CAS 'FRESNEL'
C
      CHARACTER*40  CHA1
C
-INC CCOPTIO
-INC SMLREEL
C
C
C
      CALL LIRCHA (CHA1,1,IRETOU)
      IF (IERR.NE.0) RETURN
      CALL LIROBJ ('LISTREEL',MLREEL,1,IRETOU)
      IF (IERR.NE.0) RETURN
C
C
      SEGACT MLREEL
      JG  = PROG(/1)
      SEGINI MLREE1
      SEGINI MLREE2
C
C
C
        CALL FRESNE(MLREE1.PROG,MLREE2.PROG,PROG,JG)
C
      IF (CHA1(1:2).EQ.'CX') THEN
        CALL ECROBJ ('LISTREEL',MLREE1)
        IF (IERR.EQ.0) RETURN
      ELSEIF (CHA1(1:2).EQ.'SX') THEN
        CALL ECROBJ ('LISTREEL',MLREE2)
        IF (IERR.EQ.0) RETURN
      ENDIF
C
      RETURN
      END

