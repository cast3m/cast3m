C EXTRLI    SOURCE    BP208322  16/11/18    21:17:00     9177
C    CE SOUS PROGRAMME SERT A EXTRAIRE UNE LIGNE REFERENCEE D'UN OBJET
C    SURFACE
C
      SUBROUTINE EXTRLI(IPOS,INUM,IRET,ISENS)
C  IPOS   NUMERO DANS LA PILE D'OBJETS
C  INUM   ON VEUT LE INUMEIEME COTE
C  IRET   C'EST IRET
C  ISENS  ON LE VEUT TELQUEL OU INVERSE
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMELEME
-INC CCGEOME
      IPT1=IPOS
      SEGACT IPT1
      IF (IPT1.LISOUS(/1).NE.0) CALL ERREUR(25)
      IF (IERR.NE.0) RETURN
      IF (KSURF(IPT1.ITYPEL).NE.0) GOTO 1
      IRET=IPT1
      SEGDES IPT1
      RETURN
   1  IF (IPT1.LISREF(/1).NE.4) CALL ERREUR(24)
      IF (IERR.NE.0) RETURN
      IRET=IPT1.LISREF(INUM)
C  FAUT IL INVERSER LA LIGNE
      SEGDES IPT1
      IPT1=IRET
      SEGACT IPT1
      IRET=IPT1
      IF (ISENS.EQ.1) RETURN
      SEGACT IPT1
      CALL INVERS(IPT1,IRET)
      SEGDES IPT1
      RETURN
      END









