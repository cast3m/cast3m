C ERREU1    SOURCE    GF238795  17/11/17    21:15:13     9626
C
C   RECHERCHE DES MESSAGES D'ERREURS (SUITE)
C
      SUBROUTINE ERREU1(ITYP,CHLU,NIVEAU,NBL)
      IMPLICIT INTEGER(I-N)
-INC CCNOYAU
-INC CCOPTIO
      CHARACTER*(*) CHLU(2)
C      CHARACTER*4  CHTYP
C      CHARACTER*87 CHTAMP
C RECHERCHE DE LA LANGUE
      DO 156 IK=1,LANGUA(/2)
       IF( LANGUE.EQ.LANGUA(IK)) THEN
           ILAN=IK
           GO TO 157
        ENDIF
  156 CONTINUE
      ILAN=1
C      WRITE (IOIMP,158)
C 158  FORMAT (' ERREUR DE LANGUE DU MESSAGE D''ERREUR')
C      NBL=0
C      NIVEAU=2
C      RETURN
 157  CONTINUE
C  RECHERCHE DE L'ERREUR
      DO 10 I=1,IPMESS(/1)
       IF (NUMERR(I).EQ.ITYP) GOTO 20
  10  CONTINUE
      WRITE (IOIMP,12)
  12  FORMAT (' ERREUR DANS LA RECHERCHE DU MESSAGE D''ERREUR')
      NBL=0
      NIVEAU=2
      RETURN
  20  CONTINUE
      NIVEAU=NIVERR(I)
      MCHERR=IPMESS(I,ILAN)
C      SEGACT MCHERR
      CHLU(1)=CHERR1
      IF (CHERR2(/1).EQ.0) THEN
        NBL=1
        CHLU(2)=' '
      ELSE
        NBL=2
        CHLU(2)=CHERR2
      ENDIF
C      SEGDES MCHERR
      END




