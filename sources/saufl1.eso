C SAUFL1    SOURCE    AM        09/12/08    21:15:23     6582
      SUBROUTINE SAUFL1(VARF,NVARI,CMAT,NMAT,SIGF,
     $        SIGEF,NSTRS,IFOUR,EPSFLU,AN,BN,CN,KERRE)
C
C ROUTINE APPELE DANS CAMECA
C_______________________________________________________________________
C
C SOUS PROGRAMME QUI CALCUL LA DEFORMATION
C DE FLUAGE PROPRE A LA FIN DU PAS DE TEMPS
C_______________________________________________________________________
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION VARF(NVARI),CMAT(NMAT),SIGF(NSTRS),SIGEF(NSTRS)
      DIMENSION EPSFLU(NSTRS)
      DIMENSION AN(NSTRS),BN(NSTRS,NSTRS),CN(NSTRS,NSTRS)
      DIMENSION EPSFL1(10),EPSFL2(10),EPSFL3(10)
      DIMENSION EPSFL4(10),EPSFL5(10),EPSFL6(10)
      DIMENSION EPSFLA(10),EPSFLD(10)
      DIMENSION SIGFI(10)
C
C  TEST DE LA DIMENSION
C
      NDI=10
      IF(NSTRS.GT.NDI) THEN
        PRINT *, '  SAUFL1  - DIMENSION INSUFFISANTE '
        KERRE = 99
        RETURN
      ENDIF

C
C CALCUL DES DEFORMATIONS DE FLUAGE
C   POUR LES 6 CHAINES DE KELVIN VOIGT
C
C   Chaine 1
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,1,EPSFL1,AN,BN,CN)
C
C   Chaine 2
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,2,EPSFL2,AN,BN,CN)
C
C   Chaine 3
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,3,EPSFL3,AN,BN,CN)
C
C   Chaine 4
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT ,SIGF,
     $     SIGEF,NSTRS,IFOUR,4,EPSFL4,AN,BN,CN)
C
C   Chaine 5
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,5,EPSFL5,AN,BN,CN)
C
C   Chaine 6
C
      CALL SAUFLD(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,6,EPSFL6,AN,BN,CN)
C
C   Amortisseur
C
      CALL SAUFLA(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,EPSFLA,AN,BN,CN,SIGFI)
C
C   FLUAGE DESSICCATION
C
      CALL SAUFL2(VARF,NVARI,CMAT,NMAT,SIGF,
     $     SIGEF,NSTRS,IFOUR,EPSFLD,AN,BN,CN,SIGFI)
C
C CALCUL DEFORMATION FLUAGE
C
      DO 10 I=1,NSTRS
        EPSFLU(I) = EPSFL1(I) + EPSFL2(I) + EPSFL3(I)
     $              + EPSFL4(I) + EPSFL5(I) + EPSFL6(I)
     $              + EPSFLA(I) + EPSFLD(I)
   10   CONTINUE
C
      END


