C LFNOMS    SOURCE    JC220346  18/12/04    21:15:33     9991
      SUBROUTINE LFNOMS(NBAND,LMAX,ITAB,IRETOU,IFORM)
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC CCNOYAU
-INC CCFXDR
      CHARACTER*(LONOM) ITAB(*)
      IRETOU=0
      IF (LMAX.EQ.0) GOTO 15
      IF (IONIVE.LE.2) THEN
        IF (IFORM.EQ.0) READ(NBAND,END=10,ERR=10)(ITAB(I),I=1,LMAX)
        IF (IFORM.EQ.1) READ(NBAND,801,END=10,ERR=10)(ITAB(I),I=1,LMAX)
 801    FORMAT(16(1X,A4))
        if (iform.eq.2) ios=IXDRSTRING( ixdrr, itab(1)(1:8*lmax))
      ELSEIF (IONIVE.LE.21) THEN
        IF (IFORM.EQ.0) READ(NBAND,END=10,ERR=10)(ITAB(I),I=1,LMAX)
        IF (IFORM.EQ.1) READ(NBAND,8001,END=10,ERR=10)(ITAB(I),I=1,LMAX)
 8001   FORMAT(8(1X,A8))
        if (iform.eq.2) ios=IXDRSTRING( ixdrr, itab(1)(1:8*lmax))
      ELSE
        IF (IFORM.EQ.0) READ(NBAND,END=10,ERR=10)(ITAB(I),I=1,LMAX)
        IF (IFORM.EQ.1) READ(NBAND,8002,END=10,ERR=10)(ITAB(I),I=1,LMAX)
 8002   FORMAT(3(1X,A24))
        if (iform.eq.2) ios=IXDRSTRING( ixdrr, itab(1)(1:LONOM*lmax))
      ENDIF
      IF (IONIVE.LE.21.AND.IFORM.EQ.2) THEN
        DO K=LMAX,1,-1
          ITAB(K)(1:LONOM)=ITAB(1)(8*K-7:8*K)
        ENDDO
      ENDIF
 15   RETURN
 10   IRETOU=1
      RETURN
      END




