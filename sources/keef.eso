C KEEF      SOURCE    BP208322  16/11/18    21:18:07     9177
      SUBROUTINE KEEF(ITYPL,NMFAL,
     $     MYFALS,
     $     MYLRF,
     $     IMPR,IRET)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER (I-N)
C***********************************************************************
C NOM         : KEEF
C PROJET      : Noyau linéaire NLIN
C DESCRIPTION : On donne un numéro de type d'élément géométrique (un
C               QUAF, donc), un nom de famille d'éléments finis.
C               En sortie, on a le pointeur sur l'élément fini (type
C               ELREF)
C
C               MYFALS et MYLRFS sont des données de type COMMON
C               décrivant toutes les familles d'éléments finis et tous
C               les éléments finis...
C
C LANGAGE     : ESOPE
C AUTEUR      : Stéphane GOUNAND (CEA/DRN/DMT/SEMT/LTMF)
C               mél : gounand@semt2.smts.cea.fr
C***********************************************************************
C APPELES          : FIFAL, FIENTI (recherche dans une liste)
C APPELE PAR       : VERFAM, MKCOOR, KECOMP
C***********************************************************************
C ENTREES            : * ITYPL  (type entier) : numéro d'élément
C                        géométrique (cf. tableau NOMS dans l'include
C                        CCOPTIO).
C                      * NMFAL  (type CH*(*)) : nom de famille
C                        d'éléments finis (cf. NOMFA dans l'include
C                        SFALRF).
C                      * MYFALS (type FALRFS) : segment de description
C                        des familles d'éléments de références.
C SORTIES            : * MYLRF  (type ELREF)  : pointeur sur l'élément
C                        fini correspondant à l'élément géométrique de
C                        numéro ITYPL dans la famille de nom NMFAL
C CODE RETOUR (IRET) : = 0 si tout s'est bien passé
C***********************************************************************
C VERSION    : v1, 13/09/99, version initiale
C HISTORIQUE : v1, 13/09/99, création
C HISTORIQUE :
C HISTORIQUE :
C***********************************************************************
C Prière de PRENDRE LE TEMPS de compléter les commentaires
C en cas de modification de ce sous-programme afin de faciliter
C la maintenance !
C***********************************************************************
-INC CCOPTIO
-INC CCGEOME
*
* Includes perso
*
CBEGININCLUDE SFALRF
      SEGMENT FALRF
      CHARACTER*(LNNFA) NOMFA
      INTEGER NUQUAF(NBLRF)
      POINTEUR ELEMF(NBLRF).ELREF
      ENDSEGMENT
      SEGMENT FALRFS
      POINTEUR LISFA(0).FALRF
      ENDSEGMENT
CENDINCLUDE SFALRF
      POINTEUR MYFALS.FALRFS
      POINTEUR MYFAL.FALRF
CBEGININCLUDE SELREF
      SEGMENT ELREF
      CHARACTER*(LNNOM)  NOMLRF
      CHARACTER*(LNFORM) FORME
      CHARACTER*(LNTYPL) TYPEL
      CHARACTER*(LNESP)  ESPACE
      INTEGER DEGRE
      REAL*8 XCONOD(NDIMEL,NBNOD)
      INTEGER NPQUAF(NBDDL)
      INTEGER NUMCMP(NBDDL)
      INTEGER QUENOD(NBDDL)
      INTEGER ORDDER(NDIMEL,NBDDL)
      POINTEUR MBPOLY.POLYNS
      ENDSEGMENT
      SEGMENT ELREFS
      POINTEUR LISEL(0).ELREF
      ENDSEGMENT
CENDINCLUDE SELREF
      POINTEUR MYLRF.ELREF
*
      INTEGER ITYPL
      CHARACTER*(*) NMFAL
      INTEGER IBLRF,NBLRF
      INTEGER IMPR,IRET
*
* Executable statements
*
      IF (IMPR.GT.6) WRITE(IOIMP,*) 'Entrée dans keef'
      CALL FIFAL(NMFAL,MYFALS,
     $     MYFAL,
     $     IMPR,IRET)
      IF (IRET.NE.0) GOTO 9999
      SEGACT MYFAL
      NBLRF=MYFAL.NUQUAF(/1)
      CALL FIENTI(ITYPL,MYFAL.NUQUAF,NBLRF,
     $     IBLRF,
     $     IMPR,IRET)
      IF (IRET.NE.0) THEN
         WRITE(IOIMP,*) 'On n''a pas trouvé ',NOMS(ITYPL),
     $        ' dans la famille d''éléments finis ',MYFAL.NOMFA
         GOTO 9999
      ENDIF
      MYLRF=MYFAL.ELEMF(IBLRF)
      SEGDES MYFAL
*
* Normal termination
*
      IRET=0
      RETURN
*
* Format handling
*
*
* Error handling
*
 9999 CONTINUE
      IRET=1
      WRITE(IOIMP,*) 'An error was detected in subroutine keef'
      RETURN
*
* End of subroutine KEEF
*
      END





