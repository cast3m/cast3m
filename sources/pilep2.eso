C PILEP2    SOURCE    PV        09/03/12    21:30:10     6325
       SUBROUTINE PILEP2(IELVA1,IELVA2,XX,IRET,CRIT)
*
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
*
-INC CCOPTIO
-INC SMCHAML
-INC SMLREEL
-INC SMCOORD
*
      IRET=0
      MELVA1=IELVA1
      MELVA2=IELVA2
      SEGACT MELVA1
      SEGACT MELVA2
*
      NBP1=MELVA1.VELCHE(/1)
      IF (NBP1.EQ.0) THEN
        IRET = 197
      ELSE
         NBP2=MELVA2.VELCHE(/1)
         NEL1=MELVA1.VELCHE(/2)
         NEL2=MELVA2.VELCHE(/2)
         N1PTEL=MAX(NBP1,NBP2)
         N1EL  =MAX(NEL1,NEL2)
         N2PTEL=0
         N2EL  =0
         DO 5 IGAU=1,N1PTEL
            IGMN1=MIN(IGAU,MELVA1.VELCHE(/1))
            IGMN2=MIN(IGAU,MELVA2.VELCHE(/1))
            XLA = 1.E30
            DO 5 IB=1,N1EL
*
               IBMN1=MIN(IB  ,MELVA1.VELCHE(/2))
               IBMN2=MIN(IB  ,MELVA2.VELCHE(/2))
*
        IF ( MELVA2.VELCHE(IGMN2,IBMN2) . NE . 0.)
     *  XLA =(SIGN(CRIT,MELVA2.VELCHE(IGMN2,IBMN2))
     *          - MELVA1.VELCHE(IGMN1,IBMN1))/
     *                        MELVA2.VELCHE(IGMN2,IBMN2)
         IF( XLA . LE . XX ) XX = XLA
*
  5      CONTINUE
      ENDIF
      SEGDES MELVA1
      SEGDES MELVA2
*
      RETURN
      END



