C TBDELC    SOURCE    CHAT      05/01/13    03:32:44     5004
c subroutine utilisee dans tableau
***************************************************
*
*  SUPPRIMER UNE COLONNE DANS UN TABLEAU
*
***************************************************
        SUBROUTINE TBDELC (ICOL,NBPX,NBPY,TABTR,ITABX,ITABY)

*
*  DEFINITION DES VARIABLES
*
      IMPLICIT INTEGER(I-N)
-INC TMNTAB
-INC CCOPTIO
        INTEGER         ICOL,NBPX,NBPY,ITABX,ITABY
        INTEGER         IX,IY,PAGESX,PAGESY
*
        IF  (ICOL.LT.1) RETURN
        IF  (ICOL.GT.ITABX) RETURN
        IF  (ITABX.EQ.1) RETURN
        DO 100 IX=ICOL , ITABX-1
          TABTR.YTYPE    (IX) = TABTR.YTYPE    (IX+1)
          TABTR.TITCOL (IX) = TABTR.TITCOL (IX+1)
          DO 50 IY=1 , ITABY
            TABTR.ELEM    (IX,IY) = TABTR.ELEM    (IX+1,IY)
            TABTR.ZVSEP   (IX,IY) = TABTR.ZVSEP   (IX+1,IY)
            TABTR.ZHSEP   (IX,IY) = TABTR.ZHSEP   (IX+1,IY)
            TABTR.ZGVSEP (IX,IY) = TABTR.ZGVSEP (IX+1,IY)
            TABTR.ZGHSEP (IX,IY) = TABTR.ZGHSEP (IX+1,IY)
50        CONTINUE
          TABTR.ZVSEP   (IX,ITABY+1) = TABTR.ZVSEP   (IX+1,ITABY+1)
          TABTR.ZHSEP   (IX,ITABY+1) = TABTR.ZHSEP   (IX+1,ITABY+1)
          TABTR.ZGVSEP (IX,ITABY+1) = TABTR.ZGVSEP (IX+1,ITABY+1)
          TABTR.ZGHSEP (IX,ITABY+1) = TABTR.ZGHSEP (IX+1,ITABY+1)
100     CONTINUE
        ITABX=ITABX-1
*
* CALCUL DU NOMBRE DE PAGES MAXI
*
        PAGESX =  (ITABX-2) / 4 + 1
        PAGESY =  (ITABY-2) / 20 + 1
*
*  AJUSTEMENT DU TABLEAU
        SEGADJ TABTR
*
        IF  (ZHORIZ) THEN
        CALL TBPAYS (NBPX,NBPY,TABTR,ITABX,ITABY)
        ELSE
        CALL TBPORT (NBPX,NBPY,TABTR,ITABX,ITABY)
        ENDIF
*
        END



