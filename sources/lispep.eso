C LISPEP    SOURCE    CHAT      05/01/13    01:22:41     5004
      SUBROUTINE LISPEP(XE,CAR,XDDL,XEL,BPSS,XDDLOC,NPOINT,EPS)
C=======================================================================
C
C  ENTREES
C    XE(3,4)     = COORDONNEES DE LA POUTRE LINESPRING
C    CAR         = STOCKE LES CARACTERISTIQUES
C                  CAR(3,4,5)  = VECTEUR ORIENTANT LES NOEUDS 1 4
C                  CAR(8,9,10) = VECTEUR ORIENTANT LES NOEUDS 2 3
C    XDDL(24)    = D.D.L. DU LINESPRING
C    NPOINT      = NOMBRE DE POINTS DE CONTRAINTES
C  TABLEAU DE TRAVAIL
C    XEL(3,3)    = COORDONNEES LOCALES
C    BPSS(3,3)   = MATRICE DE PASSAGE
C    XDDLOC(24)  = D.D.L. LOCAUX
C  SORTIES
C    EPS(NPOINT*6)= CONTRAINTES LINESPRING
C=======================================================================
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      PARAMETER(XZER=0.D0,UNDEMI=.5D0)
      PARAMETER(X774=.774596669241483D0)
C
      DIMENSION XE(3,*),EPS(*),V1(3),V2(3),BPSS(3,*),XEL(3,*)
      DIMENSION S(3),XDDL(*),XDDLOC(*),CAR(*)
C
      V1(1)=CAR(3)
      V1(2)=CAR(4)
      V1(3)=CAR(5)
      V2(1)=CAR(8)
      V2(2)=CAR(9)
      V2(3)=CAR(10)
C
      IF(NPOINT.EQ.1) THEN
      S(1)= XZER
      ELSE IF(NPOINT.EQ.3) THEN
      S(1)=-X774
      S(2)= XZER
      S(3)= X774
      ENDIF
C
      NPOIN6=6*NPOINT
C
C     MISE A ZERO DES DEFORMATIONS  DES INDICATEURS D ERREURS ET DES D.D.
C
      DO  90 IA=1,NPOIN6
      EPS(IA)=XZER
   90 CONTINUE
C
C
C     EXTRACTION DE LA MATRICE DE PASSAGE
C
      DO 100 IA=1,3
      XEL(IA,1)=XE(IA,1)
      XEL(IA,2)=XE(IA,2)
      XEL(IA,3)=XE(IA,1)+(V1(IA)+V2(IA))*UNDEMI
 100  CONTINUE
      CALL VPAST(XEL,BPSS)
      CALL MATVEC(XDDL,XDDLOC,BPSS,8)
C
C     BOUCLE SUR LES POINTS
C
      DO 200 IA=1,NPOINT
      H1=UNDEMI-UNDEMI*S(IA)
      H2=UNDEMI+UNDEMI*S(IA)
C
C     REMPLISSAGE DES DEFORMATIONS
C
      EPXZ =(XDDLOC(1 )-XDDLOC(19))*H1+(XDDLOC(7 )-XDDLOC(13))*H2
      EPYZ =(XDDLOC(2 )-XDDLOC(20))*H1+(XDDLOC(8 )-XDDLOC(14))*H2
      DD   =(XDDLOC(3 )-XDDLOC(21))*H1+(XDDLOC(9 )-XDDLOC(15))*H2
      RT   =(XDDLOC(4 )-XDDLOC(22))*H1+(XDDLOC(10)-XDDLOC(16))*H2
      RTZZ =(XDDLOC(6 )-XDDLOC(24))*H1+(XDDLOC(12)-XDDLOC(18))*H2
      IX=6*(IA-1)
      EPS(IX+1)=DD
      EPS(IX+2)=EPXZ
      EPS(IX+3)=EPYZ
      EPS(IX+4)=RT
      EPS(IX+5)=RTZZ
  200 CONTINUE
*
      RETURN
      END

