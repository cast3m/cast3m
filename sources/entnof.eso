C ENTNOF    SOURCE    CHAT      05/01/12    23:40:30     5004
      SUBROUTINE ENTNOF(IBAND,NOBJN,NOMM1,NOMM2,IRETOU)
C
C     LECTURE DES OBJETS NOMMES. IL Y EN A NOBJN
C     LECTURE SUR L'UNITE IBAND
C     NOMM1 SEGMENT QUI CONTIENT LES NUMEROS DES OBJETS DS LEUR PILE
C     NOMM2 SEGMENT QUI CONTIENT LE NOM DE CES OBJETS
C     IRETOU =0 SI TOUT S'EST BIEN PASSE. IRETOU=1 SINON.
C     APPELE PAR RESTSO
C     ECRIT PAR FARVACQUE
C
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
      SEGMENT/NOMM1/(NOM1(NOBJN1))
      SEGMENT/NOMM2/(NOM2(NOBJN2))
      ITOTO=1
      IRETOU=0
      NOBJN1=NOBJN
      NOBJN2=2*NOBJN
      SEGADJ NOMM1
      SEGADJ NOMM2
      CALL LFCDIM(IBAND,NOBJN2,NOM2,IRETOU,ITOTO)
      IF(IRETOU.NE.0)RETURN
      READ(IBAND,708,END=4,ERR=4)(NOM1(I),I=1,NOBJN1)
  708 FORMAT(20I4)
C     CALL LFCDIE(IBAND,NOBJN1,NOM1,IRETOU,ITOTO)
C     IF(IRETOU.NE.0) RETURN
      IF(IIMPI.NE.5) GOTO 1
      WRITE(IOIMP,101)
      DO 2 I=1,NOBJN
      WRITE(IOIMP,100) NOM2(2*I-1),NOM2(2*I),NOM1(I)
   2  CONTINUE
      GOTO 1
 4    IRETOU=1
   1  CONTINUE
 100  FORMAT(2X,2A4,2X,I6)
 101  FORMAT('  OBJETS NOMMES ET LEUR RANG DANS LA PILE   :  ')
      RETURN
      END

