C LISPRI    SOURCE    CHAT      05/01/13    01:23:38     5004
C    RAIDEUR LINESPRING
      SUBROUTINE LISPRI(XE,CAR,D,WORK,MELE,REL,I70,I195,I157,I158)
C=======================================================================
C
C     CALCULE LA MATRICE DE RIGIDITE DU LINE SPRING
C
C  ENTREES
C     XE (3,4)=COORDONNES DE LA POUTRE  LINE SPRING
C     EPA1 =EPAISSEUR  NOEUDS 1 ,4    CAR(1)
C     FISS1=PROFONDEUR NOEUDS 1 ,4    CAR(2)
C     V1(3)=VECTEUR ORIENTANT LES NOEUDS 1 ,4 CAR(3,4,5)
C     EPA2 =EPAISSEUR  NOEUDS 1 ,4    CAR(6)
C     FISS2=PROFONDEUR NOEUDS 1 ,4    CAR(7)
C     V2(3)=VECTEUR ORIENTANT LES NOEUDS 1 ,4 CAR(8,9,10)
C     D(2,2)  =MATRICE DE HOOKE
C     WORK(90)=TABLEAU DE TRAVAIL
C     MELE    = 30 OU 50 NUMERO DE L ELEMENT LINESPRING
C  SORTIES
C     REL(24,24)=MATRICE DE RIGIDITE
C     I70,I195,I157,I158   MESSAGE D ERREURS
C
C     CODE EBERSOLT OCTOBRE 84
C
C=======================================================================
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION XE(3,*),CAR(*),D(2,*),WORK(*),REL(24,*)
      DIMENSION V1(3),V2(3)
      EPA1 =CAR(1)
      FIS1 =CAR(2)
      V1(1)=CAR(3)
      V1(2)=CAR(4)
      V1(3)=CAR(5)
      EPA2 =CAR(6)
      FIS2 =CAR(7)
      V2(1)=CAR(8)
      V2(2)=CAR(9)
      V2(3)=CAR(10)
C
      IF(MELE.EQ.30) THEN
      CALL LISPR2(XE,EPA1,FIS1,V1,EPA2,FIS2,V2,D,
     1  WORK(1),WORK(10),REL,I70,I195,I157,I158)
      ENDIF
C
      IF(MELE.EQ.50) THEN
      CALL LISPR3(XE,EPA1,FIS1,V1,EPA2,FIS2,V2,D,
     1  WORK(1),WORK(10),REL,I70,I195,I157,I158)
      ENDIF
C
      RETURN
      END

