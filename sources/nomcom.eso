C NOMCOM    SOURCE    FANDEUR   11/07/19    21:16:51     7039

C=======================================================================
C
C     NOMME UN CHPOINT A UNE COMPOSANTE
C
C  ENTREE
C     IPCH1=POINTEUR SUR UN CHPOINT
C     MOT  =NOM DE LA COMPOSANTE
C  SORTIE
C     IPCH2=POINTEUR SUR LE CHPOINT RENOMME (0 EN CAS D'ERREUR)
C     IRET =1   SI SUCCES
C          =0   SINON  ( MESSAGE D ERREUR IMPRIME  DANS CE  CAS )
C
C     DECEMBRE 84    EBERSOLT
C=======================================================================

      SUBROUTINE NOMCOM(IPCH1,MOT,IPCH2,IRET)

      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)

-INC CCOPTIO
-INC SMCHPOI

      CHARACTER*(*) MOT
*
      IRET = 0
      MCHPO1 = IPCH1
      SEGINI,MCHPOI=MCHPO1
*
*  VERIFICATION CHAMP NON VIDE A UNE PARTITION
      IF (IPCHP(/1).NE.1) THEN
        CALL ERREUR(180)
        GOTO 666
      ENDIF
*
      MSOUP1 = IPCHP(1)
      SEGINI,MSOUPO=MSOUP1
      IPCHP(1) = MSOUPO
*
*  VERFICATION SUR LA PRESENCE D'UNE SEULE COMPOSANTE
      IF (NOCOMP(/2).NE.1) THEN
        SEGSUP,MSOUPO
        CALL ERREUR(180)
        GOTO 666
      ENDIF
*
      NOCOMP(1) = MOT
*
      MPOVA1 = IPOVAL
      SEGINI,MPOVAL=MPOVA1
      IPOVAL = MPOVAL
*
      SEGDES,MPOVAL,MSOUPO
      IRET = 1

 666  CONTINUE
      IF (IRET.NE.0) THEN
        SEGDES,MCHPOI
        IPCH2 = MCHPOI
      ELSE
        SEGSUP,MCHPOI
        IPCH2 = 0
      ENDIF

      RETURN
      END


