C FNOMOB    SOURCE    JC220346  18/12/04    21:15:26     9991
      SUBROUTINE FNOMOB (ITITI,ITLACC,ISGTR,CTYP,ILISNB)
C=======================================================================
C        A PARTIR D UNE TABLE DES OBJETS DU  TYPE DONNE
C      1-ON APPELLE SNOM2 POUR TESTER SI LE POINTEUR EST DANS LA PILE
C        ITLACC
C      2-SI OUI, ON CHERCHE S IL EST DEJA DANS ISGTR ASSOCIE
C      3-SI NON,ON AJOUTE NOM-NOM-INDICE  DANS ISGTR ASSOCIE
C
C    APPELE PAR : FILLNO HATRIG HATSTR
C    APPELE     : SNOM1
C               : SNOM2
C ---ATTENTION ---------1 TABLE EST DEFINIE PAR 6 VALEURS----------
C               SI LA TABLE  CHANGE, IL FAUT CHANGER LA VALEUR DU PAS
C               DANS LA BOUCLE (6)
C=======================================================================
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC CCNOYAU
-INC TMCOLAC
      SEGMENT ILISNB
        INTEGER   ILISOB(MLON)
        CHARACTER*(LONOM) ILISNO(MLON)
      ENDSEGMENT
      CHARACTER*(*) CTYP
      CHARACTER*(LONOM) CNOM
      EXTERNAL LONG
C
      ITITI=0
      CALL LISTNO(CTYP,ITITI,ILISNB)
C
      IF (ITITI.EQ.0) GO TO  1
      DO 2   I=1,ITITI
          IP1=ILISOB(I)
      CALL SNOM2(IP1,ITLACC,K)
      IF (K.EQ.0) GO TO 2
      CNOM=ILISNO(I)
      IF (IONIVE.LT.22.AND.LONG(CNOM).GT.8) THEN
C       AVERTISSEMENT SI UN NOM DE VARIABLE EST TRONQUE A 8 CARACTERES
        MOTERR(1:24)=CNOM(1:24)
        MOTERR(25:32)=CNOM(1:8)
        CALL ERREUR(-360)
      ENDIF
      CALL SNOM1(CNOM,ISGTR,IRET)
      IF (IRET.GT.0) THEN
         ISGTRI(IRET)=K
      ELSE
         KS=ISGTRI(/1)+1
         SEGADJ ISGTR
         ISGTRC(KS)=CNOM
         ISGTRI(KS)=K
      ENDIF
 2    CONTINUE
   1  RETURN
      END









