C NORMAX    SOURCE    CHAT      05/01/13    02:00:14     5004
      SUBROUTINE NORMAX
************************************************************************
*
*                             N O R M A X
*                             -----------
*
*            SOUS-PROGRAMME ASSOCIE A L'OPERATEUR "MAX1"
*
* FONCTION:
* ---------
*
*     NORMER UN OBJET EN LE DIVISANT PAR SA PLUS GRANDE VALEUR (DE
*     TELLE SORTE QUE SON PLUS GRAND TERME DEVIENNE 1).
*
* PHRASE D'APPEL (EN GIBIANE):
* ----------------------------
*
*                           |(AVEC)|
*     OBJET2 = MAX1 OBJET1 (|      | COMPOS ) ;
*                           | SANS |
*
*     LES PARENTHESES INDIQUANT DES ARGUMENTS FACULTATIFS.
*
* ARGUMENTS (EN GIBIANE):
* -----------------------
*
*     OBJET1    TYPE_1      OBJET QUE L'ON NORME.
*     OBJET2    TYPE_1      OBJET NORME ISSU DE "OBJET1".
*     AVEC      'MOT     '  MOT-CLE INDIQUANT QUE L'ON REGARDE
*                           UNIQUEMENT,DANS LA RECHERCHE DU MAXIMUM,
*                           LES VALEURS ASSOCIEES AUX COMPOSANTES CITEES
*                           DANS "COMPOS".
*                           C'EST L'OPTION PAR DEFAUT.
*     SANS      'MOT     '  MOT-CLE INDIQUANT QUE L'ON EXCLUT, DANS LA
*                           RECHERCHE DU MAXIMUM, LES VALEURS ASSOCIEES
*                           AUX COMPOSANTES CITEES DANS "COMPOS".
*     COMPOS    'LISTMOTS'  LISTE DES NOMS DES COMPOSANTES COMPRISES
*                           OU EXCLUES.
*
*     LES VALEURS POSSIBLES DE "TYPE_1" SONT:
*     - 'CHPOINT' (LES COMPOSANTES SONT ALORS UX, UY, UZ, LX, ...),
*     - ... (A COMPLETER AU FUR ET A MESURE)
*
* DICTIONNAIRE DES VARIABLES: (ORDRE ALPHABETIQUE)
* ---------------------------
*
*     IPOIN2  ENTIER    POINTEUR DE L'OBJET NORME "OBJET2".
*     IPLMOT  ENTIER    POINTEUR DE L'OBJET "COMPOS".
*     IPOINT  ENTIER    POINTEUR DE L'OBJET "OBJET1".
*     IPOS    ENTIER    NUMERO D'ORDRE DU TYPE DE L'OBJET "OBJET1" DANS
*                       LA LISTE CONTENUE DANS "LISTYP".
*     LISTYP  ENTIER    CONTIENT LES NOMS DES DIFFERENTS TYPES D'OBJET
*                       DONT ON PEUT RECHERCHER LA PLUS GRANDE VALEUR.
*     MOTCLE  CHARACTER CONTIENT LA CHAINE DE CARACTERES 'AVEC' OU
*                       'SANS'.
*     NBTYPE  ENTIER    NOMBRE DE NOMS DANS "LISTYP".
*
* MODE DE FONCTIONNEMENT:
* -----------------------
*
*     APPEL D'UN SOUS-PROGRAMME DISTINCT SELON LE TYPE DE L'OBJET
*     "OBJET1".
*
* SOUS-PROGRAMMES APPELES:
* ------------------------
*
*     LIROBJ, LIRTYP, ECROBJ, NORMA1
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     PASCAL MANIGOT    5 NOVEMBRE 1984
*
* LANGAGE:
* --------
*
*     FORTRAN77 + EXTENSION: CARACTERES MIS DANS DES ENTIERS
*
************************************************************************
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
*
      PARAMETER (NBTYPE = 1)
*
      CHARACTER*8 LISTYP(NBTYPE)
*
      CHARACTER*(4) MOTCLE
*
      DATA LISTYP/'CHPOINT '/
*
*     -- LECTURE DU MOT-CLE --
*
      ICODE = 0
      CALL LIRCHA (MOTCLE,ICODE,IRETOU)
      IF (IRETOU .EQ. 0) THEN
         MOTCLE = ' '
      END IF
*
*     -- LECTURE DE LA LISTE DE TYPES DE COMPOSANTE --
*
      ICODE = 0
      CALL LIROBJ ('LISTMOTS',IPLMOT,ICODE,IRETOU)
      IF (IRETOU .EQ. 0) THEN
         IPLMOT = 0
      ELSE IF (MOTCLE .EQ. '    ') THEN
*        PAR DEFAUT, LES COMPOSANTES NOMMEES SONT LES COMPOSANTES
*        PRISES EN COMPTE (ET NON PAS LES COMPOSANTES EXCLUES):
         MOTCLE = 'AVEC'
      END IF
*
*     -- LECTURE DE L'OBJET --
*
      NBTYP = NBTYPE
      ICODE = 1
      CALL LIROBJ (LISTYP(1),IPOINT,ICODE,IRETOU)
      IF (IERR .NE. 0) RETURN
*
*     -- NORMALISATION --
*
*        NORMALISATION D'UN "CHPOINT":
         CALL NORMA1 (IPOINT,IPLMOT,MOTCLE,  IPOIN2)
         IF (IERR .NE. 0) RETURN
         CALL ECROBJ ('CHPOINT ',IPOIN2)
*
*
      END

