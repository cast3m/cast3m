C INTCN0    SOURCE    PV        09/03/12    21:25:18     6325

C=======================================================================
C=                            I N T C N 0                              =
*                             -----------                              =
*
* FONCTION:
* ---------
*     INTEGRATION NUMERIQUE DANS UN DOMAINE UNIDIMENSIONNEL DU PRODUIT:
*                     COEF. * TRANSPOSEE( N )
*     COEF. : GRANDEUR PHYSIQUE REPRESENTEE PAR UN CHAMELEM
*     N     : FONCTIONS DE FORME DE L'ELEMENT MAILLANT LE DOMAINE
*             CONSIDERE
*
* PARAMETRES:   (E)=ENTREE   (S)=SORTIE   (+ = CONTENU DANS UN COMMUN)
* -----------
*     IPVANO  (E)  POINTEUR SUR UN SEGMENT MELVAL CONTENANT LES
*                  VALEURS NODALES DE NOTRE COEFFICIENT
*     IPGEOM  (E)  POINTEUR SUR UN OBJET MAILLAGE ELEMENTAIRE
*                  DU DOMAINE D'INTEGRATION
*     IPINTE  (E)  POINTEUR SUR UN SEGMENT MINTE CONTENANT LES
*                  CARACTERISTIQUES D'INTEGRATION DES FACES
*     IPVAEQ  (S)  POINTEUR SUR UN SEGMENT MELVAL CONTENANT LES VALEURS
*                  NODALES EQUIVALENTES (APRES INTEGRATION NUMERIQUE)
*
* VARIABLES:
* ----------
*     XE(3,NBPTEL)  =  CORDONNEES DES ELEMENTS DANS LE REPERE GLOBAL
*     FACE          =  LONGUEUR DE DE L'ELEMENT CONSIDERE
*     A             =  TABLEAU DE TRAVAIL
*
* REMARQUES:
* ----------
*     L'UTILISATION DE CE S-P PRESUPPOSE UN PRE ET POST-TRAITEMENT
*     DES SEGMENTS MELVAL PASSES EN TANT QUE PARAMETRES
C=======================================================================

      SUBROUTINE INTCN0 (IPVANO,IPGEOM,IPINTE,IPVAEQ)

      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)

-INC CCOPTIO
-INC CCREEL
-INC SMCHAML
-INC SMELEME
-INC SMINTE
-INC SMCOORD

      PARAMETER (X2Pi=6.283185307179586476925286766559D0)
      PARAMETER (X4Pi=12.566370614359172953850573533118D0)

      DIMENSION XE(3,1)

*  OPTION INDISPONIBLE
      IF (IDIM.NE.1) THEN
        CALL ERREUR(19)
        RETURN
      ENDIF

*  ON RECUPERE LES CARACTERISTIQUES D'INTEGRATION DES FACES
      MINTE=IPINTE
      SEGACT,MINTE
      NBPGAU=POIGAU(/1)

* ON RECUPERE UN DES MAILLAGES ELEMENTAIRES DE L'ENVELOPPE
      MELEME=IPGEOM
      SEGACT,MELEME
      NBPTEL=NUM(/1)
      NEL=NUM(/2)

C*OF  IF ((NBPGAU.NE.1).OR.(NBPTEL.NE.1)) THEN
C*OF    WRITE(6,*) 'ERREUR FATALE : INTCN0'
C*OF    GOTO 10
C*OF  ENDIF

*  ON RECUPERE LES VALEURS NODALES DU COEFFICIENT
      MELVA1=IPVANO
      SEGACT,MELVA1
      NBPTE1=MELVA1.VELCHE(/1)
      NEL1=MELVA1.VELCHE(/2)
C*OF  INMIN=MIN(NBPTE1,1)

*  INITIALISATION DU MELVAL QUI CONTIENDRA LES VALEURS EQUIVALENTES
      N1PTEL=NBPTEL
      N1EL=NEL
      N2PTEL=0
      N2EL=0
      SEGINI,MELVAL

*     BOUCLE SUR LES ELEMENTS
      DO iElt=1,NEL

*  COORDONNEES DES NOEUDS DE L'ELEMENT DANS LE REPERE GLOBAL
        CALL DOXE(XCOOR,IDIM,NBPTEL,NUM,iElt,XE)

*  CAS DES ELEMENTS AXISYMETRIQUES et spheriques
        IF (IFOUR.GE.12.AND.IFOUR.LE.14) THEN
          A11=X2Pi*XE(1,1)
        ELSE IF (IFOUR.EQ.15) THEN
          RR=XE(1,1)
          A11=X4Pi*RR*RR
        ELSE
          A11=1.
        ENDIF
C*OF    IEMIN=MIN(NEL1,iElt)
C*OF    VELCHE(1,iElt)=MELVA1.VELCHE(INMIN,IEMIN)*A11
        VELCHE(1,iElt)=MELVA1.VELCHE(1,iElt)*A11
      ENDDO

      SEGDES,MELVAL,MELVA1
 10   SEGDES,MELEME,MINTE
      IPVAEQ=MELVAL

      RETURN
      END




