C SUBDEN    SOURCE    BP208322  16/11/18    21:21:21     9177
C   LECTURE DE LA DENSITE   ATTENTION ON VA CORRIGER LA VARIABLE &DENS
C
C PP 12/98: forcer la densite des point d'un maillage
      SUBROUTINE SUBDEN
      IMPLICIT INTEGER(I-N)
-INC CCGEOME
-INC CCOPTIO
C+PP
-INC SMCOORD
-INC SMELEME
C+PP
      REAL*8 XXX
      CALL MESLIR(-238)
      CALL LIRREE(XXX,1,IRETOU)
      IF (IERR.NE.0) RETURN
C+PP
      CALL LIROBJ('MAILLAGE',IPT1,0,IRETOU)
      IF(IRETOU.EQ.1)THEN
        SEGACT,IPT1,MCOORD*MOD
        NBSOUS=IPT1.LISOUS(/1)
        DO IE1=1,MAX(1,NBSOUS)
          IF(NBSOUS.EQ.0)THEN
            MELEME=IPT1
          ELSE
            MELEME=IPT1.LISOUS(IE1)
            SEGACT,MELEME
          ENDIF
          NBNN=NUM(/1)
          NBELEM=NUM(/2)
          DO IE2=1,NBELEM
            DO IE3=1,NBNN
              NUME=NUM(IE3,IE2)
              IREF=NUME*(IDIM+1)
              XCOOR(IREF)=ABS(XXX)
            ENDDO
          ENDDO
          SEGDES,MELEME
        ENDDO
        SEGDES,IPT1
        RETURN
      ENDIF
C+PP
      DENSIT=ABS(XXX)
      CALL NOMREE('&DENS   ',XXX)
      END









