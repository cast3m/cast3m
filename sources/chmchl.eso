C CHMCHL    SOURCE    CHAT      05/01/12    21:58:41     5004
      SUBROUTINE CHMCHL(IDSCHI,SP2,IZTR,PE)
C
C         Issu de TRIOEF (TRCHEL)
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      SEGMENT IDSCHI
           REAL*8 GK(NYDIM),AA(NYDIM,NXDIM),FF(NZDIM,NPDIM)
           INTEGER IDX(NXDIM),IDY(NYDIM),IDZ(NZDIM),IDP(NPDIM),NN(6)
           INTEGER IDECY(NYDIM),IONZ(NXDIM)
           CHARACTER*32 NAME(NXDIM),NAMESP(NYDIM)
      ENDSEGMENT
      SEGMENT SP2
           REAL*8 GX(NXDIM),XX(NXDIM),GS(NZDIM),SS(NZDIM)
           REAL*8 TOT(NXDIM),TOTAQ(NXDIM),TOTFIX(NXDIM),GKS(NZDIM)
           REAL*8 YY(NXDIM),ZZ(NXDIM,NXDIM),CC(NYDIM),GC(NYDIM)
      ENDSEGMENT
      SEGMENT IZTR
        REAL*8 A0(NXDIM)
      ENDSEGMENT
      NXDIM=IDX(/1)
      NYDIM=IDY(/1)
      NZDIM=IDZ(/1)
      NPDIM=IDP(/1)
      CALL CHIADY(IDY,NYDIM,99,IDY1)
      NN6=NN(1)+NN(2)+NN(3)+NN(4)+NN(5)
      N5F=NN6-1

C      SEGINI IZTR
      C0=CC(IDY1)
      GC0=GC(IDY1)
      IDYC0=IDECY(IDY1)
      DO KJ=1,NXDIM
        A0(KJ) = AA(IDY1,KJ)
      ENDDO

      DO I=IDY1,N5F
         IDY(I)=IDY(I+1)
         CC(I)=CC(I+1)
         GC(I)=GC(I+1)
         GK(I)=GK(I+1)
         IDECY(I)=IDECY(I+1)
         DO KJ=1,NXDIM
            AA(I,KJ)=AA(I+1,KJ)
         ENDDO
      ENDDO
      IDY(NN6)= 99
      CC(NN6)  = 10.D0**(-PE)
      GC(NN6) = -PE
      GK(NN6) =0.D0
      IDECY(NN6)=IDYC0
      DO KJ=1,NXDIM
        AA(NN6,KJ)=A0(KJ)
      ENDDO
      NN(3)=NN(3)-1
      NN(6)=NN(6)+1
C      SEGSUP IZTR

      RETURN
      END




