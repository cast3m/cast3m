C TRANSB    SOURCE    PV        06/04/11    21:16:17     5396
C    SOUS PROGRAMME DE VERIFICATION QU'UN SEGMENT POTENTIEL (LL1 LL2)
C    EST DU BON COTE DU CONTOUR (LL3 LL1 LL4)
C
      SUBROUTINE TRANSB(X,IRECL,LL1,LL2,LL3,LL4)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION X(3,1)
      IRECL=1
      X41=X(1,LL1)-X(1,LL4)
      Y41=X(2,LL1)-X(2,LL4)
      X31=X(1,LL1)-X(1,LL3)
      Y31=X(2,LL1)-X(2,LL3)
      UV=X41*Y31-X31*Y41
      X21=X(1,LL1)-X(1,LL2)
      Y21=X(2,LL1)-X(2,LL2)
      VX=X41*Y21-Y41*X21
      UX=X21*Y31-Y21*X31
      IF (UV.GE.0.D0.AND.VX.GT.0.D0.AND.UX.GT.0.D0) IRECL=0
      IF (UV.LT.0.D0.AND.(VX.GT.0.D0.OR.UX.GT.0.D0)) IRECL=0
      RETURN
      END


