C ACTIVE    SOURCE    FANDEUR   10/12/14    21:15:23     6812
      SUBROUTINE ACTIVE
C--------------------------------------------------------------------
C              OPERATEUR ACCELERATION DE CONVERGENCE
C
C    SYNTAXE : VOIR NOTICE
C--------------------------------------------------------------------
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C
-INC CCOPTIO
C
      CHARACTER*4 MOCOMP
      CHARACTER*4 LISMO(2)
      DATA LISMO/'GEOM','SECA'/
C
      CALL LIRMOT(LISMO,2,IDET,1)
      IF(IERR.NE.0) RETURN
C
      IF(IDET.EQ.1) THEN
      FLOT=0.98D0
      CALL LIRREE(FLOT,0,IRETOU)
      ENDIF
C
C  CAS DES CHPOINTS   - ACCELERATIONS GEOMETRIQUE OU SECANTE
C
      CALL LIROBJ('CHPOINT',MCHPO1,0,IRETOU)
      IF(IERR.NE.0) RETURN
      IF(IRETOU.EQ.1) THEN
        CALL LIROBJ('CHPOINT',MCHPO2,1,IRETOU)
        IF(IERR.NE.0) RETURN
        CALL LIROBJ('CHPOINT',MCHPO3,1,IRETOU)
        IF(IERR.NE.0) RETURN
C
        IF(IDET.EQ.2) THEN
          CALL LIROBJ('CHPOINT',MCHPO4,1,IRETOU)
          IF(IERR.NE.0) RETURN
        ENDIF
C
        CALL ACTIPO(FLOT,IDET,MCHPO1,MCHPO2,MCHPO3,MCHPO4)
C
        RETURN
      ENDIF
C
C  CAS DES MCHAMLS   - ACCELERATION GEOMETRIQUE UNIQUEMENT
C
      IF(IDET.NE.1) THEN
        CALL ERREUR(21)
        RETURN
      ENDIF
C
      CALL LIROBJ('MCHAML',IPCHE1,1,IRETOU)
      IF(IERR.NE.0)RETURN
      CALL LIROBJ('MCHAML',IPCHE2,1,IRETOU)
      IF(IERR.NE.0) RETURN
      CALL LIROBJ('MCHAML',IPCHE3,1,IRETOU)
      IF(IERR.NE.0)RETURN
      MOCOMP=' '
      CALL LIRCHA(MOCOMP,0,IRETOU)
      IF(IERR.NE.0) RETURN
      CALL ACTICH(FLOT,IPCHE1,IPCHE2,IPCHE3,MOCOMP,IPCHE4)
C
      IF (IERR.NE.0) CALL ECROBJ('MCHAML',IPCHE4)
C
      RETURN
      END


