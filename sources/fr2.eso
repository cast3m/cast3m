C FR2       SOURCE    CHAT      05/01/13    00:08:10     5004
      FUNCTION FR2  (SQA,SQU,LD)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
      COMMON/CMCHAM/ D1,D2,R,A,U,DD1,DD2,LSOMD,LD1,LD2
      COMMON/CMARGT/SINT,COST,RSINT,RCOST,RSIN2,XA,XU,XXA,XXU,SQA2,SQA1
     +,SQU2,SQU1
      LOGICAL LSOMD,LD1,LD2,LD
      IF(.NOT.LD)    GOTO 4
3     IF(COST.NE.1.D0) GOTO 4
5     IF(R-U) 4,10,14
14    IF(R-A) 11,12,13
4     FR2=-R*COST**2* LOG((XA+SQA)/(XU+SQU))
      RETURN
10    FR2=-R*(XA/SQA)
      RETURN
11    FR2=-R*((XA/SQA)-(XU/SQU))
      RETURN
12    FR2=+R*(XU/SQU)
      RETURN
13    FR2=-R* LOG(XU/XA)
      RETURN
      END

