C AFINOM    SOURCE    JC220346  18/12/04    21:15:04     9991
      SUBROUTINE AFINOM(NOMS,LMAX)
C     EN ENTREE : NOMS = POINTEUR VERS SEGMENT DE TYPE MLNOMS
C     EN SORTIE : LMAX = LONGUEUR DU NOM LE PLUS LONG
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC CCNOYAU
-INC TMLNOMS
      CHARACTER*(LONOM) CNOM
      CHARACTER*11 MYFMT
      EXTERNAL LONG
C
C     CHOIX DU FORMAT D'AFFICHAGE EN FONCTION DU NOM LE PLUS LONG
      MLNOMS=NOMS
      SEGACT,MLNOMS
      ILO=LINOMS(/2)
      LMAX=0
      DO I=1,ILO
         CNOM=LINOMS(I)
         LL=LONG(CNOM)
         IF (LL.GT.LMAX) LMAX=LL
      ENDDO
      IF (LMAX.LE.8) THEN
         MYFMT='(8(1X,A8))'
      ELSEIF (LMAX.LE.11) THEN
         MYFMT='(6(1X,A11))'
      ELSEIF (LMAX.LE.17) THEN
         MYFMT='(4(1X,A17))'
      ELSEIF (LMAX.LE.23) THEN
         MYFMT='(3(1X,A23))'
      ELSEIF (LMAX.LE.24) THEN
         MYFMT='(3(1X,A24))'
      ENDIF
C
C     AFFICHAGE DE LA LISTE DE NOMS
      WRITE(IOIMP,FMT=MYFMT) (LINOMS(I),I=1,ILO)

      RETURN
      END


