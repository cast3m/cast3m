C MANUMO    SOURCE    CHAT      05/01/13    01:29:45     5004
C
      SUBROUTINE MANUMO
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C     CET OPERATEUR FABRIQUE UN OBJET DE TYPE SOLUTION SOUS-TYPE MODE
C     SYNTAXE :
C     SOLUT=MANU MODE NUME N     ..... NUMERO DU MODE
C                          F MG Q1 Q2 Q3 ..FREQUENCE,MASSE GENERALISEE
C                                         ..DEPLACEMENTS GENERALISES
C                          CHPT  ....... OBJET DE TYPE CHAMPOIN
C                          CHEL  ....... OBJET DE TYPE CHAMELEM
C     ECRIT PAR FARVACQUE
C           MODIFIE PAR L. VIVAN (APPEL DE MANUSO) LE 4 AOUT 1988
C     APPELLE  : LIRMOT LIRE ECRIRE MANUSO
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
-INC CCOPTIO
C
      PARAMETER (LMOOPT=1)
      CHARACTER*4 MOOPT(LMOOPT)
C
      DATA MOOPT/'NUME'/
C
      IENT = 0
      XQ1 = 0.D0
      XQ2 = 0.D0
      XQ3 = 0.D0
      ICHEL = 0
      IJONCT = 0
C
C  **** LECTURE FACULTATIVE DES MOTS CLES DE L'ANCIENNE SYNTAXE
C
      CALL LIRMOT(MOOPT,LMOOPT,IMOT,0)
      IF (IMOT.EQ.1) THEN
         CALL LIRENT(IENT,1,IRETOU)
         IF (IERR.NE.0) RETURN
      ENDIF
C
C     LECTURE DE :FREQ,MASSE,DEP1,DEP2,DEP3
C
      CALL LIRREE(XFREQ,1,IRETOU)
      IF (IERR.NE.0) RETURN
      CALL LIRREE(XMN,1,IRETOU)
      IF (IERR.NE.0) RETURN
      CALL LIRREE(XQ1,0,IRETOU)
      IF (IRETOU.EQ.1) THEN
         CALL LIRREE(XQ2,1,IRETOU)
         IF (IERR.NE.0) RETURN
         CALL LIRREE(XQ3,1,IRETOU)
         IF (IERR.NE.0) RETURN
      ENDIF
C
      CALL LIROBJ('CHPOINT ',ICHPT,1,IRETOU)
      IF (IERR.NE.0) RETURN
C
      CALL LIROBJ('CHAMELEM',ICHEL,0,IRETOU)
      IF(IERR.NE.0)RETURN
C
      IF(IRETOU.EQ.0)THEN
        CALL LIROBJ('MCHAML',ICHEL,0,IRETOU)
        IF(IERR.NE.0)RETURN
      ENDIF
C
      CALL MANUSO('MODE    ',IENT,XFREQ,XMN,XQ1,XQ2,XQ3,ICHPT,ICHEL,
     &            IJONCT,MSOLUT)
C
      CALL ECROBJ('SOLUTION',MSOLUT)
C
      END

