C RGMATT    SOURCE    CHAT      09/10/09    21:23:07     6519
      SUBROUTINE RGMATT(IPOI2,IRET)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
C=======================================================================
C  CE SUBROUTINE CALCULE LA RIGIDITE DUE AUX LIAISONS MIXTES
C
C  PROGRAMME PAR GUILBAUD
C  APPELE PAR RIGI
C=======================================================================
-INC CCOPTIO
-INC SMRIGID
-INC SMATTAC
      KRIGI=0
      MATTAC=IPOI2
      SEGACT MATTAC
      NSOUMA=LISATT(/1)
      DO 10 NS=1,NSOUMA
      MSOUMA=LISATT(NS)
      SEGACT MSOUMA
      M=IPMATK(/1)
      IF(M.EQ.0) GOTO 1039
      DO 1038 IMA=1,M
      KRIG=IPMATK(IMA)
      IF(KRIGI.NE.0) GOTO 1037
      KRIGI=KRIG
      GO TO 1038
 1037 CALL FUSRIG(KRIGI,KRIG,IRET)
      MRIGID=KRIGI
      SEGDES MRIGID
      KRIGI=IRET
 1038 CONTINUE
 1039 CONTINUE
      SEGDES MSOUMA
   10 CONTINUE
      SEGDES MATTAC
      IRET=KRIGI
      RETURN
      END







