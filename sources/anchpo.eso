C ANCHPO    SOURCE    CHAT      05/01/12    21:22:13     5004
      SUBROUTINE ANCHPO(IPO1,NOCOM,IRET)
C=======================================================================
C
C     MISE A ZERO DES TERMES SUR UNE COMPOSANTE DONNEE
C          DANS UN CHPS PAR POINT
C     LE CHPS RESULTANT VOIT SON POINTEUR STOCKE DANS IRET
C  ENTREES
C     IPO1=POINTEUR SUR LE CHAMPOINT
C     NOCOM=NOM DE COMPOSANTE
C  SORTIES
C     IRET=POINTEUR SUR LE CHAMPS RESULTANT
C
C     J  BROCHARD  NOVEMBRE 85
C
C=======================================================================
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*4 NOCOM
-INC SMCHPOI
-INC CCOPTIO
      MCHPO1=IPO1
      SEGACT MCHPO1
      NSOUPO=MCHPO1.IPCHP(/1)
      NAT=MCHPO1.JATTRI(/1)
      SEGINI MCHPOI
      IRET=MCHPOI
      MTYPOI=MCHPO1.MTYPOI
      MOCHDE=MCHPO1.MOCHDE
      IFOPOI=MCHPO1.IFOPOI
      DO 72 IA=1,NSOUPO
      MSOUP1=MCHPO1.IPCHP(IA)
      SEGACT MSOUP1
      NC=MSOUP1.NOCOMP(/2)
      SEGINI MSOUPO
      IPCHP(IA)=MSOUPO
      IGEOC=MSOUP1.IGEOC
      DO 73 IB=1,NC
      NOCOMP(IB)=MSOUP1.NOCOMP(IB)
      NOHARM(IB)=MSOUP1.NOHARM(IB)
  73  CONTINUE
      MPOVA1=MSOUP1.IPOVAL
      SEGACT MPOVA1
      N=MPOVA1.VPOCHA(/1)
      NC=MPOVA1.VPOCHA(/2)
      SEGINI MPOVAL
      IPOVAL=MPOVAL
      DO 75 IC=1,NC
      IF (NOCOMP(IC).NE.NOCOM) GOTO 755
      DO 751 IB=1,N
      VPOCHA(IB,IC)=0.D0
  751 CONTINUE
      GOTO 75
  755 CONTINUE
      DO 756 IB=1,N
      VPOCHA(IB,IC)=MPOVA1.VPOCHA(IB,IC)
  756 CONTINUE
  75  CONTINUE
      SEGDES MPOVAL,MPOVA1
      SEGDES MSOUPO,MSOUP1
  72  CONTINUE
      SEGDES MCHPOI,MCHPO1
      RETURN
      END

