C NORMA4    SOURCE    CHAT      05/01/13    02:00:04     5004
      SUBROUTINE NORMA4(MSOLUT,IPLMOT,MOTCLE,IFLUI,COEFP,COEFPI)
************************************************************************
*
*                             N O R M A 4
*                             -----------
*
* FONCTION:
* ---------
*
*     NORMER UN 'MSOLUT' EN RAMENANT SA PLUS GRANDE VALEUR A 1
*     ON NE CREE PAS UN NOUVEAU MSOLUT. LA NORMALISATION EST FAITE
*     SUR LES CHAMPS DE DEPLACEMENT UNIQUEMENT (MSOLIS(5))
*
* MODE D'APPEL:
* -------------
*
*     CALL NORMA4 (MSOLUT,IPLMOT,MOTCLE,IFLUI,COEFP,COEFPI)
*
* ARGUMENTS:   (E)=ENTREE   (S)=SORTIE
* ----------
*
*     MSOLUT  ENTIER    (E)  POINTEUR SUR L'OBJET 'MSOLUT' A NORMER.
*     IPLMOT  ENTIER    (E)  VOIR LE S.P. "MAXIM1".
*     MOTCLE CHARACTER  (E)  VOIR LE S.P. "MAXIM1".
*     IFLUI   ENTIER    (E)  IL Y A DES COEF POUR P ET PI (0 SINON)
*     COEFP   REEL      (E)  COEFFICIENT A APPLIQUER A LA COMPOSANTE P
*     COEFPI  REEL      (E)  COEFFICIENT A APPLIQUER A LA COMPOSANTE PI
*
* SOUS-PROGRAMMES APPELES:
* ------------------------
*
*     NORMA3
*
* AUTEUR, DATE DE CREATION:
* -------------------------
*
*     MARTINE FARVACQUE     10 JUIN 86
*
* LANGAGE:
* --------
*
*     ESOPE + FORTRAN77
*
************************************************************************
*
      IMPLICIT INTEGER(I-N)
-INC CCOPTIO
-INC SMCHPOI
-INC SMSOLUT
*
      SEGMENT/MTEMP2/ (MAXSOU,MAXN,MAXNC)
*     (REMPLI DANS LE S.P. "MAXIM1")
      REAL*8 PGRAND,COEFP,COEFPI
      CHARACTER*4 MOTCLE
*
      SEGACT MSOLUT*MOD
      MSOLEN=MSOLIS(5)
      MSOLE1=MSOLIS(4)
      SEGACT MSOLEN*MOD,MSOLE1*MOD
      SEGINI MTEMP2
      ITEMP2=MTEMP2
*
      DO 1 ICH=1,ISOLEN(/1)
      ICHPOI=ISOLEN(ICH)
      CALL NORMA3 (ICHPOI,IPLMOT,MOTCLE,IFLUI,COEFP,COEFPI,ITEMP2,
     1  PGRAND)
*
      MMODE=MSOLE1.ISOLEN(ICH)
      SEGACT MMODE*MOD
      FMMODD(2)=FMMODD(2)/(PGRAND*PGRAND)
      DO 2 I=3,5
      FMMODD(I)=FMMODD(I)/PGRAND
  2   CONTINUE
      SEGDES MMODE
*
  1   CONTINUE
      SEGDES MSOLEN,MSOLE1
      SEGDES MSOLUT
      SEGSUP MTEMP2
      RETURN
      END


