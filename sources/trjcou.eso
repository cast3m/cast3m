C TRJCOU    SOURCE    CHAT      05/01/13    03:49:24     5004
      SUBROUTINE TRJCOU(UE,IZCOU,IZFACE,IEL,JEL,NUCENT)
C
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8 (A-H,O-Z)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C     CALCUL DE DTCO(JEL) POUR AVOIR UN NOMBRE DE COURANT DE 1 DANS IEL
C     UE  VITESSES MAX POUR L'ELEMENT JEL
C     IZCOU POINTEUR DU SEGMENT CONTENANT LE NOMBRE DE COURANT
C     IZFACE POINTEUR DU MAILLAGE CONTENANT LES CENTRES DES FACES
C     IEL NUMERO DE L ELEMENT CONSIDERE DANS LE SOUS MAILLAGE
C     JEL NUMERO DE L ELEMENT CONSIDERE DANS LE MAILLAGE COMPLET
C     NUCENT NUMERO DU NOEUD CENTRE DE L ELEMENT
C
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C
-INC CCOPTIO
-INC SMCOORD
-INC SMELEME
      POINTEUR IZFACE.MELEME
      SEGMENT IZUMAX
           REAL*8 UMAX(NBREL)
      ENDSEGMENT
C
      SEGMENT  IZCOU
           REAL*8 DTCO(NEL),COU
      ENDSEGMENT
C
C
      NF=IZFACE.NUM(/1)
C        ON VA DETERMINER DIAM : LA PLUS PETITE DISTANCE ENTRE LE
C        POINT CENTRE DE L ELEMENT ET LE MILIEU DES FACES
      IPCENT=(NUCENT-1)*(IDIM+1)
      NF1=(IZFACE.NUM(1,IEL)-1)*(IDIM+1)
      VINT=0.D0
      DO 5 I=1,IDIM
        VINT=VINT+(XCOOR(IPCENT+I)-XCOOR(NF1+I))**2
    5 CONTINUE
      DIAM=VINT
      DO 20 J=2,NF
           NF1=(IZFACE.NUM(J,IEL)-1)*(IDIM+1)
           VINT=0.D0
           DO 15 I=1,IDIM
             VINT=VINT+(XCOOR(IPCENT+I)-XCOOR(NF1+I))**2
   15      CONTINUE
           IF(VINT.LT.DIAM)DIAM=VINT
   20 CONTINUE
      DIAM=SQRT(DIAM)*2.D0
C
C
C     UE=UMAX(JEL)
C     write(6,*)' DIAM UE ',DIAM,UE,JEL
      DTCO(JEL)=DIAM/UE
      RETURN
      END


