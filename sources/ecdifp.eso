C ECDIFP    SOURCE    CHAT      09/05/05    21:15:10     6385
      SUBROUTINE ECDIFP(NBAND,LMAX,ITAB,IFORM)
      IMPLICIT INTEGER(I-N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION ITAB(1)

-INC CCOPTIO
-INC CCFXDR

*   T.C
*   FORMAT MODIFIE LE 19 MAI 89 AFIN DE PERMETTRE LE PASSAGE EN
*   I5 EN SUPPRIMANT LE BLANC QUI PRECEDE I4
*   LA MODIF DEFINITIVE A LIEU LE 23 MAI 90. LES FICHIERS ANTERIEURS
*   AU 19 MAI 89 NE SONT PLUS LISIBLE.
*
C   M.B.
C   Format modifié le 4/1/95 pour pouvoir gérer les piles contenant
C   plus que 100000 objets
C
      IF (LMAX.EQ.0) GO TO 1
      DIMATT=DIMATT+LMAX+1
      do 10 j=0,0
      IF (IFORM.EQ.1) THEN
         IF(IONIVE.LE.7) THEN
            WRITE(NBAND,8004) (ITAB(I+j),I=1,LMAX)
         ELSE
            WRITE(NBAND,8008) (ITAB(I+j),I=1,LMAX)
         ENDIF
      ENDIF
  10  continue
      IF (IFORM.EQ.0) WRITE(NBAND) (ITAB(I),I=1,LMAX)
      if (iform.eq.2)  ios= IXDRIMAT( ixdrw, lmax,itab(1))

 8004 FORMAT(' PILE NUMERO',I4,'NBRE OBJETS NOMMES' ,I5,'NBRE OBJETS' ,
     & I5)
 8008 FORMAT(' PILE NUMERO',I4,'NBRE OBJETS NOMMES' ,I8,'NBRE OBJETS' ,
     & I8)
C
    1 RETURN
      END










