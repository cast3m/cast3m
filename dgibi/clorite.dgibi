* fichier :  clorite.dgibi
 SAUT PAGE ;
*********************************************************************
*    Utilisation des modules CHI1 et CHI2
*    Jeu de données pour tester la chlorite d'Aspe
*********************************************************************
*option echo 1 ;
OPTION DIME 2 ;
 OPTION ELEM QUA4 ;
n1 = 1 ;
n2 = 1   ;
*
*                 POINT SERVANT A DEFINIR LE CONTOUR
*
A = 0.0 0.0 ;
B = 1. 0.0 ;
C = 1. 2. ;
D = 0. 2. ;
*
*                       DEFINITION DE SEGMENTS
*
*
AB = A DROIT N1 B ;
BC = B DROIT N2 C ;
CD = C DROIT N1 D ;
DA = D DROIT N2 A ;
*
*                         DEFINITION DU MAILLAGE
*
*
GP = AB BC CD DA DALL 'PLAN' ;
elim 0.001 gp ;
 ab= chang poi1 ab ;
 g1= chang poi1 gp ;
 g0= diff g1 ab ;
*********************************************************************
*
* La reaction de formation de la chlorite de formule structurale
*
*   Si   Al    O  Al    Fe3+   Fe2+    Mg    OH
*    3,06  0,94 10  1,10   0,32    1,43  2,89  8
*
* s'ecrit
*
* chlo +3,192 H20 +7.56 H+ +0.32 e- <-> 2,89 Mg +3,06 Si +1,75 Fe2+
*                                         +2,04Al(OH)4-
*           Table des données de CHI1
*    on choisi les solides devant intervenir dans la reaction CHXMX
***********************************************************************
TABDON=TABLE ;
TABDON.BDD= 'STRASBG' ;
TABDON.IDEN= LECT 1 2 6 7 50 60 61 99 101 165 ;
 TABDON.CHXMX= LECT 2157 2166 2141 2147 2150 2152 2154 2148 2139 ;
   TABESP1= TABLE   ;
    TABESP1.IDEN= 2175 ;
    TABESP1.LOGK= 9.78 ;
    TABESP1.ITYP= 5 ;
    TABESP1.COMP=  LECT 2 61 165 7 50 99 ;
    TABESP1.STOECH=  PROG  2.89 3.06 2.04 1.75 -7.56 -0.32 ;
 TABDON.NVESP= TABLE ;
 TABDON.NVESP.1= TABESP1 ;
 TABCLIM=TABLE ;
 TABCLIM.TYP3= LECT 50 99 ;
 TABDON.CLIM=TABCLIM ;
*
 TB1=CHI1 TABDON
   COMP '../divers/COMPSM'
   LOGK '../divers/COMPSM' ;
*                                 ----------------------------
*                                 table des paramètres de CHI2
*                                 ----------------------------
 TBPAR2= TABLE ;
 TBPAR2.'SOUSTYPE'='DONNEES_CHIMIQUES' ;
 TBPAR2.FIONI= MANU CHPO G1 1 SCAL 0.0 ;
 TBPAR2.LOGC= MANU CHPO G1 10  X001 -2.7 X002 -3.8 X006 -15.
  X007 -8. X050 -6.8 X060 -6.9 X061 -4. X099 3. X101 -5.4 X165 -8.5 ;
  TOTCA1= MANU CHPO G1 1 X001 1.31D-2  ;
  TOTCA2= MANU CHPO AB 1 X001 (4.82D-4 - 1.31D-2) ;
  TOTCA= TOTCA1+ TOTCA2 ;
  TOTMG1= MANU CHPO G1 1 X002 1.99D-2  ;
  TOTMG2= MANU CHPO AB 1 X002 (1.50D-4 - 1.99D-2) ;
  TOTMG= TOTMG1+ TOTMG2 ;
  TOFE31= MANU CHPO G1 1 X006 2.D-2  ;
  TOFE32= MANU CHPO AB 1 X006 (3.66116D-12 -  2.D-2 ) ;
  TOTFE3= TOFE31+ TOFE32 ;
  TOTFE2 =MANU CHPO G1 1 X007 0.D0 ;
  TOTOH= MANU CHPO G1 1 X060 0.D0 ;
  TOTHSI1= MANU CHPO G1 1 X061 2.D-1 ;
  TOTHSI2= MANU CHPO AB 1 X061 (1.0022474D-4 - 2.D-1) ;
  TOTHSI= TOTHSI1 + TOTHSI2 ;
  TOTE=  MANU CHPO G1 1 X099  0.D0 ;
  TOTCO1= MANU CHPO G1 1 X101 1.7D-2 ;
  TOTCO2= MANU CHPO AB 1 X101 (2.796D-2 - 1.7D-2)  ;
   TOTCO= TOTCO1+ TOTCO2 ;
  TOTAL1= MANU CHPO G1 1 X165  5.D-2 ;
  TOTAL2= MANU CHPO AB 1 X165  (2.28366D-7 - 5.D-2) ;
  TOTAL= TOTAL1 + TOTAL2 ;
  TOTH=  MANU CHPO G1 1 X050 0. ;
 TBPAR2.TOT=
 TOTCA+TOTMG+TOTFE3+TOTFE2+TOTOH+TOTHSI+TOTE+TOTCO+TOTAL+TOTH ;
 CLIMPE1= MANU CHPO G1 1 W026 -3. ;
 CLIMPE2= MANU CHPO AB 1 W026  (14. + 3. ) ;
 CLIMPE = CLIMPE1 + CLIMPE2 ;
 CLIMPH1= MANU CHPO G1 1 W027  7. ;
 CLIMPH2= MANU CHPO AB 1 W027  ( 5. - 7. ) ;
 CLIMPH = CLIMPH1 + CLIMPH2 ;
 TBPAR2.CLIM= CLIMPH+CLIMPE ;
 TBPARM= TABLE ;
 TBPARM.ITMAX =  80;
 TBPARM.EPS= 1.D-6 ;
 TBPARM.NFI= 6 ;
 TBPARM.IMPRIM = LECT 1 3 ;
 TBPARM.SORTIE= MOTS 'PREC'  'TYP5'  'FION' ;
*
 TB3= CHI2 TB1 TBPARM TBPAR2 ;
*
*                                   controle des résultats
*
 FIONTE1=MANU CHPO G1 1 SCAL 8.07816D-3 'NATURE' DISCRET ;
 FIONTE2=MANU CHPO AB 1 SCAL (1.87502D-3 - 8.07816D-3 )
 'NATURE' DISCRET ;
 FIONTES= FIONTE1 + FIONTE2 ;
 VERR1= ( ABS ( FIONTES - TB3.FION )) MASQUE SUPERIEUR 5.D-8 SOMME ;
*LIST VERR1 ;
 PRECTE1= MANU CHPO G1 10 W030 0. W031 0. W032 0. W033 1.02796E-02
   W034 0. W035 0. W036 2.64965E-03 W037 1.42876E-01 W038 1.79765E-02
   W039 6.88576E-03 'NATURE' DISCRET ;
 PRECTE2= MANU CHPO AB 10 W030 0. W031 0. W032 0. W033 -1.02796E-02
   W034 0. W035 0. W036 -2.64965E-03 W037 -1.42876E-01
    W038 -1.79765E-02   W039 -6.88576E-03 'NATURE' DISCRET ;
 PRECTES= PRECTE1+PRECTE2 ;
*LIST PRECTES ;
*LIST TB3.PREC ;
 PRECD=PRECTES /  50. ;
 VERR2= ( ABS ( PRECTES - TB3.PREC )) MASQUE SUPERIEUR PRECD SOMME ;
*LIST VERR2 ;
*LIST TB3.TYP5  ;
 TY5TE1=  MANU CHPO G1 10 W030 2.63183E-03 W031 1.70579E-05
W032 2.60854E-07 W033 0. W034 2.28431E-02 W035 1.00674E-04 W036 0.
W037 0. W038 0. W039 0. 'NATURE' DISCRET ;
 TY5TE2=  MANU CHPO AB 10 W030 (  3.80867E-11 - 2.63183E-03)
 W031 ( 9.52143E-01 - 1.70579E-05) W032 (6.45597E-05 - 2.60854E-07)
 W033 5.22263E-04  W034 (1.43073E-13 - 2.28431E-02)
W035 ( 1.63439E-07 - 1.00674E-04) W036 1.74267E-08 W037 9.99926E-01
 W038 9.55357E-01  W039 1.50703E-20 'NATURE' DISCRET ;
 TY5TES= TY5TE1+TY5TE2 ;
*LIST TY5TES ;
 TY5D= TY5TES/ 50. ;
 VERR3= ( ABS ( TY5TES - TB3.TYP5 )) MASQUE SUPERIEUR TY5D SOMME ;
*LIST VERR3 ;
********************************************************************
*      On traite le meme cas que precedemment mais au lieu de
*       preciser  les solides qui interviennent on precise ceux
*      qui n'interviennent pas   ( CLIM.TYP6 )
********************************************************************
TABDO2=TABLE ;
TABDO2.BDD= 'STRASBG' ;
TABDO2.IDEN= LECT 1 2 6 7 50 60 61 99 101 165 ;
 TABDO2.NVESP= TABLE ;
 TABDO2.NVESP.1= TABESP1 ;
TABCLIM.TYP6=  LECT 2130 2140 2143 2144 2149 2185 2231
  2153  2160 2161 2167 2168 2169 2176 2177 2178 2179 2180 2181 2182
  2183  2186 2188 2192 2197 2198 2200 2201 2203 2204 2205 2208 2216
  2217  2224 2225 2234 2235 2236 2237 2249 2252 2254 2255 2272 2273
  2224 2225 2234 2235 2236 2237 2249 2252 2254 2255 2272 2273 2274
  2277 2278 2279 2281 2282 2283 2286 2287 2288 2300 2311 2313
  2316 2317 2321 2322 2349 2359 2360
  2371 2372 2374 2375 2377 2378 2380 2381 ;
 TABDO2.CLIM=TABCLIM ;
*OPTION DONN 5 ;
TB2=CHI1 TABDO2
       COMP '../divers/COMPSM'    ;
*OPTION DONN 5 ;
*                                 ----------------------------
*         la table des paramètres de CHI2 est celle du cas précedent
*        mais on reinitialise la force ionique avec la valeur calculée
*                                 ----------------------------
 TBPAR2.FIONI=TB3.FION ;
 TB4= CHI2 TB2 TBPARM TBPAR2 ;
*
*                                   controle des résultats
*
 FIONTE1=MANU CHPO G1 1 SCAL 8.08143D-3 'NATURE' DISCRET ;
 FIONTE2=MANU CHPO AB 1 SCAL (1.87502D-3 - 8.08143D-3 )
 'NATURE' DISCRET ;
 FIONTES= FIONTE1 + FIONTE2 ;
 VERR4= ( ABS ( FIONTES - TB4.FION )) MASQUE SUPERIEUR 5.D-8 SOMME ;
*LIST VERR4 ;
 PRECTE1= MANU CHPO G1 10 W030 6.88576E-03  W031 0. W032 0. W033 0.
  W034  1.79765E-02  W035  2.64965E-03  W036 0. W037 1.02795E-02
   W038 1.42876E-01  W039 0. 'NATURE' DISCRET ;
 PRECTE2= MANU CHPO AB 10 W030 -6.88576E-03  W031 0. W032 0. W033 0.
  W034  -1.79765E-02  W035  -2.64965E-03  W036 0. W037 -1.02795E-02
   W038 -1.42876E-01  W039 0. 'NATURE' DISCRET ;
 PRECTES= PRECTE1+PRECTE2 ;
 PRECD=PRECTES /  50. ;
 VERR5= ( ABS ( PRECTES - TB4.PREC )) MASQUE SUPERIEUR PRECD SOMME ;
 TY5TE1=  MANU CHPO G1 10 W030 0. W031 2.63201E-03 W032 1.00675E-04
 W033  1.70591E-05 W034 0. W035 0. W036  2.60859E-07 W037 0.
 W038 0. W039 2.28433E-02 'NATURE' DISCRET ;
 TY5TE2=  MANU CHPO AB 10 W030 1.50703E-20
 W031 (3.80867E-11 - 2.63201E-03) W032 ( 1.63439E-07 - 1.00675E-04)
 W033 (9.52143E-01 - 1.70591E-05) W034 9.55356E-01 W035 1.74267E-08
 W036 ( 6.45597E-05 - 2.60859E-07) W037  5.22263E-04
 W038 9.99926E-01 W039 ( 1.43073E-13 - 2.28433E-02) 'NATURE' DISCRET ;
 TY5TES= TY5TE1+TY5TE2 ;
 TY5D= TY5TES/ 50. ;
 VERR6= ( ABS ( TY5TES - TB4.TYP5 )) MASQUE SUPERIEUR TY5D SOMME ;
********************************************************************
*                                      CAS No 3
*      Presence de redox
********************************************************************
TABDO3=TABLE ;
TABDO3.BDD= 'STRASBG' ;
TABDO3.IDEN= LECT 1 2 6 7 50 60 61 99 101 165 ;
 TABDO3.NVESP= TABLE ;
 TABDO3.NVESP.1= TABESP1 ;
 TABDO3.CLIM= TABLE ;
 TABDO3.CLIM.TYP6= LECT 99 ;
 TABDO3.CHXMX= LECT 2157 2166 2141 2147 2150 2152 2154 2148 2139 ;
TB5=CHI1 TABDO3
       COMP '../divers/COMPSM'    ;
*                                 ----------------------------
*                                 table des paramètres de CHI2
*                                 ----------------------------
 TBPAR3= TABLE ;
 TBPAR3.ITMAX =  80;
 TBPAR3.EPS= 1.D-6 ;
 TBPAR3.NFI= 6 ;
*TBPAR3.ITERSOLI=35 ;
 TBPAR3.IMPRIM= LECT 1 3 ;
 TBPAR4= TABLE ;
 TBPAR4.'SOUSTYPE'='DONNEES_CHIMIQUES' ;
 TBPAR4.FIONI= TB4.FION ;
 TBPAR4.LOGC= MANU CHPO G1 10  X001 -2.7 X002 -3.8 X006 -15.
  X007 -8. X050 -6.8 X060 -6.9 X061 -4. X099 3. X101 -5.4 X165 -8.5 ;
  TOTE1= MANU CHPO G0 1 X099 1.2497250381D-2 ;
  TOTE2= MANU CHPO AB 1 X099 9.57287D-16   ;
  TOTE=  TOTE1 + TOTE2  ;
  TOTH1= MANU CHPO G0 1 X050  -2.948552539D-2 ;
  TOTH2= MANU CHPO AB 1 X050  5.4659D-2  ;
  TOTH=  TOTH1 + TOTH2 ;
 TBPAR4.TOT=
 TOTCA+TOTMG+TOTFE3+TOTFE2+TOTOH+TOTHSI+TOTE+TOTCO+TOTAL+TOTH ;
 TBPAR3.SORTIE= MOTS 'PREC'  'TYP5'  'FION' ;
 TB6= CHI2 TB5 TBPAR4 TBPAR3 ;
*
*                                   controle des résultats
*
 FIONTE1=MANU CHPO G1 1 SCAL 8.08125D-3 'NATURE' DISCRET ;
 FIONTE2=MANU CHPO AB 1 SCAL (1.88536D-3 - 8.08125D-3 )
 'NATURE' DISCRET ;
 FIONTES= FIONTE1 + FIONTE2 ;
 VERR7= ( ABS ( FIONTES - TB6.FION )) MASQUE SUPERIEUR 5.D-8 SOMME ;
*LIST VERR7 ;
 PRECTE1= MANU CHPO G1 10 W029 6.88576E-03 W030 0.  W031 0. W032 0.
 W033 1.02796E-02 W034 0. W035 0. W036 2.64965E-03
 W037  1.42876E-01   W038 1.79765E-02 'NATURE' DISCRET ;
 PRECTE2= MANU CHPO AB 10 W029 -6.88576E-03 W030 0.  W031 0. W032 0.
 W033 -1.02796E-02 W034 0. W035 0. W036 -2.64965E-03
 W037 -1.42876E-01   W038 -1.79765E-02 'NATURE' DISCRET ;
 PRECTES= PRECTE1+PRECTE2 ;
 PRECD=PRECTES /  50. ;
 VERR8= ( ABS ( PRECTES - TB6.PREC )) MASQUE SUPERIEUR PRECD SOMME ;
 TY5TE1= MANU CHPO G1 10 W029 0. W030 2.63200E-03 W031 1.70595E-05
 W032 2.60862E-07  W033  0. W034    2.28415E-02
 W035 1.00671E-04 W036 0. W037 0. W038 0. 'NATURE' DISCRET ;
 TY5TE2= MANU CHPO AB 10 W029 1.67592E-20
 W030 ( 3.99616E-11 - 2.63200E-03) W031 (9.85139E-01 - 1.70595E-05 )
 W032 ( 6.56605E-05 - 2.60862E-07) W033  5.30806E-04
 W034 (1.45031E-13 -  2.28415E-02) W035 (1.68843E-07 - 1.00671E-04)
 W036 1.82753E-08 W037 9.99926E-01 W038 9.86350E-01 'NATURE' DISCRET ;
 TY5TES= TY5TE1+TY5TE2 ;
 TY5D= TY5TES/ 50. ;
 VERR9= ( ABS ( TY5TES - TB6.TYP5 )) MASQUE SUPERIEUR TY5D SOMME ;
*
 VERR= VERR1+VERR2+VERR3+VERR4+VERR5+VERR6+VERR7+VERR8+VERR9 ;
 SI (VERR EGA 0 ) ;
  ERRE 0 ;
 SINO  ;
  ERRE 5 ;
 FINSI ;
FIN ;










