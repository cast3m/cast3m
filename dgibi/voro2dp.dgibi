* fichier voro2dp.dgibi
************************************************************************
* Section : Langage Objets
* Section : Maillage Autres
************************************************************************
*
*----------------------------------------------------------------------*
* voro3d.dgibi est un exemple d'utilisation dans un cas bidimensionel  *
* de la procedure MAILVORO de maillage d'agregats cubiques de polyedres*
* de Voronoi ponderes. Cette procedure fait appel a l'operateur VORO   *
*----------------------------------------------------------------------*
*
*
*
*
*----------------------------------------------------------------------*
*     Maillage d'un agregat 2D de polyedres de Voronoi ponderes        *
*----------------------------------------------------------------------*
*
*
* ITRAC1   : VRAI => affichage resultats.                              *
*
ITRAC   = FAUX;
*
OPTI 'ECHO' 1 ;
*
OPTI 'DIME' 2 'ELEM' 'TRI3' ;
*
*----------------------------------------------------------------------*
*                  Definition du contour de l'agregat                  *
*----------------------------------------------------------------------*

** CONTOUR SIMPLE (CARRE UNITAIRE)
SURF1    = (D 1 (0. 0.) (1. 0.)) TRAN 1 (0. 1.) ;
CON1     = CONT SURF1 ;

** CONTOUR CONCAVE (ETOILE A N BRANCHES)
N        = 5 ;
R1       = 0.5 ;
R2       = 0.2 ;
P0       = 0.5 0.5 ;
P1       = P0 PLUS (0. R1) ;
P11      = P0 PLUS (0. R2) ;
P11      = P11 TOUR (0.5*360./N) P0 ;
PA       = P1 ;
PB       = P11 ;
MP1      = PA ET PB ;
REPE B1 (N-1);
  PC       = PA TOUR (360./N) P0 ;
  PD       = PB TOUR (360./N) P0 ;
  MP1      = MP1 ET PC ET PD ;
  PA       = PC ;
  PB       = PD ;
FIN B1 ;
CON2     = QUEL 'SEG2' MP1 ;
CON2     = D 1 CON2 P1 ;
*----------------------------------------------------------------------*
*                Tirage des points germes des polyedres                *
*----------------------------------------------------------------------*
*
*
*  20 POINTS PONDERES ALEATOIREMENT REPARTIS DANS UN CARRE UNITARE     *
*

LX =
   0.90221 ET 0.20133 ET 0.56560 ET 0.59057 ET 0.62244 ET 0.42929
ET 0.14924 ET 0.81168 ET 0.24833 ET 0.73971 ET 0.47668 ET 0.93702
ET 0.63439 ET 0.54812 ET 0.93299 ET 0.42356 ET 0.41907 ET 0.45798
ET 0.82657 ET 0.40545 ET 0.90096 ET 0.70135 ET 0.07765 ET 0.94570
ET 0.07387 ET 0.85309 ET 0.53336 ET 0.53396 ET 0.89490 ET 0.16526;
LX = LX
ET 0.81715 ET 0.98414 ET 0.42919 ET 0.63140 ET 0.92989 ET 0.30138
ET 0.28205 ET 0.33405 ET 0.73713 ET 0.00172 ET 0.37433 ET 0.73772
ET 0.77386 ET 0.79716 ET 0.15345 ET 0.64825 ET 0.33655 ET 0.90740
ET 0.04992 ET 0.90965 ET 0.22919 ET 0.55122 ET 0.09926 ET 0.54049
ET 0.26713 ET 0.82928 ET 0.83984 ET 0.79921 ET 0.72242 ET 0.63971
ET 0.70409 ET 0.75816 ET 0.73003 ET 0.95563 ;
LX = LX
ET 0.53823 ET 0.81399 ET 0.88579 ET 0.25297 ET 0.00812 ET 0.03646
ET 0.11039 ET 0.32701 ET 0.47379 ET 0.18967 ET 0.16443 ET 0.65597
ET 0.18728 ET 0.48901 ET 0.38849 ET 0.38324 ET 0.06384 ET 0.80955
ET 0.05028 ET 0.65686 ET 0.34012 ET 0.11361 ET 0.87300 ET 0.74131
ET 0.46806 ET 0.86833 ET 0.16237 ET 0.46631 ET 0.82981 ET 0.22157
ET 0.60339 ET 0.26412 ET 0.49831 ET 0.74348 ET 0.99488 ET 0.30290;
LY=
   0.50334 ET 0.30041 ET 0.19801 ET 0.11045 ET 0.89672 ET 0.78634
ET 0.59371 ET 0.52856 ET 0.42802 ET 0.47417 ET 0.69442 ET 0.27451
ET 0.78955 ET 0.94542 ET 0.85125 ET 0.47539 ET 0.96178 ET 0.55086
ET 0.30464 ET 0.56199 ET 0.78903 ET 0.51835;
LY = LY
ET 0.25365 ET 0.49865 ET 0.90667 ET 0.47131 ET 0.51647 ET 0.75300
ET 0.05808 ET 0.48061 ET 0.64561 ET 0.71340 ET 0.30834 ET 0.40382
ET 0.41203 ET 0.35306 ET 0.54772 ET 0.85021 ET 0.33046 ET 0.81722
ET 0.66490 ET 0.66047 ET 0.03584 ET 0.59982      ;
LY = LY
ET 0.70660 ET 0.53181 ET 0.23926 ET 0.60610 ET 0.03037 ET 0.71444
ET 0.79995 ET 0.29242 ET 0.38211 ET 0.02791 ET 0.05256 ET 0.71362
ET 0.24109 ET 0.12412 ET 0.88182 ET 0.18501 ET 0.12004 ET 0.22142
ET 0.56506 ET 0.93326 ET 0.84823 ET 0.83056 ET 0.86773 ET 0.68116;
LY = LY
ET 0.34819 ET 0.51335 ET 0.80420 ET 0.76119 ET 0.61278 ET 0.38769
ET 0.97498 ET 0.00812 ET 0.10674 ET 0.39010 ET 0.11423 ET 0.37106
ET 0.72900 ET 0.40098 ET 0.64321 ET 0.27265 ET 0.43734 ET 0.13851
ET 0.34737 ET 0.76279 ET 0.86224 ET 0.18011 ET 0.06517 ET 0.21181
ET 0.94050 ET 0.17736 ET 0.64957 ET 0.92597 ET 0.11208 ET 0.96287
ET 0.15339 ET 0.14638 ;
LR =
0.23758197409635060E-001 ET 0.64225183154224375E-001 ET
0.36736866656056834E-001 ET 0.48504976854531666E-001 ET
0.46128411806084395E-001 ET 0.65008575999082510E-001 ET
0.59359147697510210E-001 ET 0.40525167129123948E-001 ET
0.42953364132498145E-001 ET 0.48204093632001108E-001 ET
0.37442874863686422E-001 ET 0.69726159306463711E-001 ;
LR = LR ET
0.61107188600294918E-001 ET 0.35731401565552316E-001 ET
0.19302348661940839E-001 ET 0.47834911763271745E-001 ET
0.90756246545905722E-001 ET 0.13845966509209698E-001 ET
0.44740179105557443E-001 ET 0.38972751482812672E-001 ET
0.46271060826006100E-001 ET 0.89647170245135861E-002 ET
0.65347264654501191E-001 ET 0.12597263891101817E-001 ;
LR = LR ET
0.55706038465277635E-001 ET 0.28879283381112314E-001 ET
0.68983180052817478E-001 ET 0.44218630884449009E-001 ET
0.73390292911876515E-001 ET 0.53786251455369867E-001 ET
0.17437742195548236E-001 ET 0.45008409934954349E-001 ET
0.42521730084379150E-001 ET 0.80341493863335736E-001 ET
0.67940469085448041E-001 ET 0.48280785498447477E-001 ;
LR = LR ET
0.80896198002394018E-001 ET 0.49516689916534545E-001 ET
0.48198056262435209E-001 ET 0.56665906046409240E-001 ET
0.68113458238553276E-001 ET 0.52844511680733661E-001 ET
0.49469896911611702E-001 ET 0.30874947353221008E-001 ET
0.53597501003170678E-001 ET 0.45377199533094457E-001 ET
0.70823283907624990E-001 ET 0.78768221923562129E-001 ;
LR = LR ET
0.70058939575561405E-001 ET 0.28700285091676048E-001 ET
0.65969897140333952E-001 ET 0.56767461740104927E-001 ET
0.64479461284492459E-001 ET 0.47001581984256031E-001 ET
0.71620078488458555E-001 ET 0.51181014757361032E-001 ET
0.18992366122545450E-001 ET 0.42247195581588980E-001 ET
0.54835822733444901E-001 ET 0.37945891345290292E-001 ;
LR = LR ET
0.52109846556006076E-001 ET 0.62539083462572059E-001 ET
0.42574169989056179E-001 ET 0.65233450692687794E-001 ET
0.50915456997032538E-001 ET 0.50086042670363942E-001 ET
0.30391366477836985E-001 ET 0.48591729698561882E-001 ET
0.32617470563765474E-001 ET 0.79103448891875483E-001 ET
0.52724526400029392E-001 ET 0.39057808216839948E-001 ;
LR = LR ET
0.44115132239364523E-001 ET 0.20899367036974637E-001 ET
0.56948031947744143E-001 ET 0.69589542010186453E-001 ET
0.17382799880848281E-001 ET 0.58781337535647245E-001 ET
0.64386557271093048E-001 ET 0.34308860075902836E-001 ET
0.35652677896725986E-001 ET 0.52824244647675961E-001 ET
0.51051966323172659E-001 ET 0.50697539397803124E-001 ;
LR = LR ET
0.43806102776363855E-001 ET 0.55005663170904356E-001 ET
0.17967702511527621E-001 ET 0.49093270626893483E-001 ET
0.20165765763335178E-001 ET 0.46686979615819454E-001 ET
0.27264197797623985E-001 ET 0.60248311830392240E-001 ET
0.60319556565133998E-001 ET 0.59439936613173559E-001 ;
LR = LR ET
0.80298573574562368E-001 ET 0.53447624595389348E-001 ET
0.43649185029704343E-001 ET 0.28663996900077916E-001 ET
0.64423571479583039E-001 ET 0.26867097833576804E-001;
*
 MAIL1 = 'VIDE' 'MAILLAGE'/'POI1';
*
 PT1 =  'MANU' 'POI1' ((EXTR LX 1) (EXTR LY 1)) ;
 R1  =  EXTR LR 1;
 CHR1 = MANU CHPO PT1 1 'RAYO' R1 NATURE DISCRET ;
 MAIL1 = MAIL1 'ET' PT1 ;
*
REPE B0 ((DIME LX) - 1);
 N0 = (&B0 + 1);
 PT1 =  'MANU' 'POI1' ((EXTR LX N0) (EXTR LY N0)) ;
 MAIL1 = MAIL1 'ET' PT1 ;
 R1  =  EXTR LR N0;
 CHRI = MANU CHPO PT1 1 'RAYO' R1 NATURE DISCRET ;
 CHR1 = CHR1 'ET' CHRI;
FIN B0;
*
 CHR1 = 'REDU' CHR1 MAIL1 ;
*
*----------------------------------------------------------------------*
*   Construction et maillage de la partition de voronoi ponderee       *
*----------------------------------------------------------------------*
*
* Cas d'une enveloppe carree
*
** Construction de la partition
TAB0     = VORO MAIL1 CON1 CHR1;
A0       = TAB0 . 'VISU' ;
*
** Maillage de la partition
TAB1     = MAILVORO TAB0 CON1 'COUL';
*
SI ITRAC;
*
* Constructions des cercles representants les poids des cellules
 POIDS = VIDE MAILLAGE/SEG2;
 REPE B0 (NBNO MAIL1);
 P1 = MAIL1 POIN &B0;
 X1 = COOR P1 1;Y1 = COOR P1 2;
 R1 = EXTR CHR1 'RAYO' P1;
 C1 = CERC 6 ((X1 + R1) Y1) P1 (X1 (Y1+R1));
 C1 = C1 ET (C1 SYME 'DROIT' P1 (X1 (Y1+R1)));
 C1 = C1 ET (C1 SYME 'DROIT' P1 ((X1 + R1) Y1));
 C1 = C1 COUL VERT;
 POIDS = POIDS ET C1;
 FIN B0;
 ELIM POIDS 1E-10;
*
 TRAC ((TAB0.VISU) ET POIDS);
*
  V1       = TAB1 . 'MAIL' ;
*
  TRAC 'FACE' V1 'TITR' 'Maillage de la partition de Voronoi' ;
FINS;
*----------------------------------------------------------------------*
*
* Cas d'une enveloppe concave
*
** Construction de la partition
TAB0     = VORO MAIL1 CON2 ;
A0       = TAB0 . 'VISU' ;
** Maillage de la partition
TAB1     = MAILVORO TAB0 CON2 'COUL' ;
SI ITRAC;
*
V1       = TAB1 . 'MAIL' ;
TRAC 'FACE' V1 'TITR' 'Maillage de la partition de Voronoi' ;
FINS;
*
*
FIN;





