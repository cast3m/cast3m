*     -INC CCMED
*
*     INCLUDE NECESSAIRE POUR LA GESTION DU FORMAT MED 3
*
      INTEGER*4 MED_ACC_RDONLY,MED_ACC_RDWR,MED_ACC_RDEXT
      INTEGER*4 MED_ACC_CREAT,MED_ACC_UNDEF
      PARAMETER (MED_ACC_RDONLY=0,MED_ACC_RDWR=1)
      PARAMETER (MED_ACC_RDEXT=2,MED_ACC_CREAT=3,MED_ACC_UNDEF=4)

      INTEGER*4 MED_UNSTRUCTURED_MESH, MED_STRUCTURED_MESH
      INTEGER*4 MED_UNDEF_MESH_TYPE
      PARAMETER (MED_UNSTRUCTURED_MESH=0,MED_STRUCTURED_MESH=1)
      PARAMETER (MED_UNDEF_MESH_TYPE=-1)

      INTEGER*4 MED_CARTESIAN, MED_CYLINDRICAL, MED_SPHERICAL
      INTEGER*4 MED_UNDEF_AXIS_TYPE
      PARAMETER(MED_CARTESIAN=0, MED_CYLINDRICAL=1, MED_SPHERICAL=2)
      PARAMETER(MED_UNDEF_AXIS_TYPE=-1)
      INTEGER*4 MED_CARTESIAN_GRID, MED_POLAR_GRID
      INTEGER*4 MED_CURVILINEAR_GRID, MED_UNDEF_GRID_TYPE
      PARAMETER (MED_CARTESIAN_GRID=0, MED_POLAR_GRID=1)
      PARAMETER  (MED_CURVILINEAR_GRID=2, MED_UNDEF_GRID_TYPE=-1)

      INTEGER*4 MED_SORT_DTIT,MED_SORT_ITDT,MED_SORT_UNDEF
      PARAMETER (MED_SORT_DTIT=0,MED_SORT_ITDT=1,MED_SORT_UNDEF=-1)

      INTEGER*4 MED_COMMENT_SIZE,MED_NAME_SIZE,MED_SNAME_SIZE
      INTEGER*4 MED_LNAME_SIZE
      PARAMETER (MED_COMMENT_SIZE=200,MED_NAME_SIZE=64)
      PARAMETER (MED_SNAME_SIZE=16, MED_LNAME_SIZE=80)

      INTEGER*4 MED_NO_IT, MED_NO_DT
      PARAMETER (MED_NO_IT=-1, MED_NO_DT = -1)
      REAL*8 MED_UNDEF_DT
      PARAMETER (MED_UNDEF_DT = 0.0D0)

      INTEGER*4 MED_UNDEF_INTERLACE,MED_FULL_INTERLACE
      INTEGER*4 MED_NO_INTERLACE
      PARAMETER (MED_UNDEF_INTERLACE=-1,MED_FULL_INTERLACE=0)
      PARAMETER (MED_NO_INTERLACE=1)

      INTEGER*4 MED_CELL, MED_DESCENDING_FACE
      INTEGER*4 MED_DESCENDING_EDGE,MED_NODE
      INTEGER*4 MED_NODE_ELEMENT, MED_STRUCT_ELEMENT
      INTEGER*4 MED_ALL_ENTITY_TYPE,MED_UNDEF_ENTITY_TYPE
      INTEGER*4 MED_N_ENTITY_TYPES
      PARAMETER (MED_N_ENTITY_TYPES=6)
      PARAMETER (MED_CELL=0, MED_DESCENDING_FACE=1)
      PARAMETER (MED_DESCENDING_EDGE=2,MED_NODE=3)
      PARAMETER (MED_NODE_ELEMENT=4, MED_STRUCT_ELEMENT=5)
      PARAMETER (MED_ALL_ENTITY_TYPE=6,MED_UNDEF_ENTITY_TYPE=-1)

      INTEGER*4 MED_POINT1,MED_SEG2,MED_SEG3,MED_SEG4,MED_TRIA3
      INTEGER*4 MED_QUAD4,MED_TRIA6,MED_TRIA7,MED_QUAD8,MED_QUAD9
      INTEGER*4 MED_TETRA4,MED_PYRA5,MED_PENTA6,MED_HEXA8,MED_TETRA10
      INTEGER*4 MED_OCTA12,MED_PYRA13,MED_PENTA15,MED_PENTA18
      INTEGER*4 MED_HEXA20,MED_HEXA27
      INTEGER*4 MED_POLYGON,MED_POLYGON2
      INTEGER*4 MED_POLYHEDRON, MED_STRUCT_GEO_INTERNAL
      INTEGER*4 MED_STRUCT_GEO_SUP_INTERNAL,MED_NONE
      INTEGER*4 MED_GEO_ALL,MED_ALL_GEOTYPE
      INTEGER*4 MED_NO_GEOTYPE,MED_UNDEF_GEOTYPE
      PARAMETER(MED_POINT1=001)
      PARAMETER(MED_SEG2=102)
      PARAMETER(MED_SEG3=103)
      PARAMETER(MED_SEG4=104)
      PARAMETER(MED_TRIA3=203)
      PARAMETER(MED_QUAD4=204)
      PARAMETER(MED_TRIA6=206)
      PARAMETER(MED_TRIA7=207)
      PARAMETER(MED_QUAD8=208)
      PARAMETER(MED_QUAD9=209)
      PARAMETER(MED_TETRA4=304)
      PARAMETER(MED_PYRA5=305)
      PARAMETER(MED_PENTA6=306)
      PARAMETER(MED_HEXA8=308)
      PARAMETER(MED_TETRA10=310)
      PARAMETER(MED_OCTA12=312)
      PARAMETER(MED_PYRA13=313)
      PARAMETER(MED_PENTA15=315)
      PARAMETER(MED_PENTA18=318)
      PARAMETER(MED_HEXA20=320)
      PARAMETER(MED_HEXA27=327)
      PARAMETER(MED_POLYGON=400)
      PARAMETER(MED_POLYGON2=420)
      PARAMETER(MED_POLYHEDRON=500)
      PARAMETER(MED_STRUCT_GEO_INTERNAL=600)
      PARAMETER(MED_STRUCT_GEO_SUP_INTERNAL=700)
      PARAMETER(MED_NONE=0)
      PARAMETER(MED_GEO_ALL=-1)
      PARAMETER(MED_ALL_GEOTYPE=-1)
      PARAMETER(MED_NO_GEOTYPE=0)
      PARAMETER(MED_UNDEF_GEOTYPE=0)

      INTEGER*4  MED_N_CELL_GEO,MED_N_CELL_FIXED_GEO
      INTEGER*4  MED_N_CELL_GEO_FIXED_CON
      INTEGER*4  MED_N_FACE_GEO,MED_N_FACE_FIXED_GEO
      INTEGER*4  MED_N_FACE_GEO_FIXED_CON
      INTEGER*4  MED_N_EDGE_TYPES,MED_N_EDGE_FIXED_GEO
      INTEGER*4  MED_N_EDGE_GEO_FIXED_CON
      INTEGER*4  MED_N_NODE_GEO,MED_N_NODE_FIXED_GEO
      INTEGER*4  MED_N_NODE_GEO_FIXED_CON
      PARAMETER(MED_N_CELL_GEO=25)
      PARAMETER(MED_N_CELL_FIXED_GEO=24)
      PARAMETER(MED_N_CELL_GEO_FIXED_CON=21)
      PARAMETER(MED_N_FACE_GEO=8)
      PARAMETER(MED_N_FACE_FIXED_GEO=8)
      PARAMETER(MED_N_FACE_GEO_FIXED_CON=6)
      PARAMETER(MED_N_EDGE_TYPES=3)
      PARAMETER(MED_N_EDGE_FIXED_GEO=3)
      PARAMETER(MED_N_EDGE_GEO_FIXED_CON=3)
      PARAMETER(MED_N_NODE_GEO=1)
      PARAMETER(MED_N_NODE_FIXED_GEO=1)
      PARAMETER(MED_N_NODE_GEO_FIXED_CON=1)

      INTEGER*4 MED_COORDINATE, MED_CONNECTIVITY
      INTEGER*4 MED_NAME, MED_NUMBER
      INTEGER*4 MED_FAMILY_NUMBER
      INTEGER*4 MED_COORDINATE_AXIS1, MED_COORDINATE_AXIS2
      INTEGER*4 MED_COORDINATE_AXIS3, MED_INDEX_FACE, MED_INDEX_NODE
      INTEGER*4 MED_GLOBAL_NUMBER, MED_VARIABLE_ATTRIBUTE
      INTEGER*4 MED_COORDINATE_TRSF, MED_UNDEF_DATATYPE
      PARAMETER(MED_COORDINATE=0, MED_CONNECTIVITY=1, MED_NAME=2)
      PARAMETER(MED_NUMBER=3, MED_FAMILY_NUMBER=4)
      PARAMETER(MED_COORDINATE_AXIS1=5, MED_COORDINATE_AXIS2=6)
      PARAMETER(MED_COORDINATE_AXIS3=7,MED_INDEX_FACE=8)
      PARAMETER(MED_INDEX_NODE=9,MED_GLOBAL_NUMBER=10)
      PARAMETER(MED_VARIABLE_ATTRIBUTE=11,MED_COORDINATE_TRSF=12)
      PARAMETER(MED_UNDEF_DATATYPE=-1)

      INTEGER*4 MED_NODAL, MED_DESCENDING, MED_UNDEF_CONNECTIVITY_MODE
      INTEGER*4 MED_NO_CMODE
      PARAMETER(MED_NODAL=0,MED_DESCENDING=1)
      PARAMETER(MED_UNDEF_CONNECTIVITY_MODE=-1)
      PARAMETER(MED_NO_CMODE=-1)

      INTEGER*4 MED_FALSE, MED_TRUE
      PARAMETER(MED_FALSE=0,MED_TRUE=1)

      INTEGER*4 MED_UNDEF_PFLMODE,MED_GLOBAL_PFLMODE,MED_COMPACT_PFLMODE
      INTEGER*4 MED_UNDEF_STMODE,MED_GLOBAL_STMODE,MED_COMPACT_STMODE
      CHARACTER*64 MED_GAUSS_ELNO,MED_IPOINT_ELNO
      PARAMETER(MED_GAUSS_ELNO='MED_GAUSS_ELNO')
      PARAMETER(MED_IPOINT_ELNO='MED_GAUSS_ELNO')
      PARAMETER(MED_UNDEF_PFLMODE=0,MED_GLOBAL_PFLMODE=1)
      PARAMETER(MED_COMPACT_PFLMODE=2)
      PARAMETER(MED_UNDEF_STMODE=0,MED_GLOBAL_STMODE=1)
      PARAMETER(MED_COMPACT_STMODE=2)
      CHARACTER*64 MED_NO_NAME,MED_NO_MESHNAME,MED_NO_MESH
      CHARACTER*64 MED_NO_MESH_SUPPORT, MED_NO_LOCALIZATION
      CHARACTER*64 MED_NO_INTERPOLATION, MED_NO_PROFILE
      CHARACTER*64 MED_ALLENTITIES_PROFILE
      CHARACTER*80 MED_NO_GROUP
      PARAMETER(MED_NO_NAME=' ',MED_NO_MESHNAME=' ',MED_NO_MESH=' ')
      PARAMETER(MED_NO_MESH_SUPPORT=' ', MED_NO_LOCALIZATION=' ')
      PARAMETER(MED_NO_INTERPOLATION=' ', MED_NO_PROFILE=' ')
      PARAMETER(MED_ALLENTITIES_PROFILE=' ')
      PARAMETER(MED_NO_GROUP=' ')

      INTEGER*4 MED_ALL_CONSTITUENT
      PARAMETER(MED_ALL_CONSTITUENT=0)

      INTEGER*4 MED_UNDEF_SIZE,MED_NO_PROFILE_SIZE
      PARAMETER(MED_UNDEF_SIZE=0,MED_NO_PROFILE_SIZE=0)

      INTEGER*4 MED_MESH,MED_FIELD,MED_LIBRARY,MED_FILE
      INTEGER*4 MED_MESH_SUPPORT,MED_ELSTRUCT,MED_FAMILY
      INTEGER*4 MED_EQUIVALENCE, MED_GROUP, MED_JOINT
      INTEGER*4 MED_LOCALIZATION, MED_PROFILE,MED_FILTER
      INTEGER*4 MED_INTERPOLATION
      INTEGER*4 MED_NUMERICAL_DATA,MED_LINK,MED_CLASS_UNDEF
      INTEGER*4 MED_CLASS_ALL
      PARAMETER(MED_MESH=0,MED_FIELD=1,MED_LIBRARY=2,MED_FILE=3)
      PARAMETER(MED_MESH_SUPPORT=4,MED_ELSTRUCT=5,MED_FAMILY=6)
      PARAMETER(MED_LOCALIZATION=7,MED_PROFILE=8,MED_FILTER=9)
      PARAMETER(MED_INTERPOLATION=10, MED_NUMERICAL_DATA=11)
      PARAMETER(MED_LINK=13, MED_CLASS_UNDEF=-1, MED_CLASS_ALL=-2)

      INTEGER*4 MED_INT32,MED_INT64,MED_INT
      INTEGER*4 MED_FLOAT32,MED_FLOAT64,MED_DOUBLE
      PARAMETER (MED_INT32=24, MED_INT64=26, MED_INT=28)
      PARAMETER (MED_FLOAT32=4, MED_FLOAT64=6, MED_DOUBLE=6)

      INTEGER*4 MED_ATT_FLOAT64,MED_ATT_INT,MED_ATT_NAME
      INTEGER*4 MED_ATT_UNDEF
      PARAMETER(MED_ATT_FLOAT64=MED_FLOAT64)
      PARAMETER(MED_ATT_INT=MED_INT)
      PARAMETER(MED_ATT_NAME=30)
      PARAMETER(MED_ATT_UNDEF=0)

      CHARACTER*64 MED_PARTICLE_NAME, MED_BALL_NAME, MED_BEAM_NAME
      CHARACTER*64 MED_PARTICLE_LABEL,MED_BALL_DIAMETER
      CHARACTER*64 MED_BEAM_THICKNESS
      PARAMETER(MED_PARTICLE_NAME='MED_PARTICLE')
      PARAMETER(MED_BALL_NAME='MED_BALL')
      PARAMETER(MED_BEAM_NAME='MED_BEAM')
      PARAMETER(MED_PARTICLE_LABEL='MED_PARTICLE_LABEL')
      PARAMETER(MED_BALL_DIAMETER='MED_BALL_DIAMETER')
      PARAMETER(MED_BEAM_THICKNESS='MED_BEAM_THICKNESS')

      INTEGER*4 MED_MAJOR_NUM, MED_MINOR_NUM, MED_RELEASE_NUM
      PARAMETER(MED_MAJOR_NUM=3)
      PARAMETER(MED_MINOR_NUM=3)
      PARAMETER(MED_RELEASE_NUM=1)

      INTEGER*4 HDF_VERSION_RELEASE_REF, HDF_VERSION_MAJOR_REF
      INTEGER*4 HDF_VERSION_MINOR_REF
      CHARACTER*16 HDF_VERSION_REF
      PARAMETER(HDF_VERSION_REF='1.8.14')
      PARAMETER(HDF_VERSION_MAJOR_REF=1)
      PARAMETER(HDF_VERSION_MINOR_REF=8)
      PARAMETER(HDF_VERSION_RELEASE_REF=14)


      EXTERNAL MED_SET_IT
      COMMON /CMED/ MED_GET_CELL_GEOMETRY_TYPE
      INTEGER*4 MED_GET_CELL_GEOMETRY_TYPE(MED_N_CELL_FIXED_GEO)
      SAVE   /CMED/

C     Equivalence des Elements Cast3M => MED
      INTEGER MEDEL(48)
      DATA MEDEL( 1), MEDEL( 2), MEDEL( 3), MEDEL( 4), MEDEL( 5),
     .     MEDEL( 6), MEDEL( 7), MEDEL( 8), MEDEL( 9), MEDEL(10),
     .     MEDEL(11), MEDEL(12), MEDEL(13), MEDEL(14), MEDEL(15),
     .     MEDEL(16), MEDEL(17), MEDEL(18), MEDEL(19), MEDEL(20),
     .     MEDEL(21), MEDEL(22), MEDEL(23), MEDEL(24), MEDEL(25),
     .     MEDEL(26), MEDEL(27), MEDEL(28), MEDEL(29), MEDEL(30),
     .     MEDEL(31), MEDEL(32), MEDEL(33), MEDEL(34), MEDEL(35),
     .     MEDEL(36), MEDEL(37), MEDEL(38), MEDEL(39), MEDEL(40),
     .     MEDEL(41), MEDEL(42), MEDEL(43), MEDEL(44), MEDEL(45),
     .     MEDEL(46), MEDEL(47), MEDEL(48)
     .   / MED_POINT1,    MED_SEG2,   MED_SEG3,   MED_TRIA3,   MED_NONE,
     .      MED_TRIA6,   MED_TRIA7,  MED_QUAD4,    MED_NONE,  MED_QUAD8,
     .      MED_QUAD9,    MED_NONE,   MED_NONE,   MED_HEXA8, MED_HEXA20,
     .     MED_PENTA6, MED_PENTA15,   MED_NONE,    MED_NONE,   MED_NONE,
     .       MED_NONE,    MED_NONE, MED_TETRA4, MED_TETRA10,  MED_PYRA5,
     .     MED_PYRA13,    MED_NONE,   MED_NONE,    MED_NONE,   MED_NONE,
     .       MED_NONE,    MED_NONE, MED_HEXA27,    MED_NONE,   MED_NONE,
     .       MED_NONE,    MED_SEG4,   MED_NONE,  MED_OCTA12,   MED_NONE,
     .       MED_NONE,    MED_NONE,   MED_NONE,    MED_NONE,   MED_NONE,
     .       MED_NONE,    MED_NONE,   MED_NONE /

C     Types d'Elements geometriques disponibles pour la sortie MED
C     le 327 vient du plus grand numero dans l'equivalence : MED_HEXA27
      INTEGER MDICLA(327)
      DATA MDICLA(MED_POINT1) , MDICLA(MED_SEG2)  , MDICLA(MED_SEG3)   ,
     .     MDICLA(MED_TRIA3)  , MDICLA(MED_TRIA6) , MDICLA(MED_TRIA7)  ,
     .     MDICLA(MED_QUAD4)  , MDICLA(MED_QUAD8) , MDICLA(MED_QUAD9)  ,
     .     MDICLA(MED_HEXA8)  , MDICLA(MED_HEXA20), MDICLA(MED_PENTA6) ,
     .     MDICLA(MED_PENTA15), MDICLA(MED_TETRA4), MDICLA(MED_TETRA10),
     .     MDICLA(MED_PYRA5)  , MDICLA(MED_PYRA13), MDICLA(MED_HEXA27) ,
     .     MDICLA(MED_SEG4)   , MDICLA(MED_OCTA12)
     .   / 1 , 2 , 3 ,
     .     4 , 6 , 7 ,
     .     8 , 10, 11,
     .     14, 15, 16,
     .     17, 23, 24,
     .     25, 26, 33,
     .     37, 39 /

C     GTYPE et ETYPE Disponibles pour la sortie des resultats
      INTEGER   MED_GTABLE
      PARAMETER(MED_GTABLE=20)
      INTEGER*4 MEDGTB(MED_GTABLE)
      DATA MEDGTB( 1), MEDGTB( 2), MEDGTB( 3), MEDGTB( 4), MEDGTB( 5),
     .     MEDGTB( 6), MEDGTB( 7), MEDGTB( 8), MEDGTB( 9), MEDGTB(10),
     .     MEDGTB(11), MEDGTB(12), MEDGTB(13), MEDGTB(14), MEDGTB(15),
     .     MEDGTB(16), MEDGTB(17), MEDGTB(18), MEDGTB(19), MEDGTB(20)
     .   / MED_POINT1,   MED_SEG2,    MED_SEG3,  MED_TRIA3,   MED_TRIA6,
     .      MED_TRIA7,  MED_QUAD4,   MED_QUAD8,  MED_QUAD9,   MED_HEXA8,
     .     MED_HEXA20, MED_PENTA6, MED_PENTA15, MED_TETRA4, MED_TETRA10,
     .      MED_PYRA5, MED_PYRA13,  MED_HEXA27,   MED_SEG4, MED_OCTA12 /

      INTEGER   MED_ETABLE
      PARAMETER(MED_ETABLE=3)
      INTEGER*4 MEDETB(MED_ETABLE)
      DATA MEDETB(1)       , MEDETB(2), MEDETB(3)
     .   / MED_NODE_ELEMENT, MED_CELL , MED_NODE /

